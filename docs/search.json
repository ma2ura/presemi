[
  {
    "objectID": "prezemi_2023_08_presen.html#準備",
    "href": "prezemi_2023_08_presen.html#準備",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "準備",
    "text": "準備\n必要なパッケージと設定。無ければインストールする。\n\n# 文字化け防止のおまじない、R 4.1.0以降\nknitr::opts_chunk$set(dev = \"ragg_png\")\nlibrary(tidyverse) # とりあえずこれ\nlibrary(ggthemes) # ggplot2のテーマ\nlibrary(knitr) # 作表\nlibrary(kableExtra) # 作表の拡張\nlibrary(scales) # 軸の単位を制御\n# テーマを設定\ntheme_set(theme_few(base_size = 12))\n# 以下、ggplot2のデフォルトを変更\nupdate_geom_defaults(\"point\", list(size = 3))"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#データの読み込み",
    "href": "prezemi_2023_08_presen.html#データの読み込み",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "データの読み込み",
    "text": "データの読み込み\n作業ディレクトリを確認・設定する。\n\ngetwd()\nsetwd(\"hoge\")\n\n任意のフォルダを作業ディレクトリとして指定しておく。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#データの読み込み-1",
    "href": "prezemi_2023_08_presen.html#データの読み込み-1",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "データの読み込み",
    "text": "データの読み込み\n今回は松浦のウェブサイトからデータを読み込ませる。\n\ndf &lt;- read_csv(\"https://so-ichi.com/presemi08_full.csv\")\nrmarkdown::paged_table(df, options = list(rows.print = 5, cols.print = 3))\n\n\n\n  \n\n\n\n小さなデータを読み込むときは、presemi08_full.csvのところをpresemi08_2018.csvに変える。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#自作関数を作る練習",
    "href": "prezemi_2023_08_presen.html#自作関数を作る練習",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "自作関数を作る練習",
    "text": "自作関数を作る練習\n関数を作るには，function()を使う。 引数は，function(引数1, 引数2, ...)とする。\n\nmyfunc &lt;- function(x){ # 関数名\n  # 何かしらの処理\n  # y = f(x)\n  return(y) # 返り値\n}"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#足し算をする関数",
    "href": "prezemi_2023_08_presen.html#足し算をする関数",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "足し算をする関数",
    "text": "足し算をする関数\n変数yとxを足す，という関数addを作るとする。\n\nadd &lt;- function(y, x){\n  y + x\n}\n\n使ってみる。\n\n\nadd(1,4)\n\n\n[1] 5"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#分散を計算する関数",
    "href": "prezemi_2023_08_presen.html#分散を計算する関数",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "分散を計算する関数",
    "text": "分散を計算する関数\n\nデータの個数は，ベクトルならlength()，データフレームならnrow()\n合計はsum()，あるいはfor()で力尽くで計算\n\n\nmyvar &lt;- function(x) { # 自作関数 myvar\n  n = length(x) # データの個数\n  m = mean(x) # 平均\n  v = (sum((x - m)^2)) / n # 分散の定義\n  return(v) # 返り値\n}\n\n使ってみる。\n\n\nmyvar(c(1,2,3,4,5))\n\n\n[1] 2"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#合計を計算する方法",
    "href": "prezemi_2023_08_presen.html#合計を計算する方法",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "合計を計算する方法",
    "text": "合計を計算する方法\n1から10までの整数の合計を計算する。 sum()関数を使えば簡単。\n\n\nx &lt;- c(1:10) # 1〜10までの整数\nsum(x) # 合計\n\n\n[1] 55\n\n\n\nでもあえてforループをとすると、\n\ns &lt;- 0 # 初期値\nfor(i in 1:length(x)){ # ループ\n    s &lt;- s + x[i] # 合計\n}\nprint(s) # 結果\n\n[1] 55"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#平均を計算する関数",
    "href": "prezemi_2023_08_presen.html#平均を計算する関数",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "平均を計算する関数",
    "text": "平均を計算する関数\n\nmymean &lt;- function(x){\n  n = length(x) # データの個数\n  s = 0 # 初期値\n  for(i in 1:length(x)){ # ループ\n    s &lt;- s + x[i] # 合計をsに足していく\n  }\n  sumx &lt;- s / n # 平均\n  return(sumx) # 返り値\n}\n\n使ってみる。\n\n\nmymean(x)\n\n\n[1] 5.5\n\n\n\n基本関数mean()を使えば簡単に計算できる。\n\n\nmean(x) # 一撃\n\n\n[1] 5.5"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#tidyverseで自作関数",
    "href": "prezemi_2023_08_presen.html#tidyverseで自作関数",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "tidyverseで自作関数",
    "text": "tidyverseで自作関数\ntidyverseで自作関数を作る場合、注意が必要である。 例として、平均、分散、標準偏差を計算する関数mystat()を作る。\n\nmystat &lt;- function(chu, item) { # 引数をchuとitem\n  df |&gt; # データフレーム\n    filter(中分類 == chu) |&gt; # 指定した中分類を抽出\n    summarise( # 統計量を計算\n      平均     = mean(!!sym(item)), # 平均\n      中央値   = median(!!sym(item)), # 分散\n      標準偏差 = sd(!!sym(item)) # 標準偏差\n    ) |&gt;\n    kable() |&gt; kable_styling(font_size = 30) # 作表\n}"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#自作関数を使う",
    "href": "prezemi_2023_08_presen.html#自作関数を使う",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "自作関数を使う。",
    "text": "自作関数を使う。\n\nmystat(\"精密機器\", \"売上高\") # \"\"で囲まないとエラー\n\n\n\n\n平均\n中央値\n標準偏差\n\n\n\n\n115180.1\n22468.5\n216197.7\n\n\n\n\n\n\n\n平均値が中央値よりかなり大きいため，大きな値のため分布が右に歪んでいることが分かる。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#注意点",
    "href": "prezemi_2023_08_presen.html#注意点",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "注意点",
    "text": "注意点\n!!sym()は何をしているのか？\n\nsym()は、文字列をシンボル（変数名）に変換すること\nプログラム的に変数名を操作し、データフレームにおける列の操作を動的に実行可能\n!!は非標準評価(NSE)によりシンボルを実際の列として評価させている。\n\nまぁ細かいことなので，今は理解できなくてもよいです。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#例1",
    "href": "prezemi_2023_08_presen.html#例1",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "例1",
    "text": "例1\nたとえば，tidyverseの各種パッケージで，外からの文字列を使う場合\n\nseimitsu &lt;- \"精密機器\"\ndf |&gt; filter(中分類 == seimitsu) |&gt;\nrmarkdown::paged_table(options = list(rows.print = 4, cols.print = 4))\n\n\n\n  \n\n\n\nこれはOK"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#例2",
    "href": "prezemi_2023_08_presen.html#例2",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "例2",
    "text": "例2\n\nsales &lt;- \"売上高\"\ndf |&gt;\n  ggplot() + aes(x = sales) +\n  geom_histogram()\n\nこれはエラーがでる。 salesに”売上高”を代入する際にエラーになるため，ggplot()に渡すことができない。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#折れ線グラフを作る関数",
    "href": "prezemi_2023_08_presen.html#折れ線グラフを作る関数",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "折れ線グラフを作る関数",
    "text": "折れ線グラフを作る関数\n特定企業の，特定項目のデータから折れ線グラフを作る関数myline()を作る。\n\nmyline &lt;- function(name, item) {\n  df |&gt;\n    filter(企業名称 == name) |&gt;\n    select(年度, !!sym(item)) |&gt;\n    ggplot(aes(x = 年度, y = !!sym(item), group = 1)) +\n    geom_line() + geom_point() +\n    labs(title = paste(name, item, sep = \" \"), x = \"年度\", y = item) +\n    scale_y_continuous(labels = label_number(scale = 1/100, suffix = '億')) + # 単位\n    theme_economist(base_family = \"HiraKakuProN-W3\") +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))\n}"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#折れ線グラフを作る関数-1",
    "href": "prezemi_2023_08_presen.html#折れ線グラフを作る関数-1",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "折れ線グラフを作る関数",
    "text": "折れ線グラフを作る関数\n\nmyline(\"トヨタ自動車\", \"売上高\")"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#日産も作ってみる",
    "href": "prezemi_2023_08_presen.html#日産も作ってみる",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "日産も作ってみる。",
    "text": "日産も作ってみる。\n\nmyline(\"日産自動車\", \"売上高\")"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#並べてみる",
    "href": "prezemi_2023_08_presen.html#並べてみる",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "並べてみる",
    "text": "並べてみる\n\n\nRコード\ng1 &lt;- myline(\"トヨタ自動車\", \"売上高\")\ng2 &lt;- myline(\"日産自動車\", \"売上高\")\nlibrary(patchwork)\n# y軸をそろえる\n(g1 + g2) * ylim(0, 40000000)"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#ヒストグラムを作る関数",
    "href": "prezemi_2023_08_presen.html#ヒストグラムを作る関数",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "ヒストグラムを作る関数",
    "text": "ヒストグラムを作る関数\n\nmyhist &lt;- function(chu, item) { # 産業と項目を指定\ndf_chu &lt;- df |&gt;\n    filter(中分類 == chu) # 中分類を指定\ndf_chu |&gt; ggplot() + aes(x = !!sym(item)) + # ggplot\n      geom_histogram(bins = 20) + # ヒストグラム\n      labs(\n        title = paste(chu, item, sep = \" \"), # タイトル\n        x = item, y = \"頻度\") # 軸ラベル\n}"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#ヒストグラムを作る関数-1",
    "href": "prezemi_2023_08_presen.html#ヒストグラムを作る関数-1",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "ヒストグラムを作る関数",
    "text": "ヒストグラムを作る関数\n\nmyhist(\"精密機器\", \"売上高\")"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#製造業-vs-非製造業",
    "href": "prezemi_2023_08_presen.html#製造業-vs-非製造業",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "製造業 vs 非製造業",
    "text": "製造業 vs 非製造業\n製造業と非製造業で売上高利益率が違うかどうかの検定を行う。 いきなり計算するのではなく，まずはデータを見てみる。\n\nsummary(df$売上高)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n       0     8134    25930   190128    91764 37154298 \n\n\n売上高ゼロはまずいので，あとで除外する。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#製造業-vs-非製造業-1",
    "href": "prezemi_2023_08_presen.html#製造業-vs-非製造業-1",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "製造業 vs 非製造業",
    "text": "製造業 vs 非製造業\n\nsummary(df$親会社利益)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-2008074      117      618     6485     2677  4987962 \n\n\n赤字企業も利益率を計算する上で邪魔なので，除外する。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#製造業-vs-非製造業-2",
    "href": "prezemi_2023_08_presen.html#製造業-vs-非製造業-2",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "製造業 vs 非製造業",
    "text": "製造業 vs 非製造業\n\ndf_test &lt;- df |&gt;\n  filter(売上高 &gt; 0, 親会社利益 &gt; 0) |&gt; # 異常値を除外\n  mutate( 売上高利益率 = 親会社利益 / 売上高 ) # 利益率計算\ndf_mean &lt;- df_test |&gt;\n  group_by(大分類) |&gt;\n  summarise(\n    平均利益率 = round(mean(売上高利益率, na.rm = TRUE), digits = 3)\n    )\ndf_mean |&gt; kable() |&gt; kable_styling(font_size = 30)\n\n\n\n\n大分類\n平均利益率\n\n\n\n\n1\n0.053\n\n\n2\n0.068"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#比較",
    "href": "prezemi_2023_08_presen.html#比較",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "比較",
    "text": "比較\n大分類1は製造業で，利益率が2，非製造業は0.068であることから，サービス業の方が売上高利益率が高いことがわかる。\nこの差は，\n\n同じ母集団から，偶然の差？\n違う母集団から，当然の差？\n\n\\(t\\)検定してみる。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#製造業-vs-非製造業-3",
    "href": "prezemi_2023_08_presen.html#製造業-vs-非製造業-3",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "製造業 vs 非製造業",
    "text": "製造業 vs 非製造業\n\nt.test(#\n  df_test$売上高利益率[df_test$大分類 == 1], # var1\n  df_test$売上高利益率[df_test$大分類 == 2], # var2\n  )\n\n\n    Welch Two Sample t-test\n\ndata:  df_test$売上高利益率[df_test$大分類 == 1] and df_test$売上高利益率[df_test$大分類 == 2]\nt = -6.8123, df = 32435, p-value = 9.769e-12\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -0.01916433 -0.01060046\nsample estimates:\n mean of x  mean of y \n0.05290615 0.06778855"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#ヒストグラムを重ねてみる",
    "href": "prezemi_2023_08_presen.html#ヒストグラムを重ねてみる",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "ヒストグラムを重ねてみる。",
    "text": "ヒストグラムを重ねてみる。\n\n\nRコード\nseizou &lt;- mean(df_test$売上高利益率[df_test$大分類 == 1])\nhisei &lt;- mean(df_test$売上高利益率[df_test$大分類 == 2])\ndf_test |&gt;\n  ggplot(aes(x = 売上高利益率,y = ..density.., # 軸\n  group = factor(大分類), fill = factor(大分類))) + # グループ\n  geom_histogram(binwidth = 0.01, alpha = 0.5) + # ヒストグラム\n  xlim(0, 0.5) + # x軸の範囲\n  geom_vline( # 平均値の直線を引く\n    xintercept = c(seizou, hisei), # 平均値\n    linetype = \"dashed\",\n    color = c(\"red\", \"blue\")) +\n  scale_y_continuous(expand = c(0,0)) + # 余白を削除\n  labs(title = \"売上高利益率のヒストグラム\", x = \"売上高利益率\", y = \"頻度\")"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#相関係数",
    "href": "prezemi_2023_08_presen.html#相関係数",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "相関係数",
    "text": "相関係数\n2つの連続変数の線形関係を示す指標として，相関係数(correlation coefficient)がある。 \\(x\\)と\\(y\\)の2変数の(ピアソンの積率)相関係数は以下のように定義される。 \\[\nr = \\frac{\\sum_{i=1}^{n}(x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n}(x_i - \\bar{x})^2}\\sqrt{\\sum_{i=1}^{n}(y_i - \\bar{y})^2}} = \\frac{\\mathrm{cov}(x,y)}{\\sigma_x \\times \\sigma _y}\n\\]"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#相関係数の種類",
    "href": "prezemi_2023_08_presen.html#相関係数の種類",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "相関係数の種類",
    "text": "相関係数の種類\n相関係数にはいくつか種類があり，代表的なものとして，\n\nピアソンの積率相関係数 : パラメトリック\nスピアマンの順位相関係数 : ノンパラメトリック\n\n通常「相関係数」というとピアソンの積率相関係数を意味する。 Rで計算するなら，cor()を用いる。 引数として連続変数を2つとる。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#相関係数の計算",
    "href": "prezemi_2023_08_presen.html#相関係数の計算",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "相関係数の計算",
    "text": "相関係数の計算\n\n\ndf_test |&gt; with(cor(売上高, 広告宣伝費))\n\n\n[1] 0.5848697\n\n\n\n散布図も書いてみる。\n\n\nRコード\ndf_test |&gt;\n  filter(広告宣伝費 &gt; 0) |&gt;\n  ggplot() + aes(x = 広告宣伝費, y = 売上高) +\n  geom_point()"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#変数変換",
    "href": "prezemi_2023_08_presen.html#変数変換",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "変数変換",
    "text": "変数変換\n右下にデータが集まりすぎているので，対数変換してみる。\n\n\nRコード\ndf_test |&gt;\n  filter(広告宣伝費 &gt; 0) |&gt;\n  ggplot() + aes(x = log(広告宣伝費), y = log(売上高)) +\n  geom_point()\n\n\n\n右肩上がりの関係が見えてきます。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#前期の値",
    "href": "prezemi_2023_08_presen.html#前期の値",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "前期の値",
    "text": "前期の値\n当期の広告宣伝費より昨年度の広告宣伝費のほうが当期の売上高に影響を与えているかも。\n\n\nRコード\ndf_test |&gt;\n  filter(広告宣伝費 &gt; 0) |&gt;\n  ggplot() + aes(x = log(lag(広告宣伝費)), y = log(売上高)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE)"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#前期の広告宣伝費",
    "href": "prezemi_2023_08_presen.html#前期の広告宣伝費",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "前期の広告宣伝費",
    "text": "前期の広告宣伝費\n当期より昨年度の広告宣伝費のほうが当期の売上高に影響を与えているかもしれないので、 lag()関数を使って作図してみる。\n\n\nRコード\ndf_test |&gt;\n  filter(広告宣伝費 &gt; 0) |&gt;\n  ggplot() + aes(x = log(lag(広告宣伝費)), y = log(売上高)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE)"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#対数変換の効果",
    "href": "prezemi_2023_08_presen.html#対数変換の効果",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "対数変換の効果",
    "text": "対数変換の効果\n(自然)対数変換の効果を確認してみる。\n\n\nRコード\nz &lt;- c(1:100)\nlogz &lt;- log(z)\n# 2つのグラフを並べる\npar(mfrow = c(1,2))\nplot(z)\nplot(logz)"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#指数関数とは",
    "href": "prezemi_2023_08_presen.html#指数関数とは",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "指数関数とは",
    "text": "指数関数とは\n対数の前に、指数関数(exponential function)を説明する。 指数関数とは，\\(y\\)が正の実数のとき，\\(x = \\mathrm{a}^y\\)となる関数\\(f:y \\mapsto x\\)である。 定数\\(a\\)を\\(y\\)乗すると\\(x\\)になる関数である。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#対数関数",
    "href": "prezemi_2023_08_presen.html#対数関数",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "対数関数",
    "text": "対数関数\n逆に、\\(x\\)が正の実数のとき，\\(y = \\log x\\)となる\\(y\\)のことを対数(logarithm)といい、 対数関数とは，\\(y = \\log x\\)となる関数\\(f:x \\mapsto y\\)のことである。"
  },
  {
    "objectID": "prezemi_2023_08_presen.html#指数関数と対数関数",
    "href": "prezemi_2023_08_presen.html#指数関数と対数関数",
    "title": "プレゼミ2023  第8回 分析してみよう",
    "section": "指数関数と対数関数",
    "text": "指数関数と対数関数\n\\[\nt = \\log x \\Longleftrightarrow x = \\mathrm{e}^t\n\\] つまり、指数関数と対数関数は逆関数なので、\n\\[\n\\begin{aligned}\nt = \\log x = \\log \\mathrm{e}^t\\\\\nx = \\mathrm{e}^t = \\mathrm{e}^{\\log x}\n\\end{aligned}\n\\] が成り立つ。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#準備",
    "href": "prezemi_2023_09_presen.html#準備",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "準備",
    "text": "準備\n必要なパッケージと設定。無ければインストールする。\n\n# 文字化け防止のおまじない、R 4.1.0以降\nknitr::opts_chunk$set(dev = \"ragg_png\")\nlibrary(tidyverse) # とりあえずこれ\nlibrary(ggthemes) # ggplot2のテーマ\nlibrary(knitr) # 作表\nlibrary(kableExtra) # 作表の拡張\nlibrary(scales) # 軸の単位を制御\n# テーマを設定\ntheme_set(theme_few(base_size = 12))\n# 以下、ggplot2のデフォルトを変更\nupdate_geom_defaults(\"point\", list(size = 3))"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#データの読み込み",
    "href": "prezemi_2023_09_presen.html#データの読み込み",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "データの読み込み",
    "text": "データの読み込み\n作業ディレクトリを確認・設定する。\n\ngetwd()\nsetwd(\"hoge\")\n\n任意のフォルダを作業ディレクトリとして指定しておく。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#データの読み込み-1",
    "href": "prezemi_2023_09_presen.html#データの読み込み-1",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "データの読み込み",
    "text": "データの読み込み\n今回は松浦のウェブサイトからデータを読み込ませる。\n\ndf &lt;- read_csv(\"https://so-ichi.com/presemi08_full.csv\")\nrmarkdown::paged_table(df, options = list(rows.print = 5, cols.print = 3))\n\n\n\n  \n\n\n\n小さなデータを読み込むときは、presemi08_full.csvのところをpresemi08_2018.csvに変える。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#カテゴリー変数の関連",
    "href": "prezemi_2023_09_presen.html#カテゴリー変数の関連",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "カテゴリー変数の関連",
    "text": "カテゴリー変数の関連\n\nこの章では、2つ以上の変数間の関係を調べる方法を学びます。\n1つめは、カテゴリー変数間の関係を調べる方法として、クロス集計表とカイ二乗検定を学びます。\n2つめは、量的変数間の関係を調べる方法として、相関係数と散布図を学びます。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#クロス集計表",
    "href": "prezemi_2023_09_presen.html#クロス集計表",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "クロス集計表",
    "text": "クロス集計表\n\nカテゴリー変数は、その値がどのカテゴリーに属するかということを表す変数\n2つのカテゴリー変数の関連性を調べるためにはクロス集計表を作ることが有益\n\n\n\n\n\nメガネかけてる\nかけてない\n合計\n\n\n\n\n男\n41\n204\n245\n\n\n女\n81\n74\n155\n\n\n合計\n122\n278\n400\n\n\n\nこの表から、メガネをかけている人の割合は、男性の中で\\(41 \\div 204 =\\) 0.2009804、 女性の中で\\(81 \\div 155 =\\) 0.52であることから、女子学生の方がメガネをかける傾向にあることが分かりました。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#カイ二乗検定",
    "href": "prezemi_2023_09_presen.html#カイ二乗検定",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "カイ二乗検定",
    "text": "カイ二乗検定\nこのクロス集計表から読み取れる関係が、統計的に意味があるのかどうかを調べるためには、\\(\\chi ^2\\)(カイ二乗)検定を行います。\n\n帰無仮説として、カテゴリー変数間に関連性はないと仮定\nその仮定のもとで、観測されたクロス集計表の度数が、理論的に予測される度数と大きく異なるかどうかを検定\n予測される度数と観測された度数の差が大きいほど、帰無仮説が棄却される\n\n\\(\\chi^2\\)検定で用いられる統計量は、\\(\\chi^2\\)統計量と呼ばれ、次の式で計算されます。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#カイ二乗の数式",
    "href": "prezemi_2023_09_presen.html#カイ二乗の数式",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "カイ二乗の数式",
    "text": "カイ二乗の数式\n\\[\n\\chi^2 = \\sum_{i=1}^n \\sum_{j=1}^m \\frac{(O_{ij} - E_{ij})^2}{E_{ij}}\n\\]\nここで、\\(O_{ij}\\)は観測された度数(観測度数)、\\(E_{ij}\\)は理論的に予測される度数(期待度数)です。\\(n\\)と\\(m\\)はカテゴリー変数のカテゴリー数です。 つまり、2つのカテゴリー変数の関連性を調べる場合、\\(\\chi^2\\)統計量は次のように計算されます。\n\\[\n\\begin{aligned}\n\\chi^2 &= \\frac{(O_{11} - E_{11})^2}{E_{11}} + \\frac{(O_{12} - E_{12})^2}{E_{12}} \\\\\n&+ \\frac{(O_{21} - E_{21})^2}{E_{21}} + \\frac{(O_{22} - E_{22})^2}{E_{22}}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#期待度数",
    "href": "prezemi_2023_09_presen.html#期待度数",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "期待度数",
    "text": "期待度数\nここで、期待度数\\(E\\)をどうやって求めるのか、が問題となります。 期待度数の「期待」の意味は、帰無仮説のもとで期待される度数です。\n\\[\nE_{ij} = \\frac{O_{i\\cdot} \\times O_{\\cdot j}}{O_{\\cdot \\cdot}}\n\\] ここで、\\(O_{i\\cdot}\\)は\\(i\\)行目の合計(横の合計)、\\(O_{\\cdot j}\\)は\\(j\\)列目の合計(縦の合計)、\\(O_{\\cdot \\cdot}\\)は全体の合計です。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#メガネの例",
    "href": "prezemi_2023_09_presen.html#メガネの例",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "メガネの例",
    "text": "メガネの例\n先のメガネの例で計算してみます。 観察度数\\(O\\)は次のようになります。\n\n\n\n\nメガネをかけている\nメガネをかけていない\n合計\n\n\n\n\n男\n41\n204\n245\n\n\n女\n81\n74\n155\n\n\n合計\n122\n278\n400\n\n\n\n男の行合計\\(O_{男\\cdot}\\)は245、女の行合計\\(O_{女\\cdot}\\)は155、メガネ有りの列合計\\(O_{\\cdot メガネ有}\\)は122、メガネなしの列合計\\(O_{\\cdot メガネ無}\\)は278、全体の合計\\(O_{\\cdot \\cdot}\\)は400となります。 ここから、期待度数は次のように計算されます。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#メガネの例-1",
    "href": "prezemi_2023_09_presen.html#メガネの例-1",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "メガネの例",
    "text": "メガネの例\n\\[\n\\begin{aligned}\nE_{男, メガネ} &= \\frac{245 \\times 122}{400} = 74.725 \\\\\nE_{男, メガネ無} &= \\frac{245 \\times 278}{400} = 170.275 \\\\\nE_{女, メガネ} &= \\frac{155 \\times 122}{400} = 47.275 \\\\\nE_{女, メガネ無} &= \\frac{155 \\times 278}{400} = 107.725\n\\end{aligned}\n\\]\nよって期待度数\\(E\\)は次のようになります。\n\n\n\n\nメガネをかけている\nメガネをかけていない\n合計\n\n\n\n\n男\n74.725\n170.275\n245\n\n\n女\n47.275\n107.725\n155\n\n\n合計\n122\n278\n400"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#メガネの例-2",
    "href": "prezemi_2023_09_presen.html#メガネの例-2",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "メガネの例",
    "text": "メガネの例\nここから、定義通りに、\\(\\chi^2\\)統計量を計算します。\n\\[\n\\begin{aligned}\n\\chi^2 = \\frac{(41 - 74.725)^2}{74.725} + \\frac{(204 - 170.275)^2}{170.275} + \\frac{(81 - 47.275)^2}{47.275} + \\frac{(74 - 107.725)^2}{107.725} = 7.2\n\\end{aligned}\n\\]\nここで計算した\\(\\chi^2\\)統計量は、自由度1の\\(\\chi^2\\)分布に従うということが知られています。この自由度は、カテゴリー変数のカテゴリー数から1を引いたものです。 ここでは、2カテゴリー同士のクロス集計表なので、自由度は\\((2-1) \\times (2-1) = 1\\)となります。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#カイ二乗分布の確率密度関数",
    "href": "prezemi_2023_09_presen.html#カイ二乗分布の確率密度関数",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "カイ二乗分布の確率密度関数",
    "text": "カイ二乗分布の確率密度関数\n自由度1のカイ二乗分布の確率密度関数は次のようになります。\n\n\nRコード\nx = c(1:2500) / 250 # 数列を作成\ny1 = dchisq(x,1) # カイ二乗分布の確率密度\n\ndf &lt;- data.frame(x, y1) # データフレームを作成\np &lt;- ggplot(df) + aes(x = x,y = y1) # 作図\np &lt;- p + geom_line(size = 1) # 折れ線グラフ\np &lt;- p + ylim(c(0,1)) + ylab(\"密度\") + xlab(\"カイ二乗値\") +\n  scale_y_continuous(expand = c(0,0), limits = c(0,1)) +\n  scale_x_continuous(expand = c(0,0), limits = c(-0.1,10))\np &lt;- p + ggtitle(\"自由度1のχ2分布の確率密度\")\nprint(p)"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#カイ二乗分布の形状",
    "href": "prezemi_2023_09_presen.html#カイ二乗分布の形状",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "カイ二乗分布の形状",
    "text": "カイ二乗分布の形状\n自由度が変わると\\(\\chi^2\\)分布の形状は変わる。\n\n\nRコード\nx = c(1:2500) / 250\ny1 = dchisq(x,1) # 自由度1のカイ二乗分布の確率密度\ny3 = dchisq(x,3) # 自由度3のカイ二乗分布の確率密度\ny5 = dchisq(x,5) # 自由度5のカイ二乗分布の確率密度\n\ndf &lt;- data.frame(x, y1, y3, y5) # データフレームを作成\ndf &lt;- df %&gt;%\n  pivot_longer(names_to = \"y\",values_to = \"value\",cols = -x) # データを長く整形\np &lt;- ggplot(df) + aes(x = x,y = value, group = y, color = y) # 作図\np &lt;- p + geom_line(size = 1) # 折れ線グラフ\np &lt;- p + ylim(c(0,1)) + ylab(\"密度\") + xlab(\"カイ二乗値\") +\n  scale_y_continuous(expand = c(0,0), limits = c(0,1)) +\n  scale_x_continuous(expand = c(0,0), limits = c(-0.1,10))\np &lt;- p + ggtitle(\"自由度1,3,5のχ2分布の確率密度\")\nprint(p)\n\n\n\n自由度1の\\(\\chi^2\\)分布における有意水準5%の値を調べるにはqchisq()関数を使う。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#カイ二乗分布",
    "href": "prezemi_2023_09_presen.html#カイ二乗分布",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "カイ二乗分布",
    "text": "カイ二乗分布\n\nalpha &lt;- 0.05  # 有意水準（ここでは5%）\ndf &lt;- 1        # 自由度\nqchisq(1 - alpha, df)\n\n[1] 3.841459\n\n\n自由度1のカイ二乗分布における有意水準5%の値は3.84であることが分かりました。 この値を超えると、有意水準5%で帰無仮説を棄却することになります。\nでは先程計算した\\(\\chi^2\\)統計量は、有意水準5%で帰無仮説を棄却するかどうかを調べてみましょう。\n\nchi2 &lt;- 7.2\nqchisq(1 - alpha, df) &lt; chi2\n\n[1] TRUE"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#量的変数間の関係",
    "href": "prezemi_2023_09_presen.html#量的変数間の関係",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "量的変数間の関係",
    "text": "量的変数間の関係\n2つの量的変数(連続変数)が同時に変化する関係を相関関係(correlation)といいます。 相関関係には、\n\n正の相関(positive correlation)\n負の相関(negative correlation)\n無相関(no correlation)\n\nの3種類があります。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#相関係数の分析",
    "href": "prezemi_2023_09_presen.html#相関係数の分析",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "相関係数の分析",
    "text": "相関係数の分析\n母平均\\(0\\)、母標準偏差\\(1\\)，サイズ10000の正規分布にしたがう変数\\(X\\)と\\(Y\\)\n\n\nRコード\nN &lt;- 10000 # 母集団のサイズ\nX &lt;- rnorm(N, 0, 1) # 平均0，標準偏差1の正規分布からN個\nY &lt;- rnorm(N, 0, 1) # 平均0，標準偏差1の正規分布からN個\nP &lt;- data.frame(X,Y) # データフレームを作成\nggplot(P) + aes(X,Y) + # グラフの下地\n  geom_point() + # 散布図\n  ggtitle(\"母集団\")  # タイトルとスタイル"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#シミュレーション",
    "href": "prezemi_2023_09_presen.html#シミュレーション",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "シミュレーション",
    "text": "シミュレーション\nこの母集団から標本サイズ100の標本を100個とりだし、相関係数を100個計算します。\n\nn &lt;- 100; trial &lt;- 100 # 標本サイズと試行回数\nsig &lt;- numeric(n) # 空の入れ物\ncor &lt;- numeric(n) # 空の入れ物\nfor(i in 1:trial){ # ループ\n  x_sample &lt;- sample(X, n) # 母集団からn個の標本を取り出す\n  y_sample &lt;- sample(Y, n) # 母集団からn個の標本を取り出す\n  res &lt;- cor.test(x_sample, y_sample) # 相関係数を計算\n  sig[i] &lt;- res$p.value # p値\n  cor[i] &lt;- cor(x_sample, y_sample) # 相関係数\n}\ndf_cor &lt;- data.frame(cor,sig) # p値と相関係数をデータフレームにまとめる\ndf_cor %&gt;% arrange(sig) %&gt;% head(2) # p値で並び替えて上位5つを表示\n\n         cor         sig\n1  0.2786349 0.004998387\n2 -0.2237441 0.025236613"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#散布図",
    "href": "prezemi_2023_09_presen.html#散布図",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "散布図",
    "text": "散布図\nたとえば、ある標本の散布図はこうなります。\n\n\nRコード\nx_sample &lt;- sample(X, n) # 母集団Xからn個の標本を取り出す\ny_sample &lt;- sample(Y, n) # 母集団Yからn個の標本を取り出す\ndata.frame(x_sample, y_sample) %&gt;% # データフレームにまとめる\n    ggplot() + aes(x_sample, y_sample) + # グラフの下地\n    geom_point() + # 散布図\n    geom_smooth(method = \"lm\", se = FALSE) + # 回帰直線\n    ggtitle(\"標本\")  # タイトルとスタイル\n\n\n\n微妙に右肩上がりの関係がありそうですが、ほぼ無相関といえるでしょう。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#相関係数の分布",
    "href": "prezemi_2023_09_presen.html#相関係数の分布",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "相関係数の分布",
    "text": "相関係数の分布\nでは、100個の標本から計算した100個の相関係数の大きさを並べてみましょう。 変数を並び替えるには，dplyrのarrange()関数を使います。 デフォルトでは昇順に並び替えられますが，arrange(desc())とすることで降順に並び替えることができます。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#相関係数の分布-1",
    "href": "prezemi_2023_09_presen.html#相関係数の分布-1",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "相関係数の分布",
    "text": "相関係数の分布\n\n\n\n\nRコード\nggplot(data.frame(df_cor)) +\n    aes(x = reorder(seq_along(cor), cor), y = cor) +\n    geom_bar(stat = \"identity\", fill = ifelse(sig &lt; 0.05, \"red\", \"black\")) +\n    ylab(\"相関係数\") + xlab(\"標本ID\") + ggtitle(\"相関係数の分布\")"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#仮説検定",
    "href": "prezemi_2023_09_presen.html#仮説検定",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "仮説検定",
    "text": "仮説検定\nでは、それらの値が、母集団では相関係数が\\(0\\)であるという帰無仮説が正しいとした場合に、どのくらいの確率で得られるのかを調べてみましょう。\n\n\nRコード\nggplot(data.frame(df_cor)) +\n    aes(x = reorder(seq_along(sig), sig), y=sig) + # データの指定\n    geom_bar(stat=\"identity\", fill = ifelse(sig &lt; 0.05, \"red\", \"black\")) + # 棒グラフ\n    ylab(\"p値\") + xlab(\"標本ID\") + ggtitle(\"相関係数のp値の分布\")  # 軸ラベルとタイトル"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#解釈",
    "href": "prezemi_2023_09_presen.html#解釈",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "解釈",
    "text": "解釈\n相関係数が0である母集団から標本を抜き出して、その標本相関係数の値が0.28となる確率\\(p\\)値は0.005となりました。 もし自分がもっている広告費と売上高のデータから相関係数を計算し、その値が0.28であったなら、母集団では相関係数が\\(0\\)であるという帰無仮説の下では、ほとんど起こりえないことが起こったということになります。 この場合、帰無仮説が間違っていて、対立仮説である広告費と売上高には関係があるという仮説のほうがもっともらしい、ということになります。 逆に、帰無仮説を棄却できなかった場合、広告費と売上高の間に関係は無いと主張することはできません。 帰無仮説が棄却できなかった場合は、関係があるかどうかはわからないということになります。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#因果関係",
    "href": "prezemi_2023_09_presen.html#因果関係",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "因果関係",
    "text": "因果関係\n可能性1：広告費が売上高に影響を与えている、という関係を想定しています。\n\ngraph LR\n    A[広告費] --&gt; B[売上高]\n\n\n\ngraph LR\n    A[広告費] --&gt; B[売上高]"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#因果関係-1",
    "href": "prezemi_2023_09_presen.html#因果関係-1",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "因果関係",
    "text": "因果関係\n可能性2：売上高が広告費に影響を与えている、という関係を想定しています。\n\ngraph RL\n    B[売上高] --&gt; A[広告費]\n\n\n\ngraph RL\n    B[売上高] --&gt; A[広告費]"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#互恵関係",
    "href": "prezemi_2023_09_presen.html#互恵関係",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "互恵関係",
    "text": "互恵関係\n可能性3 : 可能性1と可能性2が同時に起こっている、という関係を想定しています。\n\ngraph LR\n    A[広告費] --&gt; B[売上高]\n    B[売上高] --&gt; A[広告費]\n\n\n\ngraph LR\n    A[広告費] --&gt; B[売上高]\n    B[売上高] --&gt; A[広告費]"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#見せかけの相関",
    "href": "prezemi_2023_09_presen.html#見せかけの相関",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "見せかけの相関",
    "text": "見せかけの相関\n広告費と売上高の両方に影響を与える第3の要因が存在する場合、広告費と売上高の間に相関関係があるように見える、という想定です。 \n\ngraph TB\n    A[内部資金] --&gt; B[広告費]\n    A[内部資金] --&gt; C[売上高]\n\n\n\ngraph TB\n    A[内部資金] --&gt; B[広告費]\n    A[内部資金] --&gt; C[売上高]\n\n\n\n\n\n\ngraph TB\n    A[内部資金] --&gt; B[広告費]\n    A --&gt; C[売上高]\n    B -.-&gt; C\n\n\n\ngraph TB\n    A[内部資金] --&gt; B[広告費]\n    A --&gt; C[売上高]\n    B -.-&gt; C"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#確認方法",
    "href": "prezemi_2023_09_presen.html#確認方法",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "確認方法",
    "text": "確認方法\nまずは，2つの量的変数を使って散布図(scatter diagram)を描いて，目で見て相関関係があるかどうかを判断します。 そして，相関係数(correlation coefficient)を計算して，数値的に相関関係があるかどうかを判断します。 相関係数は次のように計算されます。\n\\[\nr = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^n (x_i - \\bar{x})^2}\\sqrt{\\sum_{i=1}^n (y_i - \\bar{y})^2}}\n\\]\n分子は、\\(x\\)と\\(y\\)の共分散(covariance)で、分母は\\(x\\)の標準偏差と\\(y\\)の標準偏差の積です。 相関係数\\(r\\)は\\(-1\\)から\\(1\\)の値をとります。 \\(r\\)が\\(1\\)に近いほど正の相関が強く、\\(-1\\)に近いほど負の相関が強く、\\(0\\)に近いほど無相関になります。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#カイ二乗検定の結果",
    "href": "prezemi_2023_09_presen.html#カイ二乗検定の結果",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "カイ二乗検定の結果",
    "text": "カイ二乗検定の結果\nより、\\(\\chi^2\\)統計量は有意水準5%で帰無仮説を棄却することが分かりました。 ちなみに、自由度1のカイ二乗分布の確率密度関数と\\(\\chi^2\\)統計量の位置を重ねてみると次のようになります。\n\n\nRコード\ndf &lt;- data.frame(x,y1)\np &lt;- ggplot(df) + aes(x = x,y = y1)\np &lt;- p + geom_line(size = 1)\np &lt;- p + ylim(c(0,1)) + ylab(\"密度\") + xlab(\"カイ二乗値\") +\n  scale_y_continuous(expand = c(0,0), limits = c(0,1)) +\n  scale_x_continuous(expand = c(0,0), limits = c(-0.1,10))\np &lt;- p + ggtitle(\"自由度1のχ2分布の確率密度\")\np &lt;- p + geom_vline(xintercept = chi2, linetype = \"dashed\", color = \"red\")\np &lt;- p + annotate(\"text\", x = chi2, y = 0.1, label = \"χ2 statistics\", color = \"red\")\nprint(p)"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#カイ二乗検定の結果-1",
    "href": "prezemi_2023_09_presen.html#カイ二乗検定の結果-1",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "カイ二乗検定の結果",
    "text": "カイ二乗検定の結果\nこのように、\\(\\chi^2\\)統計量は、自由度1のカイ二乗分布のもとで生じる確率は、\n\n1 - pchisq(chi2, df = 1)\n\n[1] 0.007290358\n\n\nとなり、非常に小さな値であることが分かりました。 つまり、2つのカテゴリー変数の間に関係がない、という帰無仮説の下で、観測された度数が発生することはほぼありえない、ということが言えるので、帰無仮説は棄却され、2つのカテゴリー変数には関係があると結論付けられます。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#rでχ2検定",
    "href": "prezemi_2023_09_presen.html#rでχ2検定",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "Rでχ2検定",
    "text": "Rでχ2検定\nchisq.test()関数を使ってχ2検定を行う。 引数は、xに度数表、correctに補正を行うかどうか、pに期待度数を指定する。 matrix()関数を使ってクロス集計表を行列として作成する。\n\n\nRコード\nO &lt;- matrix(c(41, 81, 204, 74), nrow = 2, ncol = 2)\nrow.names(O) &lt;- c(\"男性\", \"女性\")\ncolnames(O) &lt;- c(\"メガネ\", \"メガネなし\")\n\nE &lt;- matrix(c(\n  sum(O[,1])*sum(O[1,])/sum(O), #男眼鏡\n  sum(O[,1])*sum(O[2,])/sum(O), #男眼鏡無\n  sum(O[,2])*sum(O[1,])/sum(O), #女眼鏡\n  sum(O[,2])*sum(O[2,])/sum(O)  #女眼鏡無\n), nrow = 2, ncol = 2)\n\nprint(O)\n\n\n     メガネ メガネなし\n男性     41        204\n女性     81         74\n\n\nRコード\nprint(E)\n\n\n       [,1]    [,2]\n[1,] 74.725 170.275\n[2,] 47.275 107.725"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#rでχ2検定-1",
    "href": "prezemi_2023_09_presen.html#rでχ2検定-1",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "Rでχ2検定",
    "text": "Rでχ2検定\nこの観察度数と期待度数から、定義通りに\\(\\chi^2\\)統計量を計算してみます。\n\nchi &lt;-  (O[1,1] - E[1,1])^2 / E[1,1] + #男眼鏡\n        (O[1,2] - E[1,2])^2 / E[1,2] + #男眼鏡無\n        (O[2,1] - E[2,1])^2 / E[2,1] + #女眼鏡\n        (O[2,2] - E[2,2])^2 / E[2,2]   #女眼鏡無\nprint(chi)\n\n[1] 56.51731\n\n\n\\(\\chi^2\\)統計量がとなりました。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#rでχ2検定-2",
    "href": "prezemi_2023_09_presen.html#rでχ2検定-2",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "Rでχ2検定",
    "text": "Rでχ2検定\nこの\\(\\chi^2\\)統計量が自由度1の\\(\\chi^2\\)分布にしたがう場合，この統計量が得られる確率は次のようになります。\n\nprop &lt;- 1 - pchisq(chi, df = 1)\nprint(prop)\n\n[1] 5.57332e-14\n\n\nこの確率は0.0000000000000055733となり，ほぼゼロであることが分かりました。 よって、2つのカテゴリー変数は無関係である，という帰無仮説は棄却され、2つのカテゴリー変数には関係があると結論付けられます。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#rでχ2検定-3",
    "href": "prezemi_2023_09_presen.html#rでχ2検定-3",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "Rでχ2検定",
    "text": "Rでχ2検定\nちなみに，上記のようなめんどくさい処理をしなくても，Rにはchisq.test()という関数が用意されています。 chisq.test()は引数として、xに度数表、correctに補正を行うかどうか、pに期待度数を指定します。 補正は行わないので，correctはFALSEとします。 pはデフォルトで等確率となっているので，今回は省略します。\n\nchisq.test(O, correct = FALSE)\n\n\n    Pearson's Chi-squared test\n\ndata:  O\nX-squared = 56.517, df = 1, p-value = 5.571e-14\n\n\nとなり，先ほどの結果と一致しました。"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#フィッシャーの直接確率検定",
    "href": "prezemi_2023_09_presen.html#フィッシャーの直接確率検定",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "フィッシャーの直接確率検定",
    "text": "フィッシャーの直接確率検定\n各マスに入る度数が少ない場合には、フィッシャーの直接確率検定を使います。\n\nfisher.test(O)\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  O\np-value = 1.204e-13\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.1127341 0.2982245\nsample estimates:\nodds ratio \n 0.1845096"
  },
  {
    "objectID": "prezemi_2023_09_presen.html#カイ二乗分布補足",
    "href": "prezemi_2023_09_presen.html#カイ二乗分布補足",
    "title": "プレゼミ2023  第9回 変数間の関連性",
    "section": "カイ二乗分布(補足)",
    "text": "カイ二乗分布(補足)\nカイ二乗分布は、確率変数\\(Z_1, Z_2,\\dots, Z_k\\)が互いに独立であり、それぞれが標準正規分布\\(N(0,1)\\)に従うとき、その二乗和が従う分布を自由度\\(k\\)のカイ二乗分布といいます。\n\\[\n\\chi^2 = Z_1^2 + Z_2^2 + \\dots + Z_k^2\n\\]\n導出は省きますが、自由度\\(k\\)のカイ二乗分布の密度関数は、\n\\[\n\\begin{aligned}\nf(x) =\n\\begin{cases}\n\\frac{1}{2^{k/2} \\Gamma(k/2)} x^{k/2 - 1} \\mathrm{e}^{-x/2} & (x \\geq 0)\\\\\n0 & (x &lt; 0)\n\\end{cases}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#準備",
    "href": "prezemi_2023_10_presen.html#準備",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "準備",
    "text": "準備\n必要なパッケージと設定。無ければインストールする。\n\nknitr::opts_chunk$set(dev = \"ragg_png\")\nlibrary(tidyverse) # とりあえずこれ\nlibrary(ggthemes) # ggplot2のテーマ\nlibrary(knitr) # 作表\nlibrary(kableExtra) # 作表の拡張\nlibrary(scales) # 軸の単位を制御\nlibrary(modelsummary) # モデルのまとめ\ntheme_set(theme_few(base_size = 12))\nupdate_geom_defaults(\"point\", list(size = 3))"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#データの読み込み",
    "href": "prezemi_2023_10_presen.html#データの読み込み",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "データの読み込み",
    "text": "データの読み込み\n松浦のウェブサイトからデータadv_2023.csvを読み込む。\n\ndf &lt;- read_csv(\"https://so-ichi.com/adv_2023.csv\")\nrmarkdown::paged_table(df, options = list(rows.print = 5, cols.print = 3))"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#単回帰モデル",
    "href": "prezemi_2023_10_presen.html#単回帰モデル",
    "title": "プレゼミ2023  第10回 単回帰分析",
    "section": "単回帰モデル",
    "text": "単回帰モデル\n前回は売上高と広告宣伝費の関係を散布図(scatter diagram)と相関係数(correlation)を使って調べた。\n\n相関係数は0.424"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#変数間の関係",
    "href": "prezemi_2023_10_presen.html#変数間の関係",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "2変数間の関係",
    "text": "2変数間の関係\n前回は売上高と広告宣伝費の関係を散布図(scatter diagram)と相関係数(correlation)を使って調べた。\n\n相関係数はNAと正の相関がある。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#単回帰モデル-1",
    "href": "prezemi_2023_10_presen.html#単回帰モデル-1",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "単回帰モデル",
    "text": "単回帰モデル\n\n回帰モデル(regression model)とは、応答変数\\(Y\\)を説明変数\\(X\\)の線形関数で表したモデルで、背後には\\(X \\rightarrow Y\\)という因果関係(causality)があると仮定する。\n相関係数は2変数間の線形関係を表す指標ではあるが、相関があるからといって因果関係(causality)があるとは限らない。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#単回帰モデル-2",
    "href": "prezemi_2023_10_presen.html#単回帰モデル-2",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "単回帰モデル",
    "text": "単回帰モデル\n売上高を広告宣伝費で説明するモデルを考える。\n\ngraph LR\nA[広告宣伝費] --&gt; B[売上高]\n\n\n\ngraph LR\nA[広告宣伝費] --&gt; B[売上高]\n\n\n\n\n\nこの因果関係を明らかにするため、売上高を応答変数\\(Y\\)、広告宣伝費を説明変数\\(X\\)として回帰モデルを構築する。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#重回帰分析による統計的推定",
    "href": "prezemi_2023_10_presen.html#重回帰分析による統計的推定",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "重回帰分析による統計的推定",
    "text": "重回帰分析による統計的推定\n重回帰モデル\n重回帰でも単回帰でも統計的推定に変わりはありません。 重回帰モデルを以下のように表します。\n\\[\nY_i = \\beta _0 + \\beta_1 x_{i1} + \\beta_2 x_{i2} + \\cdots + \\beta_p x_{ik} + \\varepsilon_i\n\\]\nこの回帰係数\\(\\beta\\)の推定値\\(b\\)を求めることが統計的推定です。\n企業の売上高は、前年度の広告宣伝費と研究開発費で説明できる、つまり前年度の広告宣伝費と研究開発費が高いほど、売上高が高くなるのかどうかを考えてみます。\n\\[\n\\text{売上高}_t = \\beta_0 + \\beta_1 \\text{広告宣伝費}_{t-1} + \\beta_2 \\text{研究開発費}_{t-1} + \\varepsilon_t\n\\]\nではこの回帰モデルを推定するためのデータを読み込むため、tidyverseのreadrパッケージのread_csv()関数を使って、作業ディレクトリのdataフォルダの中に保存されているadv_2023.csvを読み込みます。\n\ndf &lt;- read_csv(\"data/adv_2023.csv\")\n\n重回帰モデルを推定するには、基本関数のlm()を使います。 重回帰モデルの場合、複数の説明変数があるため+でつなげていきます。\n\nres &lt;- lm(売上高 ~ lag(研究開発費) + lag(広告宣伝費), data = df)\ncoef(res)\n\n    (Intercept) lag(研究開発費) lag(広告宣伝費) \n   1.004955e+05    1.716521e+01    6.913074e+00 \n\n\n上記の推定結果から、\n\\[\n\\text{売上高} = 0.00000 + 0.1716 \\text{研究開発費}_{t-1} + 6.8131 \\text{広告宣伝費}_{t-1}\n\\] であることが分かりました。\n信頼区間と仮説検定\n先ほどの回帰係数の推定結果は，1サンプルからの結果であり，サンプルの数を増やせば推定値の分布ができるのは，単回帰分析と同じなので， ここでも同じ方法で信頼区間を求めることが出来ます。 単回帰分析の場合，切片と回帰係数の2つが推定するパラメータなので，自由度が\\(n-2\\)の\\(t\\)分布を利用しました。 説明変数が\\(k\\)個ある重回帰分析の推定で利用する\\(t\\)分布の自由度は，\\(n-k-1\\)になります。 \\(100(1-\\alpha)\\)％信頼区間は，\n\\[\nb_m - t _{n-k-1, \\frac{\\alpha}{2}} SE(b_m) \\leq \\beta_m \\leq b_m + t_{n-k-1, \\frac{\\alpha}{2}} SE(b_m)\n\\]\nのように計算できます。 先ほど推定した重回帰分析の結果を再度確認してみます。\n\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + lag(広告宣伝費), \n    data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12323473   -100139    -69328     20239  19099811 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     1.005e+05  1.257e+04   7.995 1.58e-15 ***\nlag(研究開発費) 1.717e+01  2.639e-01  65.039  &lt; 2e-16 ***\nlag(広告宣伝費) 6.913e+00  5.164e-01  13.386  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 862200 on 5171 degrees of freedom\n  ( 23266 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.7853,    Adjusted R-squared:  0.7853 \nF-statistic:  9460 on 2 and 5171 DF,  p-value: &lt; 2.2e-16\n\n\nここから信頼区間を計算するためには，サンプルサイズ\\(n\\)と説明変数の数\\(k\\)から自由度\\(df = n - k -1\\)を求め， そのもとで特定の有意水準を設定して，関数qt()を使って\\(t\\)値を計算します。 先ほどの重回帰の例だと，サンプルサイズは28440，説明変数の数は2なので，有意水準5％の両側検定を行う場合の\\(t\\)値は，\n\nn &lt;- nrow(df) # サンプルサイズ\nk &lt;- 2 # 説明変数の数\nfreedom &lt;- n - 2 - 1\np &lt;- 0.025 # 両側5%なので片側2.5％\nqt(p, freedom , lower.tail = F)\n\n[1] 1.960047\n\n\nすると\\(t\\)値は，1.96と計算できました。\n仮説検定\n重回帰分析で検証したい仮説は，説明変数が応答変数に影響を与えるか否かですが，複数の説明変数があるため，仮説には2つのパターンがあります。 1つ目は，回帰係数のすべてがゼロである，という帰無仮説です。 構築した回帰モデルの説明変数の中に，応答変数に影響を与えるものが1つもない，という仮説です。 \\[\n\\begin{aligned}\nH_0 : &\\beta _1 = \\beta _2 = \\cdots = \\beta_k = 0\\\\\nH_A : &\\beta _1 \\not = 0 \\text{ or } \\beta _2 \\not = 0 \\text{ or } \\cdots \\text{ or } \\beta _k \\not = 0\n\\end{aligned}\n\\]\n2つ目は，回帰係数の中に少なくとも1つはゼロではない，という仮説です。 この仮説だと，個々の説明変数が応答変数に与える影響を別々に考え，説明変数ごとに回帰係数がゼロとなるかどうかを調べることになります。\n\\[\n\\begin{aligned}\nH_{01}: \\beta _1 &= 0, & H_{a1} : \\beta _1 \\not = 0 \\\\\nH_{02}: \\beta _1 &= 0, & H_{a2} : \\beta _1 \\not = 0 \\\\\n\\vdots \\\\\nH_{0k}: \\beta _k &= 0, & H_{ak} : \\beta _k \\not = 0 \\\\\n\\end{aligned}\n\\]\n1つの仮説の検定\nすべての回帰係数がゼロかどうかを検定するためには，F分布という確率分布を用います。 F分布の確率密度関数の導出は難しいのでここでは省略します F分布の下で，自由度\\(n - k -1\\)で説明変数の数が\\(k\\)個であるときの検定統計量\\(F_0\\)は，次のように計算できます。\n\\[\n\\begin{aligned}\nF_0 = \\frac{R^2}{1 - R^2} \\frac{n - k - 1}{k} = \\displaystyle \\frac{\\sum (\\hat y - \\bar y)^2}{k} \\div \\frac{\\sum e_i-2}{n - k - 1}\n\\end{aligned}\n\\]\nここで\\(R^2\\)は決定係数です。 この検定統計量\\(F_0\\)を用いたF検定の結果は，lm()関数で推定した結果のsummary()関数で確認できます。\n\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + lag(広告宣伝費), \n    data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12323473   -100139    -69328     20239  19099811 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     1.005e+05  1.257e+04   7.995 1.58e-15 ***\nlag(研究開発費) 1.717e+01  2.639e-01  65.039  &lt; 2e-16 ***\nlag(広告宣伝費) 6.913e+00  5.164e-01  13.386  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 862200 on 5171 degrees of freedom\n  ( 23266 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.7853,    Adjusted R-squared:  0.7853 \nF-statistic:  9460 on 2 and 5171 DF,  p-value: &lt; 2.2e-16\n\n\n結果の最後の行でF-statistic:  9460 on 2 and 5171 DF,  p-value: &lt; 2.2e-16とあり，自由度2と5171のF分布で検定した結果，検定統計量\\(F_0\\)は9460であり，p値はほぼゼロとなりました。 つまり，帰無仮説である「すべての回帰係数がゼロ」は棄却され，少なくとも一つの回帰係数はゼロではない，という対立仮説が採択されました。\nt分布と同様にF分布を用いた検定の臨界値は基本関数qf()で計算できます。 先ほどの例だと，サンプルサイズは28440，説明変数の数は2なので，有意水準5％の両側検定を行う場合の\\(t\\)値は，\n\np = 0.05\nf1 &lt;- 2\nf2 &lt;- 5171\nqf(p,f1,f2,lower.tail =F)\n\n[1] 2.997468\n\n\nとなり，2.9975という臨界値が得られた。 先ほどの推定結果からF値が9460と，臨界値を遙かに超える値であったため，帰無仮説は棄却された。\n回帰係数の個別的検定\n第2の仮説のパターンである個々の回帰係数の検定について考えてみましょう。 売上高を研究開発費と広告宣伝費で説明しようとした重回帰モデルだと，次の2つの仮説を検定することになります。\n\\[\n\\begin{aligned}\n\\text{研究開発費} H_{01} : \\beta_1 = 0, & H_{a1} : \\beta_1 \\not = 0 \\\\\n\\text{広告宣伝費} H_{02} : \\beta_1 = 0, & H_{a2} : \\beta_1 \\not = 0\n\\end{aligned}\n\\]\n回帰係数の個別的検定は，単回帰分析と同様にt検定を用います。 この分析結果も，summary()関数で確認できます。\n\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + lag(広告宣伝費), \n    data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12323473   -100139    -69328     20239  19099811 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     1.005e+05  1.257e+04   7.995 1.58e-15 ***\nlag(研究開発費) 1.717e+01  2.639e-01  65.039  &lt; 2e-16 ***\nlag(広告宣伝費) 6.913e+00  5.164e-01  13.386  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 862200 on 5171 degrees of freedom\n  ( 23266 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.7853,    Adjusted R-squared:  0.7853 \nF-statistic:  9460 on 2 and 5171 DF,  p-value: &lt; 2.2e-16\n\n\nCoefficientsの出力結果に，各説明変数の回帰係数の推定値Estimateと標準誤差Std. Error，t値t value，p値Pr(&gt;|t|)が表示されています。 このp値が設定した有意水準より小さい場合，その回帰係数がゼロであるという帰無仮説が棄却され，説明変数が応答変数に影響を与えている，という対立仮説が採択されるのです。\nこのように複数の説明変数で応答変数を説明しようとする重回帰分析だと，2種類の仮説検証を行うことになります。 気をつける点として，すべての回帰係数がゼロであるという帰無仮説を検証するF検定で，帰無仮説が棄却されたとしても，個別の回帰係数の検定で，すべての検定で帰無仮説を棄却できない，というケースも起こり得ます。 このような結果が出たときは，説明変数どうしの相関が強いときに生じやすいので注意しよう。\n重回帰分析の結果を論文などに掲載する場合には，ほぼ決まったフォーマットがあるため，それに従って結果をまとめることになります。 例えば，次のような表を作成することになります。\n\nlibrary(modelsummary)\nmsummary(res,\n  stars = TRUE, # p値の有意性を星で表示する\n  fmt = '%.2f',\n  gof_omit = \"AIC|BIC|Log.Lik.\",\n  output = 'html'\n)\n\n\n\n\n\n (1)\n\n\n\n\n(Intercept)\n100495.49***\n\n\n\n(12569.41)\n\n\nlag(研究開発費)\n17.17***\n\n\n\n(0.26)\n\n\nlag(広告宣伝費)\n6.91***\n\n\n\n(0.52)\n\n\nNum.Obs.\n5174\n\n\nR2\n0.785\n\n\nR2 Adj.\n0.785\n\n\nRMSE\n861991.65\n\n\n\n + p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#まとめ",
    "href": "prezemi_2023_10_presen.html#まとめ",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "まとめ",
    "text": "まとめ\n\n観測値とモデルとの差を表す確率変数である誤差項を含んだ確率的回帰モデルを考える。\n誤差項は平均ゼロの正規分布にしたがう確率変数であると仮定\n回帰分析の目的は係数\\(\\beta_m\\)の推定値\\(b_m\\)の値を求めること\n推定値\\(b_m\\)は標本ごとに異なる値で分布する。推定値の信頼区間を求めて推定の不確実性を評価\n重回帰モデルの仮説検定は2種類:すべての回帰係数がゼロであると個々の回帰係数がゼロである、がある。前者にはF検定，後者にはt検定を用いる。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#単回帰モデル-3",
    "href": "prezemi_2023_10_presen.html#単回帰モデル-3",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "単回帰モデル",
    "text": "単回帰モデル\nここでは次のような線形モデルを構築する。\n\\[\nY_i = \\beta _0 + \\beta_1 X_i\n\\]\n\n\\(\\beta_0\\)と\\(\\beta_1\\)はパラメータ(定数)\nこのモデルにしたがうと，\\(X_i\\)の値が決まれば、応答変数\\(Y\\)の値は一意に決まる。\nこのようなモデルを決定的モデル(deterministic model)"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#単回帰モデル-4",
    "href": "prezemi_2023_10_presen.html#単回帰モデル-4",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "単回帰モデル",
    "text": "単回帰モデル\n現実には、広告宣伝費が同じでも売上高が異なることがある。 そこで売上高の水準が広告宣伝費だけで決まるのではなく、誤差\\(\\varepsilon\\)を回帰モデルに加えたものを考える。\n\\[\nY_i = \\beta _0 + \\beta_1 X_i + \\varepsilon_i\n\\]\n\n\n確率変数である誤差項を含めたモデルを確率モデル(probabilistic model)という。\nここでは\\(\\varepsilon_i\\)が正規分布に従うと仮定する。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#単回帰モデルの図",
    "href": "prezemi_2023_10_presen.html#単回帰モデルの図",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "単回帰モデルの図",
    "text": "単回帰モデルの図"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#単回帰モデルの過程",
    "href": "prezemi_2023_10_presen.html#単回帰モデルの過程",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "単回帰モデルの過程",
    "text": "単回帰モデルの過程\nこの回帰モデルが意味をもつためには、誤差項\\(\\varepsilon_i\\)が平均0で分散\\(\\sigma^2\\)の正規分布に従うという仮定が必要です。\n\n図11.1信頼区間と仮説検定"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#単回帰モデルの仮定",
    "href": "prezemi_2023_10_presen.html#単回帰モデルの仮定",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "単回帰モデルの仮定",
    "text": "単回帰モデルの仮定\nこの回帰モデルが意味をもつためには、誤差項\\(\\varepsilon_i\\)が平均0で分散\\(\\sigma^2\\)の正規分布に従うという仮定が必要です。\n\n図11.1"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#重回帰モデル",
    "href": "prezemi_2023_10_presen.html#重回帰モデル",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "重回帰モデル",
    "text": "重回帰モデル\n重回帰でも単回帰でも統計的推定は同じで、説明変数が1つか複数かの違いだけである。\n\\[\nY_i = \\beta _0 + \\beta_1 x_{i1} + \\beta_2 x_{i2} + \\cdots + \\beta_p x_{ik} + \\varepsilon_i\n\\]\nこの回帰係数\\(\\beta\\)の推定値\\(b\\)を求めることが統計的推定となる。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#重回帰モデル-1",
    "href": "prezemi_2023_10_presen.html#重回帰モデル-1",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "重回帰モデル",
    "text": "重回帰モデル\n企業の売上高は、前年度の広告宣伝費と研究開発費で説明できる、というモデルを考える。\n\\[\n\\text{売上高}_t = \\beta_0 + \\beta_1 \\text{広告宣伝費}_{t-1} + \\beta_2 \\text{研究開発費}_{t-1} + \\varepsilon_t\n\\]"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#重回帰モデルの推定",
    "href": "prezemi_2023_10_presen.html#重回帰モデルの推定",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "重回帰モデルの推定",
    "text": "重回帰モデルの推定\n\n重回帰モデルを推定するには、基本関数のlm()を使う。\n重回帰モデルの場合、複数の説明変数があるため+でつなげる\n\n\nres &lt;- lm(売上高 ~ lag(研究開発費) + lag(広告宣伝費), data = df)\ncoef(res)\n\n    (Intercept) lag(研究開発費) lag(広告宣伝費) \n   1.004955e+05    1.716521e+01    6.913074e+00"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#結果の解釈",
    "href": "prezemi_2023_10_presen.html#結果の解釈",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "結果の解釈",
    "text": "結果の解釈\n上記の推定結果から、\n\\[\n\\text{売上高} = 0.00000 + 0.1716 \\text{研究開発費}_{t-1} + 6.8131 \\text{広告宣伝費}_{t-1}\n\\]\nであることが分かった。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#結果の解釈-1",
    "href": "prezemi_2023_10_presen.html#結果の解釈-1",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "結果の解釈",
    "text": "結果の解釈\n先ほど推定した重回帰分析の結果を再度確認してみます。\n\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + lag(広告宣伝費), \n    data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12323473   -100139    -69328     20239  19099811 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     1.005e+05  1.257e+04   7.995 1.58e-15 ***\nlag(研究開発費) 1.717e+01  2.639e-01  65.039  &lt; 2e-16 ***\nlag(広告宣伝費) 6.913e+00  5.164e-01  13.386  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 862200 on 5171 degrees of freedom\n  ( 23266 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.7853,    Adjusted R-squared:  0.7853 \nF-statistic:  9460 on 2 and 5171 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#仮説検定",
    "href": "prezemi_2023_10_presen.html#仮説検定",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "仮説検定",
    "text": "仮説検定\n重回帰分析で検証したい仮説は，説明変数が応答変数に影響を与えるか否かですが，複数の説明変数があるため，仮説には2つのパターンがあります。 1つ目は，回帰係数のすべてがゼロである，という帰無仮説です。 構築した回帰モデルの説明変数の中に，応答変数に影響を与えるものが1つもない，という仮説です。 \\[\n\\begin{aligned}\nH_0 : &\\beta _1 = \\beta _2 = \\cdots = \\beta_k = 0\\\\\nH_A : &\\beta _1 \\not = 0 \\text{ or } \\beta _2 \\not = 0 \\text{ or } \\cdots \\text{ or } \\beta _k \\not = 0\n\\end{aligned}\n\\]\n2つ目は，回帰係数の中に少なくとも1つはゼロではない，という仮説です。 この仮説だと，個々の説明変数が応答変数に与える影響を別々に考え，説明変数ごとに回帰係数がゼロとなるかどうかを調べることになります。\n\\[\n\\begin{aligned}\nH_{01}: \\beta _1 &= 0, & H_{a1} : \\beta _1 \\not = 0 \\\\\nH_{02}: \\beta _1 &= 0, & H_{a2} : \\beta _1 \\not = 0 \\\\\n\\vdots \\\\\nH_{0k}: \\beta _k &= 0, & H_{ak} : \\beta _k \\not = 0 \\\\\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#つの仮説の検定",
    "href": "prezemi_2023_10_presen.html#つの仮説の検定",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "1つの仮説の検定",
    "text": "1つの仮説の検定\nすべての回帰係数がゼロかどうかを検定するためには，F分布という確率分布を用います。 F分布の確率密度関数の導出は難しいのでここでは省略します F分布の下で，自由度\\(n - k -1\\)で説明変数の数が\\(k\\)個であるときの検定統計量\\(F_0\\)は，次のように計算できます。\n\\[\n\\begin{aligned}\nF_0 = \\frac{R^2}{1 - R^2} \\frac{n - k - 1}{k} = \\displaystyle \\frac{\\sum (\\hat y - \\bar y)^2}{k} \\div \\frac{\\sum e_i-2}{n - k - 1}\n\\end{aligned}\n\\]\nここで\\(R^2\\)は決定係数です。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#信頼区間と仮説検定",
    "href": "prezemi_2023_10_presen.html#信頼区間と仮説検定",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "信頼区間と仮説検定",
    "text": "信頼区間と仮説検定\n\n単回帰分析の場合，切片と回帰係数の2つが推定するパラメータなので，自由度が\\(n-2\\)の\\(t\\)分布を利用しました。 説明変数が\\(k\\)個ある重回帰分析の推定で利用する\\(t\\)分布の自由度は，\\(n-k-1\\)になります。 \\(100(1-\\alpha)\\)％信頼区間は，\n\\[\nb_m - t _{n-k-1, \\frac{\\alpha}{2}} SE(b_m) \\leq \\beta_m \\leq b_m + t_{n-k-1, \\frac{\\alpha}{2}} SE(b_m)\n\\]\nのように計算できる。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#結果の解釈-2",
    "href": "prezemi_2023_10_presen.html#結果の解釈-2",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "結果の解釈",
    "text": "結果の解釈\nここから信頼区間を計算するためには，サンプルサイズ\\(n\\)と説明変数の数\\(k\\)から自由度\\(df = n - k -1\\)を求め，そのもとで特定の有意水準を設定して，関数qt()を使って\\(t\\)値を計算する。\n先ほどの重回帰の例だと，サンプルサイズは28440，説明変数の数は2なので，有意水準5％の両側検定を行う場合の\\(t\\)値は，\n\nn &lt;- nrow(df) # サンプルサイズ\nk &lt;- 2 # 説明変数の数\nfreedom &lt;- n - 2 - 1\np &lt;- 0.025 # 両側5%なので片側2.5％\nqt(p, freedom , lower.tail = F)\n\n[1] 1.960047\n\n\nすると\\(t\\)値は，1.96となる。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#仮説検定-1",
    "href": "prezemi_2023_10_presen.html#仮説検定-1",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "仮説検定 1",
    "text": "仮説検定 1\n重回帰分析で検証したい仮説は，説明変数が応答変数に影響を与えるか否かですが，複数の説明変数があるため，仮説には2つのパターンがあります。\n回帰係数のすべてがゼロである，という帰無仮説\n構築した回帰モデルの説明変数の中に，応答変数に影響を与えるものが1つもない，という仮説です。 \\[\n\\begin{aligned}\nH_0 : &\\beta _1 = \\beta _2 = \\cdots = \\beta_k = 0\\\\\nH_A : &\\beta _1 \\not = 0 \\text{ or } \\beta _2 \\not = 0 \\text{ or } \\cdots \\text{ or } \\beta _k \\not = 0\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#仮説検定-2",
    "href": "prezemi_2023_10_presen.html#仮説検定-2",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "仮説検定 2",
    "text": "仮説検定 2\n2つ目は，回帰係数の中に少なくとも1つはゼロではない，という帰無仮説である。\nこの仮説だと，個々の説明変数が応答変数に与える影響を別々に考え，説明変数ごとに回帰係数がゼロとなるかどうかを調べる。\n\\[\n\\begin{aligned}\nH_{01}: \\beta _1 &= 0, & H_{a1} : \\beta _1 \\not = 0 \\\\\nH_{02}: \\beta _1 &= 0, & H_{a2} : \\beta _1 \\not = 0 \\\\\n\\vdots \\\\\nH_{0k}: \\beta _k &= 0, & H_{ak} : \\beta _k \\not = 0 \\\\\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#回帰係数の個別的検定-1",
    "href": "prezemi_2023_10_presen.html#回帰係数の個別的検定-1",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "回帰係数の個別的検定",
    "text": "回帰係数の個別的検定\n回帰係数の個別的検定は，単回帰分析と同様にt検定を用いる。 分析結果をsummary()関数で確認する。\n\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + lag(広告宣伝費), \n    data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12323473   -100139    -69328     20239  19099811 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     1.005e+05  1.257e+04   7.995 1.58e-15 ***\nlag(研究開発費) 1.717e+01  2.639e-01  65.039  &lt; 2e-16 ***\nlag(広告宣伝費) 6.913e+00  5.164e-01  13.386  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 862200 on 5171 degrees of freedom\n  ( 23266 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.7853,    Adjusted R-squared:  0.7853 \nF-statistic:  9460 on 2 and 5171 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#結果の見方",
    "href": "prezemi_2023_10_presen.html#結果の見方",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "結果の見方",
    "text": "結果の見方\n\nCoefficientsの出力結果に，各説明変数の回帰係数の推定値Estimateと標準誤差Std. Error，t値t value，p値Pr(&gt;|t|)が表示\np値が設定した有意水準より小さい場合，その回帰係数がゼロであるという帰無仮説が棄却され，説明変数が応答変数に影響を与えている，という対立仮説が採択\nすべての回帰係数がゼロであるという帰無仮説を検証するF検定で，帰無仮説が棄却されたとしても，個別の回帰係数の検定で，すべての検定で帰無仮説を棄却できない，というケースも起こりうる。\nこのような結果が出たときは，説明変数どうしの相関が強いときに生じやすいので注意"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#重回帰分析の結果のまとめ方",
    "href": "prezemi_2023_10_presen.html#重回帰分析の結果のまとめ方",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "重回帰分析の結果のまとめ方",
    "text": "重回帰分析の結果のまとめ方\n重回帰分析の結果を論文などに掲載する場合には，ほぼ決まったフォーマットがあるため，それに従って結果をまとめる。 ここでは超便利パッケージmodelsummaryを使う。\n\nlibrary(modelsummary)\nlibrary(gt)\nmsummary(res,\n  stars = TRUE, # p値の有意性を星で表示する\n  fmt = '%.2f', # 小数点以下2桁で表示\n  gof_omit = \"AIC|BIC|Log.Lik.\" # いらない統計量\n)"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#重回帰分析の結果のまとめ方-output",
    "href": "prezemi_2023_10_presen.html#重回帰分析の結果のまとめ方-output",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "重回帰分析の結果のまとめ方",
    "text": "重回帰分析の結果のまとめ方\n\n\n\n\n\n (1)\n\n\n\n\n(Intercept)\n100495.49***\n\n\n\n(12569.41)\n\n\nlag(研究開発費)\n17.17***\n\n\n\n(0.26)\n\n\nlag(広告宣伝費)\n6.91***\n\n\n\n(0.52)\n\n\nNum.Obs.\n5174\n\n\nR2\n0.785\n\n\nR2 Adj.\n0.785\n\n\nRMSE\n861991.65\n\n\n\n + p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#回帰係数の個別的検定",
    "href": "prezemi_2023_10_presen.html#回帰係数の個別的検定",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "回帰係数の個別的検定",
    "text": "回帰係数の個別的検定\n第2の仮説のパターンである個々の回帰係数の検定について考えてみる。 売上高を研究開発費と広告宣伝費で説明しようとした重回帰モデルだと，次の2つの仮説を検定することになる。\n\\[\n\\begin{aligned}\n\\text{研究開発費} H_{01} : \\beta_1 = 0, & H_{a1} : \\beta_1 \\not = 0 \\\\\n\\text{広告宣伝費} H_{02} : \\beta_1 = 0, & H_{a2} : \\beta_1 \\not = 0\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#つの仮説の検定-1",
    "href": "prezemi_2023_10_presen.html#つの仮説の検定-1",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "1つの仮説の検定",
    "text": "1つの仮説の検定\nこの検定統計量\\(F_0\\)を用いたF検定の結果は，lm()関数で推定した結果のsummary()関数で確認できます。\n\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + lag(広告宣伝費), \n    data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12323473   -100139    -69328     20239  19099811 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     1.005e+05  1.257e+04   7.995 1.58e-15 ***\nlag(研究開発費) 1.717e+01  2.639e-01  65.039  &lt; 2e-16 ***\nlag(広告宣伝費) 6.913e+00  5.164e-01  13.386  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 862200 on 5171 degrees of freedom\n  ( 23266 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.7853,    Adjusted R-squared:  0.7853 \nF-statistic:  9460 on 2 and 5171 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#つの仮説の検定-2",
    "href": "prezemi_2023_10_presen.html#つの仮説の検定-2",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "1つの仮説の検定",
    "text": "1つの仮説の検定\n\n結果の最後の行でF-statistic:  9460 on 2 and 5171 DF,  p-value: &lt; 2.2e-16とあり，自由度2と5171のF分布で検定した結果，検定統計量\\(F_0\\)は9460であり，p値はほぼゼロとなった。\nつまり，帰無仮説である「すべての回帰係数がゼロ」は棄却され，少なくとも一つの回帰係数はゼロではない，という対立仮説が採択された。\nt分布と同様にF分布を用いた検定の臨界値は基本関数qf()で計算できる。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#つの仮説の検定-3",
    "href": "prezemi_2023_10_presen.html#つの仮説の検定-3",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "1つの仮説の検定",
    "text": "1つの仮説の検定\nここでは、サンプルサイズは28440，説明変数の数は2なので，有意水準5％の両側検定を行う場合の\\(t\\)値は，\n\np = 0.05\nf1 &lt;- 2\nf2 &lt;- 28440\nqf(p,f1,f2,lower.tail =F)\n\n[1] 2.996048\n\n\nとなり，2.996という臨界値が得られた。 先ほどの推定結果からF値が9460と，臨界値を遙かに超える値であったため，帰無仮説は棄却された。"
  },
  {
    "objectID": "prezemi_2023_10_presen.html#変数",
    "href": "prezemi_2023_10_presen.html#変数",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "変数",
    "text": "変数\nadv_2023.csvの中に含まれる変数\n\nnames(df)\n\n [1] \"日経会社コード\" \"企業名称\"       \"決算期\"         \"決算種別\"      \n [5] \"連結基準\"       \"決算月数\"       \"業種\"           \"資産合計\"      \n [9] \"売上高\"         \"販管費\"         \"広告宣伝費\"     \"拡販費\"        \n[13] \"研究開発費\"     \"設備投資額\""
  },
  {
    "objectID": "prezemi_2023_10_presen.html#今後のスケジュール",
    "href": "prezemi_2023_10_presen.html#今後のスケジュール",
    "title": "プレゼミ2023  第10回 回帰分析",
    "section": "今後のスケジュール",
    "text": "今後のスケジュール\n最終確認\n\n12/04(月) 回帰分析 (11)\n12/11(月) 回帰分析の応用 (12)\n12/18(月) ロジスティック回帰分析 (13)\n12/25(月) 休講\n01/15(月) 因子分析 (14)\n01/15(月) 因子分析の実践+α (15)"
  },
  {
    "objectID": "test.html",
    "href": "test.html",
    "title": "プレゼミレポート",
    "section": "",
    "text": "はじめに"
  },
  {
    "objectID": "test.html#はじめに",
    "href": "test.html#はじめに",
    "title": "プレゼミレポート",
    "section": "",
    "text": "はじめに"
  },
  {
    "objectID": "test.html#回帰分析",
    "href": "test.html#回帰分析",
    "title": "プレゼミレポート",
    "section": "回帰分析",
    "text": "回帰分析\nデータの読み込み\n\nlibrary(tidyverse)\ndf &lt;- read_csv(\"https://so-ichi.com/adv_2023.csv\")"
  },
  {
    "objectID": "test.html#分析",
    "href": "test.html#分析",
    "title": "プレゼミレポート",
    "section": "分析",
    "text": "分析\n\nres &lt;- lm(売上高 ~ lag(研究開発費) + lag(広告宣伝費), data = df)\ncoef(res)\n\n    (Intercept) lag(研究開発費) lag(広告宣伝費) \n   1.004955e+05    1.716521e+01    6.913074e+00"
  },
  {
    "objectID": "test.html#結果の表",
    "href": "test.html#結果の表",
    "title": "プレゼミレポート",
    "section": "結果の表",
    "text": "結果の表\n\n#install.packages(\"modelsummary\")\nlibrary(modelsummary)\nmodelsummary(\n    res,\n    stars = TRUE,\n    fmt = '%.2f',\n    gof_omit = \"AIC|BIC|Log.Lik.\"\n    )\n\n\n\n\n (1)\n\n\n\n(Intercept)\n100495.49***\n\n\n\n(12569.41)\n\n\nlag(研究開発費)\n17.17***\n\n\n\n(0.26)\n\n\nlag(広告宣伝費)\n6.91***\n\n\n\n(0.52)\n\n\nNum.Obs.\n5174\n\n\nR2\n0.785\n\n\nR2 Adj.\n0.785\n\n\nRMSE\n861991.65\n\n\n\n\n + p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数",
    "href": "prezemi_2023_11_presen.html#ダミー変数",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "ダミー変数",
    "text": "ダミー変数\nダミー変数(dummy variable)とは，二値変数(binary variable)とか指示変数(indicator variable)とも呼ばれ，カテゴリーに属しているかどうかを表す1か0の値をとる変数のこと\n\\[\n\\begin{aligned}\nX = \\begin{cases}\n1 & \\text{if カテゴリーに属している}\\\\\n0 & \\text{if カテゴリーに属していない}\n\\end{cases}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数-1",
    "href": "prezemi_2023_11_presen.html#ダミー変数-1",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "ダミー変数",
    "text": "ダミー変数\n例えば、単回帰分析の説明変数がダミー変数\\(D\\)である場合を考えます。\n\\[\n\\begin{aligned}\nY = \\beta_0 + \\beta_1 D + \\varepsilon\n\\end{aligned}\n\\]\nこのとき、この単回帰モデルを次のように書くことが出来ます。\n\\[\n\\begin{aligned}\nY = \\begin{cases}\n\\beta_0 + \\varepsilon & \\text{if } D = 0 \\\\\n\\beta_0 + \\beta_1 + \\varepsilon & \\text{if } D = 1\n\\end{cases}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数の利用-1",
    "href": "prezemi_2023_11_presen.html#ダミー変数の利用-1",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "ダミー変数の利用",
    "text": "ダミー変数の利用\n\n会計研究では，コントロール変数として頻出の業種ダミーや年度ダミーに加えて，監査の質の代理変数となる四大監査法人ダミーや，会計基準選択で用いられるIFRSダミーといったものなど，非常に多くのダミー変数が用いられています。\n回帰分析にダミー変数を使う場合に気をつける点として， カテゴリの数が\\(k\\)個のカテゴリー変数は，\\(k-1\\)個のダミー変数を回帰分析に組み込むという点です。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#準備",
    "href": "prezemi_2023_11_presen.html#準備",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "準備",
    "text": "準備\n\nknitr::opts_chunk$set(dev = \"ragg_png\")\nlibrary(tidyverse) # とりあえずこれ\nlibrary(ggthemes) # ggplot2のテーマ\nlibrary(knitr) # 作表\nlibrary(kableExtra) # 作表の拡張\nlibrary(scales) # 軸の単位を制御\nlibrary(modelsummary) # モデルのまとめ\ntheme_set(theme_few(base_size = 12))\nupdate_geom_defaults(\"point\", list(size = 3))"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数と多重共線性",
    "href": "prezemi_2023_11_presen.html#ダミー変数と多重共線性",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "ダミー変数と多重共線性",
    "text": "ダミー変数と多重共線性\n研究開発費のデータを読み込みます。\n\ndf &lt;- read_csv(\"data/RD_2022.csv\")\nnames(df)\n\n [1] \"会社コード\"                     \"企業名\"                        \n [3] \"決算期\"                         \"決算種別\"                      \n [5] \"連結基準\"                       \"決算月数\"                      \n [7] \"上場コード\"                     \"日経業種コード\"                \n [9] \"現金預金\"                       \"資産合計\"                      \n[11] \"資本金\"                         \"資本剰余金\"                    \n[13] \"利益剰余金\"                     \"自己株式\"                      \n[15] \"売上高\"                         \"経常利益\"                      \n[17] \"法人税等\"                       \"法人税等調整額\"                \n[19] \"親会社株主に帰属する当期純利益\" \"研究開発費IFRS\"                \n[21] \"研究開発費\"                     \"開発費・試験研究費\"            \n[23] \"現金及び現金同等物の期末残高\"  \n\n\nこのデータフレームに含まれる日経業種コードは，6ケタの整数をもつデータで，最初の1ケタが製造業か非製造業，つぎの2ケタが日経産業中分類，つぎの3ケタが日経産業小分類を表します。 ここでは，最初の1ケタが1なら製造業，2なら非製造業を表す日経産業大分類を用いて，製造業ダミー変数と非製造業ダミー変数を作ります。\n\ndf &lt;- df |&gt;\n  mutate(\n    大分類 = factor(substr(df$日経業種コード,1,1), labels = c(\"製造業\",\"非製造業\"))\n  )\ntable(df$大分類) # 大分類の頻度\n\n\n  製造業 非製造業 \n   27551    30272 \n\n\nこの大分類を用いてダミー変数を作ります。\n\ndf &lt;- df %&gt;%\n  mutate(\n    製造業ダミー = ifelse(大分類 == 1, 1, 0),\n    非製造業ダミー = ifelse(大分類 == 2, 1, 0)\n  )\ntable(df$製造業ダミー, df$非製造業ダミー)\n\n   \n        0\n  0 57823\n\n\n上の表より，製造業ダミーと非製造業ダミーは完全に負の関係にあることが分かります。\n次に，研究開発費が翌期の売上高に与える影響を分析する回帰式に，製造業ダミーと非製造業ダミーの2つのダミー変数を組み込んでみます。\n\nres &lt;- lm(売上高 ~ lag(研究開発費) + 製造業ダミー + 非製造業ダミー, data = df)\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + 製造業ダミー + \n    非製造業ダミー, data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-21376507   -112942    -94789    -32170  13780749 \n\nCoefficients: (2 not defined because of singularities)\n                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     1.185e+05  3.219e+03   36.82   &lt;2e-16 ***\nlag(研究開発費) 1.929e+01  7.110e-02  271.33   &lt;2e-16 ***\n製造業ダミー           NA         NA      NA       NA    \n非製造業ダミー         NA         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 602500 on 36279 degrees of freedom\n  ( 21542 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.6699,    Adjusted R-squared:  0.6699 \nF-statistic: 7.362e+04 on 1 and 36279 DF,  p-value: &lt; 2.2e-16\n\n\n上の分析結果をみると，1 not defined because of singularitiesというメッセージがあり，非製造業ダミーがNAになっていることが分かります。 これは製造業ダミーと非製造業ダミーの相関が高すぎることにより，Rが自動で変数を落としているのです。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#変数変換",
    "href": "prezemi_2023_11_presen.html#変数変換",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "変数変換",
    "text": "変数変換\n回帰分析を実行するときに，変数をそのまま使うのでは無く，変数を変換して使う場合が多いです。 決算書の財務データは「百万円」か「千円」の単位で記録されているので，百万円でそろえる必要がありますし，外貨で保有する資産などは円換算する必要があります。\n売上高や利益額は同じ企業の過去の値と比較するのであれば問題ないですが，規模が異なる企業の売上高や利益を比較しても意味はないので，ROEや総資産回転率といった財務比率に直すことも多いです。\n線形変換\n確率変数\\(X\\)がアフィン変換(affine transformation)をする場合を考えます。\n\\[\n\\begin{aligned}\nY =  a + bX\n\\end{aligned}\n\\]\nによって確率変数\\(X\\)が確率変数\\(Y\\)に変換されたとします。 ここで\\(a\\)と\\(b\\)はパラメータです。 つまりアフィン変換とは確率変数を定数倍して定数を足す，という変換です。 このとき，次の関係が成立します。\nまず期待値については，\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= \\mathbb{E}[a + bX] \\nonumber \\\\\n       &= \\mathbb{E}[a] + \\mathbb{E}[bX] \\nonumber\\\\\n       &= a + b \\mathbb{E}[X]\n\\end{aligned}\n\\] となり，分散については， \\[\n\\begin{aligned}\n\\mathbb{V}[Y]\n        &= \\mathbb{E}[(Y - \\mathbb{E}[Y])^2]      \\nonumber \\\\\n        &= \\mathbb{E}[(a + bX - (a+b\\mathbb{E}[X]))^2] \\nonumber\\\\\n        &= \\mathbb{E}[(bX - b \\mathbb{E}[X])^2]   \\nonumber\\\\\n        &= \\mathbb{E}[b^2 (X - \\mathbb{E}[X])^2]  \\nonumber\\\\\n        &= b^2 \\mathbb{E}[ (X - \\mathbb{E}[X])^2] \\nonumber\\\\\n        &= b^2 \\mathbb{V}[X]\n\\end{aligned}\n\\]\nとなり，標準偏差については，\n\\[\n\\begin{aligned}\n\\sigma _Y = \\sqrt{\\mathbb{V}[Y]} = |b| \\sqrt{\\mathbb{V}[X]}\n\\end{aligned}\n\\]\nとなることが分かっています。\n\n\n\n\n\n\nアフィン変換\n\n\nある工事が完了する日数とその確率が次のように予測されているとします。\n\n\n\n日数\\(X\\)\n1\n2\n3\n4\n5\n\n\n\n\n確率\\(p(x)\\)\n\\(5\\%\\)\n\\(20\\%\\)\n\\(35\\%\\)\n\\(30\\%\\)\n\\(10\\%\\)\n\n\n\nこのとき\n\\[\n\\begin{aligned}\n\\mathbb{E}[X] &\\equiv \\sum _k p_k x_k \\text{より} & \\mathbb{E}[X] &= 3.2\\\\\n\\mathbb{V} [X] &\\equiv \\sum _k p_k (x_k - \\mathbb{E}[X])^2 \\text{より} & \\mathbb{V} [X] &= 1.06\n\\end{aligned}\n\\]\nこの工事では，固定費として100万円，変動費として1日あたり10万円の費用がかかるとすると，総費用は，\n\\[\n\\begin{aligned}\nY = 100  + 10 X\n\\end{aligned}\n\\]\nとして表される。 このとき，総費用の期待値および分散は，\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= 100 + 10 \\mathbb{E}[X] = 100 + 10 \\times 3.2 = 132\\\\\n\\mathbb{V}[Y] &= 10^2 \\mathbb{V}[X] = 100  \\times 1.06 = 106\n\\end{aligned}\n\\]\nとなる。\n\n\n\nより一般的に，\\(k\\)個の確率変数\\(X_i\\), \\(i = 1, \\dots ,k\\)の一次結合\\(Y = c_0 + c_1 X_1 + \\cdots + c_k X_k\\)で表される確率変数\\(Y\\)において，次の関係が成立する。 ここで，\\(c_0,c_1, \\dots, c_k\\)はパラメータで，定数です。\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= c_0 + c_1 \\mu _1 + \\cdots c_k \\mu_k\\\\\n\\mathbb{V} [Y] &= c_1^2 \\sigma_1^2 + \\cdots +  c_k^2 \\sigma _k^2 + \\sum _{i\\not = j}^k \\sum_{j \\not = i}^k c_i c_j \\sigma _{ij}\n\\end{aligned}\n\\]\nここで，\\(\\mu _i = \\mathbb{E}[X_i]\\)，\\(\\sigma _i^2 = \\mathbb{V}[X_i]\\)，\\(\\sigma _{ij} = \\mathbb{COV}[X_i,X_j]\\)である。\n例えば，\\(k=2\\)のケースでは，\n\\[\n\\begin{align}\n\\mathbb{E}[Y]   &= c_0 + c_1 \\mu _1 + c_2 \\mu_2\\\\\n\\mathbb{V} [Y] &= c_1^2 \\sigma_1^2 + c_2^2 \\sigma _2^2 + 2 c_1 c_2 \\sigma _{12}\n\\end{align}\n\\]\n\n\n\n\n\n\n問題3\n\n\n\\(k=3\\)のケースにおける確率変数\\(Y\\)の期待値と分散を求めなさい。\n\n\n\n\n\n\n\n\n\n例8\n\n\n\\(k=2\\)のケースで，\\(Y=0.5X_1 + 0.5 X_2\\)の期待値および分散を求めます。 ただし，\\(\\mu _1 = 0.07\\)，\\(\\sigma _1^2 = 1.48\\)，\\(\\mu_2 = -0.02\\)，\\(\\sigma _2^2 = 1.46\\)とします。\n\n無相関(\\(\\rho _{12} = 0\\), $[X_1,X_2] =0 $)のケース \\[\n\\begin{aligned}\n  \\mathbb{E}[Y]   &= 0.5 \\times 0.07 + 0.5 \\times - 0.02 = 0.025\\\\\n  \\mathbb{V} [Y] &= 0.5^2 \\times 1.48 + 0.5^2 \\times 1.46 + 2 \\times 0.5 \\times 0.5 \\times 0 = 0.735\n  \\end{aligned}\n\\]\n\\(Y\\)の分散は，\\(X_1\\)と\\(X_2\\)の分散よりも小さい。\n負の相関($_{12} = -0.99 [X_1,X_2] = -1.46 $)のケース \\[\n\\begin{aligned}\n  \\mathbb{E}[Y]   &= 0.5 \\times 0.07 + 0.5 \\times - 0.02 = 0.025\\\\\n  \\mathbb{V} [Y] &= 0.5^2 \\times 1.48 + 0.5^2 \\times 1.46 + 2 \\times 0.5 \\times 0.5 \\times -1.46 = 0.005\n  \\end{aligned}\n\\]\n\\(Y\\)の分散は，\\(X_1\\)と\\(X_2\\)の分散よりも小さい。\n\n\\(X_1\\)と\\(X_2\\)の共分散は，\\(Y\\)の分散に影響を与える。\n\n\n\n中心化\n変数変換の一つに中心化(centering)があります。 これは，説明変数からその平均値を引くことで，説明変数の平均値を0にする変換です。これは一次関数の平行移動に相当する線形変換の一種で，回帰式の切片の解釈を容易にするために使われます。\n平均値として標本平均を用いることが一般的ですが，理論的に考えられる平均値を使うこともあります。 たとえば，男女ダミーの平均は\\(0.5\\)，というような場合です。\nでは中心化をしてみます。 中心化するための自作関数を作成したり， mutate()関数で平均を引くことで中心化された変数を作成したりすることもできますが，ここでは中心化や標準化を行うscale()関数を使ってみます。\n先の回帰分析では，次のようなモデルを推定しました。\n\\[\n\\text{売上高} = \\alpha + \\beta_1 \\text{研究開発費} + \\beta_2 \\text{製造業ダミー} + \\varepsilon\n\\]\nこの回帰式を推定すると，次のようになります。\n\nres01 &lt;- lm(売上高 ~ lag(研究開発費) + 製造業ダミー , data = df)\nsummary(res01)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + 製造業ダミー, \n    data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-21499834   -118247    -57215    -10030  13666084 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)      2.332e+05  5.790e+03   40.28   &lt;2e-16 ***\nlag(研究開発費)  1.945e+01  7.086e-02  274.45   &lt;2e-16 ***\n製造業ダミー    -1.643e+05  6.918e+03  -23.75   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 597800 on 36278 degrees of freedom\n  ( 21542 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.6749,    Adjusted R-squared:  0.6749 \nF-statistic: 3.766e+04 on 2 and 36278 DF,  p-value: &lt; 2.2e-16\n\n\nこの回帰式の切片2.3318761^{5}の意味を考えてみましょう。 この切片は，研究開発費と製造業ダミーが0の場合の売上高の平均値を示しています。つまり非製造業企業で研究開発費がゼロの企業における平均売上高を表しています。\n研究開発費がゼロの企業というのはそれなりに存在しているので，教科書のように父親の身長がゼロのとき，といった非現実的な状況を表しているわけではないですが，非製造業企業だけの平均売上高だけでなく，全体の平均を表すために，変数を中心化(centering)します。\nここでは，標本平均を差し引くことで中心化します。\n\ndf &lt;- df %&gt;%\n  mutate(\n    研究開発費中心化 = scale(研究開発費, center = TRUE, scale = FALSE),\n    売上高中心化 = scale(売上高, center = TRUE, scale = FALSE)\n  )\nres02 &lt;- lm(売上高中心化 ~ lag(研究開発費中心化) + 製造業ダミー , data = df)\nres &lt;- list(res01,res02)\nlibrary(modelsummary)\nmodelsummary(res)\n\n\n\n\n\n (1)\n  (2)\n\n\n\n\n(Intercept)\n233187.611\n159890.665\n\n\n\n(5789.706)\n(5804.886)\n\n\nlag(研究開発費)\n19.447\n\n\n\n\n(0.071)\n\n\n\n製造業ダミー\n-164270.989\n-164270.989\n\n\n\n(6917.606)\n(6917.606)\n\n\nlag(研究開発費中心化)\n\n19.447\n\n\n\n\n(0.071)\n\n\nNum.Obs.\n36281\n36281\n\n\nR2\n0.675\n0.675\n\n\nR2 Adj.\n0.675\n0.675\n\n\nAIC\n1068119.6\n1068119.6\n\n\nBIC\n1068153.6\n1068153.6\n\n\nLog.Lik.\n-534055.790\n-534055.790\n\n\nRMSE\n597821.12\n597821.12\n\n\n\n\n\n\n\n先の中心化前の回帰分析結果と比べて違っているのは，切片(intercept)の値だけです。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#まとめ",
    "href": "prezemi_2023_11_presen.html#まとめ",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "まとめ",
    "text": "まとめ\n\\[\n\\begin{aligned}\n2\\times 2 = 2^2 = 4\\\\\n2\\times 2 \\times 2 = 2^3 = 8\\\\\n2\\times 2 \\times 2 \\times 2 = 2^4 = 16\\\\\n\\end{aligned}\n\\]\n\nlibrary(gapminder)\nlibrary(plotly)\n\ndata(gapminder)\ngg &lt;- ggplot(gapminder) +\n    aes(x = gdpPercap, y = lifeExp, color = continent) +\n    geom_point(aes(size = pop, frame = year, ids = country)) +\n    scale_x_log10()\nggplotly(gg)\n\n\n\n\n\n\nbase &lt;- gapminder %&gt;%\n    plot_ly(x = ~gdpPercap, y = ~lifeExp, size = ~pop, text = ~country, hoberinfo = \"text\") %&gt;%\n    layout(xaxis = list(type = \"log\"))\n\nbase %&gt;%\n    add_markers(color = ~continent, frame = ~year, ids = ~country) %&gt;%\n    animation_opts(frame = 1000, easing = \"elastic\", redraw = FALSE) %&gt;%\n    animation_button(\n        x = 1, xanchor = \"right\",\n        y = 0, yanchor = \"bottom\") %&gt;%\n    animation_slider(\n        currentvalue = list(prefix = \"YEAR: \", font = list(color = \"red\"))\n    )"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#製造業ダミーの例",
    "href": "prezemi_2023_11_presen.html#製造業ダミーの例",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "製造業ダミーの例",
    "text": "製造業ダミーの例\n\nすべての企業が製造業か非製造業のどちらかに属する\n製造業に属するかどうかを表すダミー変数\\(mani\\)と，非製造業に属するかどうかを表すダミー変数\\(nomani\\)を作成\n製造業であれば\\(mani = 1\\)，非製造業であれば\\(mani = 0\\)という製造業ダミー変数と，\n非製造であれば\\(nomani = 1\\)，製造業であれば\\(nomani = 0\\)をとる非製造業ダミー変数を作る。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#多重共線性",
    "href": "prezemi_2023_11_presen.html#多重共線性",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "多重共線性",
    "text": "多重共線性\n\nここで，製造業ダミーが\\(1\\)の値をとるとき，非製造業ダミーは必ず\\(0\\)をとり，逆に非製造業ダミーが\\(1\\)の値を取るとき，製造業ダミーはかならず\\(0\\)の値を取ります。つまりこの2つのダミー変数は相関係数が\\(-1\\)となり，同じ情報をもっている変数となります。\nこのような完全な負の関係にある2つの変数を回帰分析に組み込むと，多重共線性が発生する。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#rで確認してみる",
    "href": "prezemi_2023_11_presen.html#rで確認してみる",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "Rで確認してみる。",
    "text": "Rで確認してみる。\n研究開発費のデータを読み込みます。\n\nsetwd(\"/Users/soichi/Dropbox/R/presemi/\")\ndf &lt;- read_csv(\"data/RD_2022.csv\")\nnames(df)\n\n [1] \"会社コード\"                     \"企業名\"                        \n [3] \"決算期\"                         \"決算種別\"                      \n [5] \"連結基準\"                       \"決算月数\"                      \n [7] \"上場コード\"                     \"日経業種コード\"                \n [9] \"現金預金\"                       \"資産合計\"                      \n[11] \"資本金\"                         \"資本剰余金\"                    \n[13] \"利益剰余金\"                     \"自己株式\"                      \n[15] \"売上高\"                         \"経常利益\"                      \n[17] \"法人税等\"                       \"法人税等調整額\"                \n[19] \"親会社株主に帰属する当期純利益\" \"研究開発費IFRS\"                \n[21] \"研究開発費\"                     \"開発費・試験研究費\"            \n[23] \"現金及び現金同等物の期末残高\""
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数の作成",
    "href": "prezemi_2023_11_presen.html#ダミー変数の作成",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "ダミー変数の作成",
    "text": "ダミー変数の作成\n\nダミー変数を作成するときは，mutate()とifelse()を組み合わせると便利です。\n\ndf &lt;- df %&gt;%\n  mutate(\n    製造業ダミー = ifelse(大分類 == 1, 1, 0),\n    非製造業ダミー = ifelse(大分類 == 2, 1, 0)\n  )\ntable(df$製造業ダミー, df$非製造業ダミー)\n\n   \n        0     1\n  0     0 30272\n  1 27551     0\n\n\n上の表より，製造業ダミーと非製造業ダミーは完全に負の関係にあることが分かります。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#業種大分類",
    "href": "prezemi_2023_11_presen.html#業種大分類",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "業種大分類",
    "text": "業種大分類\n日経業種コードは6ケタの整数をもつデータで，1ケタ目が製造業か非製造業，つぎの2ケタが日経産業中分類，つぎの3ケタが日経産業小分類を表します。\n最初の1ケタが1なら製造業，2なら非製造業を表す製造業ダミー変数と非製造業ダミー変数を作る。\n\ndf &lt;- df |&gt;\n  mutate(\n    大分類 = substr(df$日経業種コード,1,1)\n  )\ntable(df$大分類) # 大分類の頻度\n\n\n    1     2 \n27551 30272"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数を説明変数とする回帰分析",
    "href": "prezemi_2023_11_presen.html#ダミー変数を説明変数とする回帰分析",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "ダミー変数を説明変数とする回帰分析",
    "text": "ダミー変数を説明変数とする回帰分析\n次に，研究開発費が翌期の売上高に与える影響を分析する回帰式に，製造業ダミーと非製造業ダミーの2つのダミー変数を組み込んでみます。\n\nres &lt;- lm(売上高 ~ lag(研究開発費) + 製造業ダミー + 非製造業ダミー, data = df)\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + 製造業ダミー + \n    非製造業ダミー, data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-21499834   -118247    -57215    -10030  13666084 \n\nCoefficients: (1 not defined because of singularities)\n                  Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)      2.332e+05  5.790e+03   40.28   &lt;2e-16 ***\nlag(研究開発費)  1.945e+01  7.086e-02  274.45   &lt;2e-16 ***\n製造業ダミー    -1.643e+05  6.918e+03  -23.75   &lt;2e-16 ***\n非製造業ダミー          NA         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 597800 on 36278 degrees of freedom\n  ( 21542 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.6749,    Adjusted R-squared:  0.6749 \nF-statistic: 3.766e+04 on 2 and 36278 DF,  p-value: &lt; 2.2e-16\n\n\n上の分析結果をみると，1 not defined because of singularitiesというメッセージがあり，非製造業ダミーがNAになっていることが分かります。 これは製造業ダミーと非製造業ダミーの相関が高すぎることにより，Rが自動で変数を落としているのです。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#webrの使用",
    "href": "prezemi_2023_11_presen.html#webrの使用",
    "title": "プレゼミ2023  第12回 回帰分析の応用",
    "section": "WebRの使用",
    "text": "WebRの使用\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#welcome",
    "href": "prezemi_2023_12_presen.html#welcome",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Welcome",
    "text": "Welcome\nWelcome to a demo RevealJS presentation that uses the quarto-webr extension to generate interactive code cells with Quarto and webR.\n\n\n\n\n\n\n重要\n\n\nThis template requires a pre-release version of Quarto that is 1.4.502 or greater that contains an updated copy of pandoc. For more details, please see Issue #14.\n\n\n\nNot the right template? Let’s go back to the documentation portal"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#webr-in-revealjs",
    "href": "prezemi_2023_12_presen.html#webr-in-revealjs",
    "title": "プレゼミ2023  WebRの実験",
    "section": "webR in RevealJS",
    "text": "webR in RevealJS\nThis is a webR-enabled code cell in a Quarto RevealJS document.\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#base-r-graphing-with-webr",
    "href": "prezemi_2023_12_presen.html#base-r-graphing-with-webr",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Base R Graphing with webR",
    "text": "Base R Graphing with webR\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#ggplot2-in-webr",
    "href": "prezemi_2023_12_presen.html#ggplot2-in-webr",
    "title": "プレゼミ2023  WebRの実験",
    "section": "ggplot2 in webR",
    "text": "ggplot2 in webR\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#help-documentation",
    "href": "prezemi_2023_12_presen.html#help-documentation",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Help Documentation",
    "text": "Help Documentation\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#prints-warnings-and-errors",
    "href": "prezemi_2023_12_presen.html#prints-warnings-and-errors",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Prints, Warnings, and Errors",
    "text": "Prints, Warnings, and Errors\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#keyboard-shortcuts",
    "href": "prezemi_2023_12_presen.html#keyboard-shortcuts",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Keyboard Shortcuts",
    "text": "Keyboard Shortcuts\n\nRun selected code using either:\n\nmacOS: ⌘ + ↩︎/Return\nWindows/Linux: Ctrl + ↩︎/Enter\n\nRun the entire code by clicking the “Run code” button or pressing Shift+↩︎.\n\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#embedded-slides",
    "href": "prezemi_2023_12_presen.html#embedded-slides",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Embedded Slides",
    "text": "Embedded Slides\nYou can embed the slide deck inside of a Quarto Website or Book by using:\n&lt;style&gt;\n.slide-deck {\n    border: 3px solid #dee2e6;\n    width: 100%;\n    height: 475px;\n}\n&lt;/style&gt;\n\n&lt;div&gt;\n```{=html}\n&lt;iframe class=\"slide-deck\" src=\"path/to/presentation/\"&gt;&lt;/iframe&gt;\n```\n&lt;/div&gt;\n\n\n\n\n\n\nノート\n\n\nAvoid using within a RevealJS presentation. Only 1 instance of webR should be running."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#fin",
    "href": "prezemi_2023_12_presen.html#fin",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Fin",
    "text": "Fin\nThanks for checking out the demo! Let’s head back to the documentation portal."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#ダミー変数の利用",
    "href": "prezemi_2023_12_presen.html#ダミー変数の利用",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の利用",
    "text": "ダミー変数の利用\nダミー変数(dummy variable)とは，二値変数(binary variable)とか指示変数(indicator variable)とも呼ばれ，カテゴリーに属しているかどうかを表す1か0の値をとる変数のことです。\n\\[\n\\begin{aligned}\nX = \\begin{cases}\n1 & \\text{if カテゴリーに属している}\\\\\n0 & \\text{if カテゴリーに属していない}\n\\end{cases}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#変数変換",
    "href": "prezemi_2023_12_presen.html#変数変換",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "変数変換",
    "text": "変数変換\n回帰分析を実行するときに，変数をそのまま使うのでは無く，変数を変換して使う場合が多いです。 決算書の財務データは「百万円」か「千円」の単位で記録されているので，百万円でそろえる必要がありますし，外貨で保有する資産などは円換算する必要があります。\n売上高や利益額は同じ企業の過去の値と比較するのであれば問題ないですが，規模が異なる企業の売上高や利益を比較しても意味はないので，ROEや総資産回転率といった財務比率に直すことも多いです。\n線形変換\n確率変数\\(X\\)がアフィン変換(affine transformation)をする場合を考えます。\n\\[\n\\begin{aligned}\nY =  a + bX\n\\end{aligned}\n\\]\nによって確率変数\\(X\\)が確率変数\\(Y\\)に変換されたとします。 ここで\\(a\\)と\\(b\\)はパラメータです。 つまりアフィン変換とは確率変数を定数倍して定数を足す，という変換です。 このとき，次の関係が成立します。\nまず期待値については，\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= \\mathbb{E}[a + bX] \\nonumber \\\\\n       &= \\mathbb{E}[a] + \\mathbb{E}[bX] \\nonumber\\\\\n       &= a + b \\mathbb{E}[X]\n\\end{aligned}\n\\] となり，分散については， \\[\n\\begin{aligned}\n\\mathbb{V}[Y]\n        &= \\mathbb{E}[(Y - \\mathbb{E}[Y])^2]      \\nonumber \\\\\n        &= \\mathbb{E}[(a + bX - (a+b\\mathbb{E}[X]))^2] \\nonumber\\\\\n        &= \\mathbb{E}[(bX - b \\mathbb{E}[X])^2]   \\nonumber\\\\\n        &= \\mathbb{E}[b^2 (X - \\mathbb{E}[X])^2]  \\nonumber\\\\\n        &= b^2 \\mathbb{E}[ (X - \\mathbb{E}[X])^2] \\nonumber\\\\\n        &= b^2 \\mathbb{V}[X]\n\\end{aligned}\n\\]\nとなり，標準偏差については，\n\\[\n\\begin{aligned}\n\\sigma _Y = \\sqrt{\\mathbb{V}[Y]} = |b| \\sqrt{\\mathbb{V}[X]}\n\\end{aligned}\n\\]\nとなることが分かっています。\n\n\n\n\n\n\nアフィン変換\n\n\nある工事が完了する日数とその確率が次のように予測されているとします。\n\n\n\n日数\\(X\\)\n1\n2\n3\n4\n5\n\n\n\n\n確率\\(p(x)\\)\n\\(5\\%\\)\n\\(20\\%\\)\n\\(35\\%\\)\n\\(30\\%\\)\n\\(10\\%\\)\n\n\n\nこのとき\n\\[\n\\begin{aligned}\n\\mathbb{E}[X] &\\equiv \\sum _k p_k x_k \\text{より} & \\mathbb{E}[X] &= 3.2\\\\\n\\mathbb{V} [X] &\\equiv \\sum _k p_k (x_k - \\mathbb{E}[X])^2 \\text{より} & \\mathbb{V} [X] &= 1.06\n\\end{aligned}\n\\]\nこの工事では，固定費として100万円，変動費として1日あたり10万円の費用がかかるとすると，総費用は，\n\\[\n\\begin{aligned}\nY = 100  + 10 X\n\\end{aligned}\n\\]\nとして表される。 このとき，総費用の期待値および分散は，\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= 100 + 10 \\mathbb{E}[X] = 100 + 10 \\times 3.2 = 132\\\\\n\\mathbb{V}[Y] &= 10^2 \\mathbb{V}[X] = 100  \\times 1.06 = 106\n\\end{aligned}\n\\]\nとなる。\n\n\n\nより一般的に，\\(k\\)個の確率変数\\(X_i\\), \\(i = 1, \\dots ,k\\)の一次結合\\(Y = c_0 + c_1 X_1 + \\cdots + c_k X_k\\)で表される確率変数\\(Y\\)において，次の関係が成立する。 ここで，\\(c_0,c_1, \\dots, c_k\\)はパラメータで，定数です。\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= c_0 + c_1 \\mu _1 + \\cdots c_k \\mu_k\\\\\n\\mathbb{V} [Y] &= c_1^2 \\sigma_1^2 + \\cdots +  c_k^2 \\sigma _k^2 + \\sum _{i\\not = j}^k \\sum_{j \\not = i}^k c_i c_j \\sigma _{ij}\n\\end{aligned}\n\\]\nここで，\\(\\mu _i = \\mathbb{E}[X_i]\\)，\\(\\sigma _i^2 = \\mathbb{V}[X_i]\\)，\\(\\sigma _{ij} = \\mathbb{COV}[X_i,X_j]\\)である。\n例えば，\\(k=2\\)のケースでは，\n\\[\n\\begin{align}\n\\mathbb{E}[Y]   &= c_0 + c_1 \\mu _1 + c_2 \\mu_2\\\\\n\\mathbb{V} [Y] &= c_1^2 \\sigma_1^2 + c_2^2 \\sigma _2^2 + 2 c_1 c_2 \\sigma _{12}\n\\end{align}\n\\]\n\n\n\n\n\n\n問題3\n\n\n\\(k=3\\)のケースにおける確率変数\\(Y\\)の期待値と分散を求めなさい。\n\n\n\n\n\n\n\n\n\n例8\n\n\n\\(k=2\\)のケースで，\\(Y=0.5X_1 + 0.5 X_2\\)の期待値および分散を求めます。 ただし，\\(\\mu _1 = 0.07\\)，\\(\\sigma _1^2 = 1.48\\)，\\(\\mu_2 = -0.02\\)，\\(\\sigma _2^2 = 1.46\\)とします。\n\n無相関(\\(\\rho _{12} = 0\\), $[X_1,X_2] =0 $)のケース \\[\n\\begin{aligned}\n  \\mathbb{E}[Y]   &= 0.5 \\times 0.07 + 0.5 \\times - 0.02 = 0.025\\\\\n  \\mathbb{V} [Y] &= 0.5^2 \\times 1.48 + 0.5^2 \\times 1.46 + 2 \\times 0.5 \\times 0.5 \\times 0 = 0.735\n  \\end{aligned}\n\\]\n\\(Y\\)の分散は，\\(X_1\\)と\\(X_2\\)の分散よりも小さい。\n負の相関($_{12} = -0.99 [X_1,X_2] = -1.46 $)のケース \\[\n\\begin{aligned}\n  \\mathbb{E}[Y]   &= 0.5 \\times 0.07 + 0.5 \\times - 0.02 = 0.025\\\\\n  \\mathbb{V} [Y] &= 0.5^2 \\times 1.48 + 0.5^2 \\times 1.46 + 2 \\times 0.5 \\times 0.5 \\times -1.46 = 0.005\n  \\end{aligned}\n\\]\n\\(Y\\)の分散は，\\(X_1\\)と\\(X_2\\)の分散よりも小さい。\n\n\\(X_1\\)と\\(X_2\\)の共分散は，\\(Y\\)の分散に影響を与える。\n\n\n\n中心化\n変数変換の一つに中心化(centering)があります。 これは，説明変数からその平均値を引くことで，説明変数の平均値を0にする変換です。これは一次関数の平行移動に相当する線形変換の一種で，回帰式の切片の解釈を容易にするために使われます。\n平均値として標本平均を用いることが一般的ですが，理論的に考えられる平均値を使うこともあります。 たとえば，男女ダミーの平均は\\(0.5\\)，というような場合です。\nでは中心化をしてみます。 中心化するための自作関数を作成したり， mutate()関数で平均を引くことで中心化された変数を作成したりすることもできますが，ここでは中心化や標準化を行うscale()関数を使ってみます。\n先の回帰分析では，次のようなモデルを推定しました。\n\\[\n\\text{売上高} = \\alpha + \\beta_1 \\text{研究開発費} + \\beta_2 \\text{製造業ダミー} + \\varepsilon\n\\]\nこの回帰式を推定すると，次のようになります。\n\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + 製造業ダミー, \n    data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-21499834   -118247    -57215    -10030  13666084 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)      2.332e+05  5.790e+03   40.28   &lt;2e-16 ***\nlag(研究開発費)  1.945e+01  7.086e-02  274.45   &lt;2e-16 ***\n製造業ダミー    -1.643e+05  6.918e+03  -23.75   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 597800 on 36278 degrees of freedom\n  ( 21542 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.6749,    Adjusted R-squared:  0.6749 \nF-statistic: 3.766e+04 on 2 and 36278 DF,  p-value: &lt; 2.2e-16\n\n\nこの回帰式の切片2.3318761^{5}の意味を考えてみましょう。 この切片は，研究開発費と製造業ダミーが0の場合の売上高の平均値を示しています。つまり非製造業企業で研究開発費がゼロの企業における平均売上高を表しています。\n研究開発費がゼロの企業というのはそれなりに存在しているので，教科書のように父親の身長がゼロのとき，といった非現実的な状況を表しているわけではないですが，非製造業企業だけの平均売上高だけでなく，全体の平均を表すために，変数を中心化(centering)します。\nここでは，標本平均を差し引くことで中心化します。\n\n\n\n\n\n\n (1)\n  (2)\n\n\n\n\n(Intercept)\n233187.611\n159890.665\n\n\n\n(5789.706)\n(5804.886)\n\n\nlag(研究開発費)\n19.447\n\n\n\n\n(0.071)\n\n\n\n製造業ダミー\n-164270.989\n-164270.989\n\n\n\n(6917.606)\n(6917.606)\n\n\nlag(研究開発費中心化)\n\n19.447\n\n\n\n\n(0.071)\n\n\nNum.Obs.\n36281\n36281\n\n\nR2\n0.675\n0.675\n\n\nR2 Adj.\n0.675\n0.675\n\n\nAIC\n1068119.6\n1068119.6\n\n\nBIC\n1068153.6\n1068153.6\n\n\nLog.Lik.\n-534055.790\n-534055.790\n\n\nRMSE\n597821.12\n597821.12\n\n\n\n\n\n\n\n先の中心化前の回帰分析結果と比べて違っているのは，切片(intercept)の値だけです。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#まとめ",
    "href": "prezemi_2023_12_presen.html#まとめ",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "まとめ",
    "text": "まとめ\n\\[\n\\begin{aligned}\n2\\times 2 = 2^2 = 4\\\\\n2\\times 2 \\times 2 = 2^3 = 8\\\\\n2\\times 2 \\times 2 \\times 2 = 2^4 = 16\\\\\n\\end{aligned}\n\\]\n\nlibrary(gapminder)\nlibrary(plotly)\n\ndata(gapminder)\ngg &lt;- ggplot(gapminder) +\n    aes(x = gdpPercap, y = lifeExp, color = continent) +\n    geom_point(aes(size = pop, frame = year, ids = country)) +\n    scale_x_log10()\nggplotly(gg)\n\n\n\n\n\n\nbase &lt;- gapminder %&gt;%\n    plot_ly(x = ~gdpPercap, y = ~lifeExp, size = ~pop, text = ~country, hoberinfo = \"text\") %&gt;%\n    layout(xaxis = list(type = \"log\"))\n\nbase %&gt;%\n    add_markers(color = ~continent, frame = ~year, ids = ~country) %&gt;%\n    animation_opts(frame = 1000, easing = \"elastic\", redraw = FALSE) %&gt;%\n    animation_button(\n        x = 1, xanchor = \"right\",\n        y = 0, yanchor = \"bottom\") %&gt;%\n    animation_slider(\n        currentvalue = list(prefix = \"YEAR: \", font = list(color = \"red\"))\n    )\n\n\n\n\n\n新品：本体価格5万円、年1回インク交換で9000円、5年で45000円の合計95000円 中古：本体価格0円、月2000円、5年で12万円(月1300枚程度のモノクロ印刷代込み・メンテ込み)\nを比較してました。毎月コンスタントに数百枚印刷する、ということなら後者の方が安いかもしれませんが、ある月だけ大量印刷するけど、あとは月100枚程度、ということでしたら、新品購入のほうが安いと思います。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#回帰分析とは",
    "href": "prezemi_2023_12_presen.html#回帰分析とは",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析とは",
    "text": "回帰分析とは\n\n1つ以上の説明変数と1つの応答変数との間の因果関係を調べるための統計的手法\nここでは、説明変数\\(X\\)と応答変数\\(Y\\)との間に線形関係を仮定する線形回帰モデルを考える。\n\n\\[\nY = \\alpha + \\sum _{i=1}^k \\beta _i X_i + \\varepsilon\n\\]\n\n回帰パラメータ\\(\\alpha\\)と\\(\\beta\\)を推定する方法として最小二乗法を用いる。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#最小二乗法",
    "href": "prezemi_2023_12_presen.html#最小二乗法",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "最小二乗法",
    "text": "最小二乗法\n\n今手元に説明変数\\(X\\)と応答変数\\(Y\\)のデータの組\\((x_i,y_i)\\)があるとする。\nこのデータから回帰パラメータを推定する最小二乗法は、残差平方和を最小にするような回帰パラメータを求める方法である。\n\n\\[\n\\begin{aligned}\n\\min _{\\hat{\\alpha}, \\hat{\\beta}} \\sum _{i=1}^n (y_i - \\alpha - \\sum _{j=1}^k \\beta _j x_{ij})^2\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#回帰分析の実装",
    "href": "prezemi_2023_12_presen.html#回帰分析の実装",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析の実装",
    "text": "回帰分析の実装\nRではlm()関数を使って最小二乗法による回帰分析を行う。 lm()の主要な引数は，formulaとdataの2つ\n\nformula ： 回帰式を表す式で，Y ~ Xのように書く。\ndata ： 回帰分析に用いるデータフレーム\n\n\nres &lt;- lm(Y ~ X, data = df)"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#回帰分析の練習",
    "href": "prezemi_2023_12_presen.html#回帰分析の練習",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析の練習",
    "text": "回帰分析の練習\nボストン住宅価格データを使って回帰分析を実行\n\nlibrary(MASS) # データを取得\ndf &lt;- Boston\ndf\n\n        crim    zn indus chas    nox    rm   age     dis rad tax ptratio  black\n1    0.00632  18.0  2.31    0 0.5380 6.575  65.2  4.0900   1 296    15.3 396.90\n2    0.02731   0.0  7.07    0 0.4690 6.421  78.9  4.9671   2 242    17.8 396.90\n3    0.02729   0.0  7.07    0 0.4690 7.185  61.1  4.9671   2 242    17.8 392.83\n4    0.03237   0.0  2.18    0 0.4580 6.998  45.8  6.0622   3 222    18.7 394.63\n5    0.06905   0.0  2.18    0 0.4580 7.147  54.2  6.0622   3 222    18.7 396.90\n6    0.02985   0.0  2.18    0 0.4580 6.430  58.7  6.0622   3 222    18.7 394.12\n7    0.08829  12.5  7.87    0 0.5240 6.012  66.6  5.5605   5 311    15.2 395.60\n8    0.14455  12.5  7.87    0 0.5240 6.172  96.1  5.9505   5 311    15.2 396.90\n9    0.21124  12.5  7.87    0 0.5240 5.631 100.0  6.0821   5 311    15.2 386.63\n10   0.17004  12.5  7.87    0 0.5240 6.004  85.9  6.5921   5 311    15.2 386.71\n11   0.22489  12.5  7.87    0 0.5240 6.377  94.3  6.3467   5 311    15.2 392.52\n12   0.11747  12.5  7.87    0 0.5240 6.009  82.9  6.2267   5 311    15.2 396.90\n13   0.09378  12.5  7.87    0 0.5240 5.889  39.0  5.4509   5 311    15.2 390.50\n14   0.62976   0.0  8.14    0 0.5380 5.949  61.8  4.7075   4 307    21.0 396.90\n15   0.63796   0.0  8.14    0 0.5380 6.096  84.5  4.4619   4 307    21.0 380.02\n16   0.62739   0.0  8.14    0 0.5380 5.834  56.5  4.4986   4 307    21.0 395.62\n17   1.05393   0.0  8.14    0 0.5380 5.935  29.3  4.4986   4 307    21.0 386.85\n18   0.78420   0.0  8.14    0 0.5380 5.990  81.7  4.2579   4 307    21.0 386.75\n19   0.80271   0.0  8.14    0 0.5380 5.456  36.6  3.7965   4 307    21.0 288.99\n20   0.72580   0.0  8.14    0 0.5380 5.727  69.5  3.7965   4 307    21.0 390.95\n21   1.25179   0.0  8.14    0 0.5380 5.570  98.1  3.7979   4 307    21.0 376.57\n22   0.85204   0.0  8.14    0 0.5380 5.965  89.2  4.0123   4 307    21.0 392.53\n23   1.23247   0.0  8.14    0 0.5380 6.142  91.7  3.9769   4 307    21.0 396.90\n24   0.98843   0.0  8.14    0 0.5380 5.813 100.0  4.0952   4 307    21.0 394.54\n25   0.75026   0.0  8.14    0 0.5380 5.924  94.1  4.3996   4 307    21.0 394.33\n26   0.84054   0.0  8.14    0 0.5380 5.599  85.7  4.4546   4 307    21.0 303.42\n27   0.67191   0.0  8.14    0 0.5380 5.813  90.3  4.6820   4 307    21.0 376.88\n28   0.95577   0.0  8.14    0 0.5380 6.047  88.8  4.4534   4 307    21.0 306.38\n29   0.77299   0.0  8.14    0 0.5380 6.495  94.4  4.4547   4 307    21.0 387.94\n30   1.00245   0.0  8.14    0 0.5380 6.674  87.3  4.2390   4 307    21.0 380.23\n31   1.13081   0.0  8.14    0 0.5380 5.713  94.1  4.2330   4 307    21.0 360.17\n32   1.35472   0.0  8.14    0 0.5380 6.072 100.0  4.1750   4 307    21.0 376.73\n33   1.38799   0.0  8.14    0 0.5380 5.950  82.0  3.9900   4 307    21.0 232.60\n34   1.15172   0.0  8.14    0 0.5380 5.701  95.0  3.7872   4 307    21.0 358.77\n35   1.61282   0.0  8.14    0 0.5380 6.096  96.9  3.7598   4 307    21.0 248.31\n36   0.06417   0.0  5.96    0 0.4990 5.933  68.2  3.3603   5 279    19.2 396.90\n37   0.09744   0.0  5.96    0 0.4990 5.841  61.4  3.3779   5 279    19.2 377.56\n38   0.08014   0.0  5.96    0 0.4990 5.850  41.5  3.9342   5 279    19.2 396.90\n39   0.17505   0.0  5.96    0 0.4990 5.966  30.2  3.8473   5 279    19.2 393.43\n40   0.02763  75.0  2.95    0 0.4280 6.595  21.8  5.4011   3 252    18.3 395.63\n41   0.03359  75.0  2.95    0 0.4280 7.024  15.8  5.4011   3 252    18.3 395.62\n42   0.12744   0.0  6.91    0 0.4480 6.770   2.9  5.7209   3 233    17.9 385.41\n43   0.14150   0.0  6.91    0 0.4480 6.169   6.6  5.7209   3 233    17.9 383.37\n44   0.15936   0.0  6.91    0 0.4480 6.211   6.5  5.7209   3 233    17.9 394.46\n45   0.12269   0.0  6.91    0 0.4480 6.069  40.0  5.7209   3 233    17.9 389.39\n46   0.17142   0.0  6.91    0 0.4480 5.682  33.8  5.1004   3 233    17.9 396.90\n47   0.18836   0.0  6.91    0 0.4480 5.786  33.3  5.1004   3 233    17.9 396.90\n48   0.22927   0.0  6.91    0 0.4480 6.030  85.5  5.6894   3 233    17.9 392.74\n49   0.25387   0.0  6.91    0 0.4480 5.399  95.3  5.8700   3 233    17.9 396.90\n50   0.21977   0.0  6.91    0 0.4480 5.602  62.0  6.0877   3 233    17.9 396.90\n51   0.08873  21.0  5.64    0 0.4390 5.963  45.7  6.8147   4 243    16.8 395.56\n52   0.04337  21.0  5.64    0 0.4390 6.115  63.0  6.8147   4 243    16.8 393.97\n53   0.05360  21.0  5.64    0 0.4390 6.511  21.1  6.8147   4 243    16.8 396.90\n54   0.04981  21.0  5.64    0 0.4390 5.998  21.4  6.8147   4 243    16.8 396.90\n55   0.01360  75.0  4.00    0 0.4100 5.888  47.6  7.3197   3 469    21.1 396.90\n56   0.01311  90.0  1.22    0 0.4030 7.249  21.9  8.6966   5 226    17.9 395.93\n57   0.02055  85.0  0.74    0 0.4100 6.383  35.7  9.1876   2 313    17.3 396.90\n58   0.01432 100.0  1.32    0 0.4110 6.816  40.5  8.3248   5 256    15.1 392.90\n59   0.15445  25.0  5.13    0 0.4530 6.145  29.2  7.8148   8 284    19.7 390.68\n60   0.10328  25.0  5.13    0 0.4530 5.927  47.2  6.9320   8 284    19.7 396.90\n61   0.14932  25.0  5.13    0 0.4530 5.741  66.2  7.2254   8 284    19.7 395.11\n62   0.17171  25.0  5.13    0 0.4530 5.966  93.4  6.8185   8 284    19.7 378.08\n63   0.11027  25.0  5.13    0 0.4530 6.456  67.8  7.2255   8 284    19.7 396.90\n64   0.12650  25.0  5.13    0 0.4530 6.762  43.4  7.9809   8 284    19.7 395.58\n65   0.01951  17.5  1.38    0 0.4161 7.104  59.5  9.2229   3 216    18.6 393.24\n66   0.03584  80.0  3.37    0 0.3980 6.290  17.8  6.6115   4 337    16.1 396.90\n67   0.04379  80.0  3.37    0 0.3980 5.787  31.1  6.6115   4 337    16.1 396.90\n68   0.05789  12.5  6.07    0 0.4090 5.878  21.4  6.4980   4 345    18.9 396.21\n69   0.13554  12.5  6.07    0 0.4090 5.594  36.8  6.4980   4 345    18.9 396.90\n70   0.12816  12.5  6.07    0 0.4090 5.885  33.0  6.4980   4 345    18.9 396.90\n71   0.08826   0.0 10.81    0 0.4130 6.417   6.6  5.2873   4 305    19.2 383.73\n72   0.15876   0.0 10.81    0 0.4130 5.961  17.5  5.2873   4 305    19.2 376.94\n73   0.09164   0.0 10.81    0 0.4130 6.065   7.8  5.2873   4 305    19.2 390.91\n74   0.19539   0.0 10.81    0 0.4130 6.245   6.2  5.2873   4 305    19.2 377.17\n75   0.07896   0.0 12.83    0 0.4370 6.273   6.0  4.2515   5 398    18.7 394.92\n76   0.09512   0.0 12.83    0 0.4370 6.286  45.0  4.5026   5 398    18.7 383.23\n77   0.10153   0.0 12.83    0 0.4370 6.279  74.5  4.0522   5 398    18.7 373.66\n78   0.08707   0.0 12.83    0 0.4370 6.140  45.8  4.0905   5 398    18.7 386.96\n79   0.05646   0.0 12.83    0 0.4370 6.232  53.7  5.0141   5 398    18.7 386.40\n80   0.08387   0.0 12.83    0 0.4370 5.874  36.6  4.5026   5 398    18.7 396.06\n81   0.04113  25.0  4.86    0 0.4260 6.727  33.5  5.4007   4 281    19.0 396.90\n82   0.04462  25.0  4.86    0 0.4260 6.619  70.4  5.4007   4 281    19.0 395.63\n83   0.03659  25.0  4.86    0 0.4260 6.302  32.2  5.4007   4 281    19.0 396.90\n84   0.03551  25.0  4.86    0 0.4260 6.167  46.7  5.4007   4 281    19.0 390.64\n85   0.05059   0.0  4.49    0 0.4490 6.389  48.0  4.7794   3 247    18.5 396.90\n86   0.05735   0.0  4.49    0 0.4490 6.630  56.1  4.4377   3 247    18.5 392.30\n87   0.05188   0.0  4.49    0 0.4490 6.015  45.1  4.4272   3 247    18.5 395.99\n88   0.07151   0.0  4.49    0 0.4490 6.121  56.8  3.7476   3 247    18.5 395.15\n89   0.05660   0.0  3.41    0 0.4890 7.007  86.3  3.4217   2 270    17.8 396.90\n90   0.05302   0.0  3.41    0 0.4890 7.079  63.1  3.4145   2 270    17.8 396.06\n91   0.04684   0.0  3.41    0 0.4890 6.417  66.1  3.0923   2 270    17.8 392.18\n92   0.03932   0.0  3.41    0 0.4890 6.405  73.9  3.0921   2 270    17.8 393.55\n93   0.04203  28.0 15.04    0 0.4640 6.442  53.6  3.6659   4 270    18.2 395.01\n94   0.02875  28.0 15.04    0 0.4640 6.211  28.9  3.6659   4 270    18.2 396.33\n95   0.04294  28.0 15.04    0 0.4640 6.249  77.3  3.6150   4 270    18.2 396.90\n96   0.12204   0.0  2.89    0 0.4450 6.625  57.8  3.4952   2 276    18.0 357.98\n97   0.11504   0.0  2.89    0 0.4450 6.163  69.6  3.4952   2 276    18.0 391.83\n98   0.12083   0.0  2.89    0 0.4450 8.069  76.0  3.4952   2 276    18.0 396.90\n99   0.08187   0.0  2.89    0 0.4450 7.820  36.9  3.4952   2 276    18.0 393.53\n100  0.06860   0.0  2.89    0 0.4450 7.416  62.5  3.4952   2 276    18.0 396.90\n101  0.14866   0.0  8.56    0 0.5200 6.727  79.9  2.7778   5 384    20.9 394.76\n102  0.11432   0.0  8.56    0 0.5200 6.781  71.3  2.8561   5 384    20.9 395.58\n103  0.22876   0.0  8.56    0 0.5200 6.405  85.4  2.7147   5 384    20.9  70.80\n104  0.21161   0.0  8.56    0 0.5200 6.137  87.4  2.7147   5 384    20.9 394.47\n105  0.13960   0.0  8.56    0 0.5200 6.167  90.0  2.4210   5 384    20.9 392.69\n106  0.13262   0.0  8.56    0 0.5200 5.851  96.7  2.1069   5 384    20.9 394.05\n107  0.17120   0.0  8.56    0 0.5200 5.836  91.9  2.2110   5 384    20.9 395.67\n108  0.13117   0.0  8.56    0 0.5200 6.127  85.2  2.1224   5 384    20.9 387.69\n109  0.12802   0.0  8.56    0 0.5200 6.474  97.1  2.4329   5 384    20.9 395.24\n110  0.26363   0.0  8.56    0 0.5200 6.229  91.2  2.5451   5 384    20.9 391.23\n111  0.10793   0.0  8.56    0 0.5200 6.195  54.4  2.7778   5 384    20.9 393.49\n112  0.10084   0.0 10.01    0 0.5470 6.715  81.6  2.6775   6 432    17.8 395.59\n113  0.12329   0.0 10.01    0 0.5470 5.913  92.9  2.3534   6 432    17.8 394.95\n114  0.22212   0.0 10.01    0 0.5470 6.092  95.4  2.5480   6 432    17.8 396.90\n115  0.14231   0.0 10.01    0 0.5470 6.254  84.2  2.2565   6 432    17.8 388.74\n116  0.17134   0.0 10.01    0 0.5470 5.928  88.2  2.4631   6 432    17.8 344.91\n117  0.13158   0.0 10.01    0 0.5470 6.176  72.5  2.7301   6 432    17.8 393.30\n118  0.15098   0.0 10.01    0 0.5470 6.021  82.6  2.7474   6 432    17.8 394.51\n119  0.13058   0.0 10.01    0 0.5470 5.872  73.1  2.4775   6 432    17.8 338.63\n120  0.14476   0.0 10.01    0 0.5470 5.731  65.2  2.7592   6 432    17.8 391.50\n121  0.06899   0.0 25.65    0 0.5810 5.870  69.7  2.2577   2 188    19.1 389.15\n122  0.07165   0.0 25.65    0 0.5810 6.004  84.1  2.1974   2 188    19.1 377.67\n123  0.09299   0.0 25.65    0 0.5810 5.961  92.9  2.0869   2 188    19.1 378.09\n124  0.15038   0.0 25.65    0 0.5810 5.856  97.0  1.9444   2 188    19.1 370.31\n125  0.09849   0.0 25.65    0 0.5810 5.879  95.8  2.0063   2 188    19.1 379.38\n126  0.16902   0.0 25.65    0 0.5810 5.986  88.4  1.9929   2 188    19.1 385.02\n127  0.38735   0.0 25.65    0 0.5810 5.613  95.6  1.7572   2 188    19.1 359.29\n128  0.25915   0.0 21.89    0 0.6240 5.693  96.0  1.7883   4 437    21.2 392.11\n129  0.32543   0.0 21.89    0 0.6240 6.431  98.8  1.8125   4 437    21.2 396.90\n130  0.88125   0.0 21.89    0 0.6240 5.637  94.7  1.9799   4 437    21.2 396.90\n131  0.34006   0.0 21.89    0 0.6240 6.458  98.9  2.1185   4 437    21.2 395.04\n132  1.19294   0.0 21.89    0 0.6240 6.326  97.7  2.2710   4 437    21.2 396.90\n133  0.59005   0.0 21.89    0 0.6240 6.372  97.9  2.3274   4 437    21.2 385.76\n134  0.32982   0.0 21.89    0 0.6240 5.822  95.4  2.4699   4 437    21.2 388.69\n135  0.97617   0.0 21.89    0 0.6240 5.757  98.4  2.3460   4 437    21.2 262.76\n136  0.55778   0.0 21.89    0 0.6240 6.335  98.2  2.1107   4 437    21.2 394.67\n137  0.32264   0.0 21.89    0 0.6240 5.942  93.5  1.9669   4 437    21.2 378.25\n138  0.35233   0.0 21.89    0 0.6240 6.454  98.4  1.8498   4 437    21.2 394.08\n139  0.24980   0.0 21.89    0 0.6240 5.857  98.2  1.6686   4 437    21.2 392.04\n140  0.54452   0.0 21.89    0 0.6240 6.151  97.9  1.6687   4 437    21.2 396.90\n141  0.29090   0.0 21.89    0 0.6240 6.174  93.6  1.6119   4 437    21.2 388.08\n142  1.62864   0.0 21.89    0 0.6240 5.019 100.0  1.4394   4 437    21.2 396.90\n143  3.32105   0.0 19.58    1 0.8710 5.403 100.0  1.3216   5 403    14.7 396.90\n144  4.09740   0.0 19.58    0 0.8710 5.468 100.0  1.4118   5 403    14.7 396.90\n145  2.77974   0.0 19.58    0 0.8710 4.903  97.8  1.3459   5 403    14.7 396.90\n146  2.37934   0.0 19.58    0 0.8710 6.130 100.0  1.4191   5 403    14.7 172.91\n147  2.15505   0.0 19.58    0 0.8710 5.628 100.0  1.5166   5 403    14.7 169.27\n148  2.36862   0.0 19.58    0 0.8710 4.926  95.7  1.4608   5 403    14.7 391.71\n149  2.33099   0.0 19.58    0 0.8710 5.186  93.8  1.5296   5 403    14.7 356.99\n150  2.73397   0.0 19.58    0 0.8710 5.597  94.9  1.5257   5 403    14.7 351.85\n151  1.65660   0.0 19.58    0 0.8710 6.122  97.3  1.6180   5 403    14.7 372.80\n152  1.49632   0.0 19.58    0 0.8710 5.404 100.0  1.5916   5 403    14.7 341.60\n153  1.12658   0.0 19.58    1 0.8710 5.012  88.0  1.6102   5 403    14.7 343.28\n154  2.14918   0.0 19.58    0 0.8710 5.709  98.5  1.6232   5 403    14.7 261.95\n155  1.41385   0.0 19.58    1 0.8710 6.129  96.0  1.7494   5 403    14.7 321.02\n156  3.53501   0.0 19.58    1 0.8710 6.152  82.6  1.7455   5 403    14.7  88.01\n157  2.44668   0.0 19.58    0 0.8710 5.272  94.0  1.7364   5 403    14.7  88.63\n158  1.22358   0.0 19.58    0 0.6050 6.943  97.4  1.8773   5 403    14.7 363.43\n159  1.34284   0.0 19.58    0 0.6050 6.066 100.0  1.7573   5 403    14.7 353.89\n160  1.42502   0.0 19.58    0 0.8710 6.510 100.0  1.7659   5 403    14.7 364.31\n161  1.27346   0.0 19.58    1 0.6050 6.250  92.6  1.7984   5 403    14.7 338.92\n162  1.46336   0.0 19.58    0 0.6050 7.489  90.8  1.9709   5 403    14.7 374.43\n163  1.83377   0.0 19.58    1 0.6050 7.802  98.2  2.0407   5 403    14.7 389.61\n164  1.51902   0.0 19.58    1 0.6050 8.375  93.9  2.1620   5 403    14.7 388.45\n165  2.24236   0.0 19.58    0 0.6050 5.854  91.8  2.4220   5 403    14.7 395.11\n166  2.92400   0.0 19.58    0 0.6050 6.101  93.0  2.2834   5 403    14.7 240.16\n167  2.01019   0.0 19.58    0 0.6050 7.929  96.2  2.0459   5 403    14.7 369.30\n168  1.80028   0.0 19.58    0 0.6050 5.877  79.2  2.4259   5 403    14.7 227.61\n169  2.30040   0.0 19.58    0 0.6050 6.319  96.1  2.1000   5 403    14.7 297.09\n170  2.44953   0.0 19.58    0 0.6050 6.402  95.2  2.2625   5 403    14.7 330.04\n171  1.20742   0.0 19.58    0 0.6050 5.875  94.6  2.4259   5 403    14.7 292.29\n172  2.31390   0.0 19.58    0 0.6050 5.880  97.3  2.3887   5 403    14.7 348.13\n173  0.13914   0.0  4.05    0 0.5100 5.572  88.5  2.5961   5 296    16.6 396.90\n174  0.09178   0.0  4.05    0 0.5100 6.416  84.1  2.6463   5 296    16.6 395.50\n175  0.08447   0.0  4.05    0 0.5100 5.859  68.7  2.7019   5 296    16.6 393.23\n176  0.06664   0.0  4.05    0 0.5100 6.546  33.1  3.1323   5 296    16.6 390.96\n177  0.07022   0.0  4.05    0 0.5100 6.020  47.2  3.5549   5 296    16.6 393.23\n178  0.05425   0.0  4.05    0 0.5100 6.315  73.4  3.3175   5 296    16.6 395.60\n179  0.06642   0.0  4.05    0 0.5100 6.860  74.4  2.9153   5 296    16.6 391.27\n180  0.05780   0.0  2.46    0 0.4880 6.980  58.4  2.8290   3 193    17.8 396.90\n181  0.06588   0.0  2.46    0 0.4880 7.765  83.3  2.7410   3 193    17.8 395.56\n182  0.06888   0.0  2.46    0 0.4880 6.144  62.2  2.5979   3 193    17.8 396.90\n183  0.09103   0.0  2.46    0 0.4880 7.155  92.2  2.7006   3 193    17.8 394.12\n184  0.10008   0.0  2.46    0 0.4880 6.563  95.6  2.8470   3 193    17.8 396.90\n185  0.08308   0.0  2.46    0 0.4880 5.604  89.8  2.9879   3 193    17.8 391.00\n186  0.06047   0.0  2.46    0 0.4880 6.153  68.8  3.2797   3 193    17.8 387.11\n187  0.05602   0.0  2.46    0 0.4880 7.831  53.6  3.1992   3 193    17.8 392.63\n188  0.07875  45.0  3.44    0 0.4370 6.782  41.1  3.7886   5 398    15.2 393.87\n189  0.12579  45.0  3.44    0 0.4370 6.556  29.1  4.5667   5 398    15.2 382.84\n190  0.08370  45.0  3.44    0 0.4370 7.185  38.9  4.5667   5 398    15.2 396.90\n191  0.09068  45.0  3.44    0 0.4370 6.951  21.5  6.4798   5 398    15.2 377.68\n192  0.06911  45.0  3.44    0 0.4370 6.739  30.8  6.4798   5 398    15.2 389.71\n193  0.08664  45.0  3.44    0 0.4370 7.178  26.3  6.4798   5 398    15.2 390.49\n194  0.02187  60.0  2.93    0 0.4010 6.800   9.9  6.2196   1 265    15.6 393.37\n195  0.01439  60.0  2.93    0 0.4010 6.604  18.8  6.2196   1 265    15.6 376.70\n196  0.01381  80.0  0.46    0 0.4220 7.875  32.0  5.6484   4 255    14.4 394.23\n197  0.04011  80.0  1.52    0 0.4040 7.287  34.1  7.3090   2 329    12.6 396.90\n198  0.04666  80.0  1.52    0 0.4040 7.107  36.6  7.3090   2 329    12.6 354.31\n199  0.03768  80.0  1.52    0 0.4040 7.274  38.3  7.3090   2 329    12.6 392.20\n200  0.03150  95.0  1.47    0 0.4030 6.975  15.3  7.6534   3 402    17.0 396.90\n201  0.01778  95.0  1.47    0 0.4030 7.135  13.9  7.6534   3 402    17.0 384.30\n202  0.03445  82.5  2.03    0 0.4150 6.162  38.4  6.2700   2 348    14.7 393.77\n203  0.02177  82.5  2.03    0 0.4150 7.610  15.7  6.2700   2 348    14.7 395.38\n204  0.03510  95.0  2.68    0 0.4161 7.853  33.2  5.1180   4 224    14.7 392.78\n205  0.02009  95.0  2.68    0 0.4161 8.034  31.9  5.1180   4 224    14.7 390.55\n206  0.13642   0.0 10.59    0 0.4890 5.891  22.3  3.9454   4 277    18.6 396.90\n207  0.22969   0.0 10.59    0 0.4890 6.326  52.5  4.3549   4 277    18.6 394.87\n208  0.25199   0.0 10.59    0 0.4890 5.783  72.7  4.3549   4 277    18.6 389.43\n209  0.13587   0.0 10.59    1 0.4890 6.064  59.1  4.2392   4 277    18.6 381.32\n210  0.43571   0.0 10.59    1 0.4890 5.344 100.0  3.8750   4 277    18.6 396.90\n211  0.17446   0.0 10.59    1 0.4890 5.960  92.1  3.8771   4 277    18.6 393.25\n212  0.37578   0.0 10.59    1 0.4890 5.404  88.6  3.6650   4 277    18.6 395.24\n213  0.21719   0.0 10.59    1 0.4890 5.807  53.8  3.6526   4 277    18.6 390.94\n214  0.14052   0.0 10.59    0 0.4890 6.375  32.3  3.9454   4 277    18.6 385.81\n215  0.28955   0.0 10.59    0 0.4890 5.412   9.8  3.5875   4 277    18.6 348.93\n216  0.19802   0.0 10.59    0 0.4890 6.182  42.4  3.9454   4 277    18.6 393.63\n217  0.04560   0.0 13.89    1 0.5500 5.888  56.0  3.1121   5 276    16.4 392.80\n218  0.07013   0.0 13.89    0 0.5500 6.642  85.1  3.4211   5 276    16.4 392.78\n219  0.11069   0.0 13.89    1 0.5500 5.951  93.8  2.8893   5 276    16.4 396.90\n220  0.11425   0.0 13.89    1 0.5500 6.373  92.4  3.3633   5 276    16.4 393.74\n221  0.35809   0.0  6.20    1 0.5070 6.951  88.5  2.8617   8 307    17.4 391.70\n222  0.40771   0.0  6.20    1 0.5070 6.164  91.3  3.0480   8 307    17.4 395.24\n223  0.62356   0.0  6.20    1 0.5070 6.879  77.7  3.2721   8 307    17.4 390.39\n224  0.61470   0.0  6.20    0 0.5070 6.618  80.8  3.2721   8 307    17.4 396.90\n225  0.31533   0.0  6.20    0 0.5040 8.266  78.3  2.8944   8 307    17.4 385.05\n226  0.52693   0.0  6.20    0 0.5040 8.725  83.0  2.8944   8 307    17.4 382.00\n227  0.38214   0.0  6.20    0 0.5040 8.040  86.5  3.2157   8 307    17.4 387.38\n228  0.41238   0.0  6.20    0 0.5040 7.163  79.9  3.2157   8 307    17.4 372.08\n229  0.29819   0.0  6.20    0 0.5040 7.686  17.0  3.3751   8 307    17.4 377.51\n230  0.44178   0.0  6.20    0 0.5040 6.552  21.4  3.3751   8 307    17.4 380.34\n231  0.53700   0.0  6.20    0 0.5040 5.981  68.1  3.6715   8 307    17.4 378.35\n232  0.46296   0.0  6.20    0 0.5040 7.412  76.9  3.6715   8 307    17.4 376.14\n233  0.57529   0.0  6.20    0 0.5070 8.337  73.3  3.8384   8 307    17.4 385.91\n234  0.33147   0.0  6.20    0 0.5070 8.247  70.4  3.6519   8 307    17.4 378.95\n235  0.44791   0.0  6.20    1 0.5070 6.726  66.5  3.6519   8 307    17.4 360.20\n236  0.33045   0.0  6.20    0 0.5070 6.086  61.5  3.6519   8 307    17.4 376.75\n237  0.52058   0.0  6.20    1 0.5070 6.631  76.5  4.1480   8 307    17.4 388.45\n238  0.51183   0.0  6.20    0 0.5070 7.358  71.6  4.1480   8 307    17.4 390.07\n239  0.08244  30.0  4.93    0 0.4280 6.481  18.5  6.1899   6 300    16.6 379.41\n240  0.09252  30.0  4.93    0 0.4280 6.606  42.2  6.1899   6 300    16.6 383.78\n241  0.11329  30.0  4.93    0 0.4280 6.897  54.3  6.3361   6 300    16.6 391.25\n242  0.10612  30.0  4.93    0 0.4280 6.095  65.1  6.3361   6 300    16.6 394.62\n243  0.10290  30.0  4.93    0 0.4280 6.358  52.9  7.0355   6 300    16.6 372.75\n244  0.12757  30.0  4.93    0 0.4280 6.393   7.8  7.0355   6 300    16.6 374.71\n245  0.20608  22.0  5.86    0 0.4310 5.593  76.5  7.9549   7 330    19.1 372.49\n246  0.19133  22.0  5.86    0 0.4310 5.605  70.2  7.9549   7 330    19.1 389.13\n247  0.33983  22.0  5.86    0 0.4310 6.108  34.9  8.0555   7 330    19.1 390.18\n248  0.19657  22.0  5.86    0 0.4310 6.226  79.2  8.0555   7 330    19.1 376.14\n249  0.16439  22.0  5.86    0 0.4310 6.433  49.1  7.8265   7 330    19.1 374.71\n250  0.19073  22.0  5.86    0 0.4310 6.718  17.5  7.8265   7 330    19.1 393.74\n251  0.14030  22.0  5.86    0 0.4310 6.487  13.0  7.3967   7 330    19.1 396.28\n252  0.21409  22.0  5.86    0 0.4310 6.438   8.9  7.3967   7 330    19.1 377.07\n253  0.08221  22.0  5.86    0 0.4310 6.957   6.8  8.9067   7 330    19.1 386.09\n254  0.36894  22.0  5.86    0 0.4310 8.259   8.4  8.9067   7 330    19.1 396.90\n255  0.04819  80.0  3.64    0 0.3920 6.108  32.0  9.2203   1 315    16.4 392.89\n256  0.03548  80.0  3.64    0 0.3920 5.876  19.1  9.2203   1 315    16.4 395.18\n257  0.01538  90.0  3.75    0 0.3940 7.454  34.2  6.3361   3 244    15.9 386.34\n258  0.61154  20.0  3.97    0 0.6470 8.704  86.9  1.8010   5 264    13.0 389.70\n259  0.66351  20.0  3.97    0 0.6470 7.333 100.0  1.8946   5 264    13.0 383.29\n260  0.65665  20.0  3.97    0 0.6470 6.842 100.0  2.0107   5 264    13.0 391.93\n261  0.54011  20.0  3.97    0 0.6470 7.203  81.8  2.1121   5 264    13.0 392.80\n262  0.53412  20.0  3.97    0 0.6470 7.520  89.4  2.1398   5 264    13.0 388.37\n263  0.52014  20.0  3.97    0 0.6470 8.398  91.5  2.2885   5 264    13.0 386.86\n264  0.82526  20.0  3.97    0 0.6470 7.327  94.5  2.0788   5 264    13.0 393.42\n265  0.55007  20.0  3.97    0 0.6470 7.206  91.6  1.9301   5 264    13.0 387.89\n266  0.76162  20.0  3.97    0 0.6470 5.560  62.8  1.9865   5 264    13.0 392.40\n267  0.78570  20.0  3.97    0 0.6470 7.014  84.6  2.1329   5 264    13.0 384.07\n268  0.57834  20.0  3.97    0 0.5750 8.297  67.0  2.4216   5 264    13.0 384.54\n269  0.54050  20.0  3.97    0 0.5750 7.470  52.6  2.8720   5 264    13.0 390.30\n270  0.09065  20.0  6.96    1 0.4640 5.920  61.5  3.9175   3 223    18.6 391.34\n271  0.29916  20.0  6.96    0 0.4640 5.856  42.1  4.4290   3 223    18.6 388.65\n272  0.16211  20.0  6.96    0 0.4640 6.240  16.3  4.4290   3 223    18.6 396.90\n273  0.11460  20.0  6.96    0 0.4640 6.538  58.7  3.9175   3 223    18.6 394.96\n274  0.22188  20.0  6.96    1 0.4640 7.691  51.8  4.3665   3 223    18.6 390.77\n275  0.05644  40.0  6.41    1 0.4470 6.758  32.9  4.0776   4 254    17.6 396.90\n276  0.09604  40.0  6.41    0 0.4470 6.854  42.8  4.2673   4 254    17.6 396.90\n277  0.10469  40.0  6.41    1 0.4470 7.267  49.0  4.7872   4 254    17.6 389.25\n278  0.06127  40.0  6.41    1 0.4470 6.826  27.6  4.8628   4 254    17.6 393.45\n279  0.07978  40.0  6.41    0 0.4470 6.482  32.1  4.1403   4 254    17.6 396.90\n280  0.21038  20.0  3.33    0 0.4429 6.812  32.2  4.1007   5 216    14.9 396.90\n281  0.03578  20.0  3.33    0 0.4429 7.820  64.5  4.6947   5 216    14.9 387.31\n282  0.03705  20.0  3.33    0 0.4429 6.968  37.2  5.2447   5 216    14.9 392.23\n283  0.06129  20.0  3.33    1 0.4429 7.645  49.7  5.2119   5 216    14.9 377.07\n284  0.01501  90.0  1.21    1 0.4010 7.923  24.8  5.8850   1 198    13.6 395.52\n285  0.00906  90.0  2.97    0 0.4000 7.088  20.8  7.3073   1 285    15.3 394.72\n286  0.01096  55.0  2.25    0 0.3890 6.453  31.9  7.3073   1 300    15.3 394.72\n287  0.01965  80.0  1.76    0 0.3850 6.230  31.5  9.0892   1 241    18.2 341.60\n288  0.03871  52.5  5.32    0 0.4050 6.209  31.3  7.3172   6 293    16.6 396.90\n289  0.04590  52.5  5.32    0 0.4050 6.315  45.6  7.3172   6 293    16.6 396.90\n290  0.04297  52.5  5.32    0 0.4050 6.565  22.9  7.3172   6 293    16.6 371.72\n291  0.03502  80.0  4.95    0 0.4110 6.861  27.9  5.1167   4 245    19.2 396.90\n292  0.07886  80.0  4.95    0 0.4110 7.148  27.7  5.1167   4 245    19.2 396.90\n293  0.03615  80.0  4.95    0 0.4110 6.630  23.4  5.1167   4 245    19.2 396.90\n294  0.08265   0.0 13.92    0 0.4370 6.127  18.4  5.5027   4 289    16.0 396.90\n295  0.08199   0.0 13.92    0 0.4370 6.009  42.3  5.5027   4 289    16.0 396.90\n296  0.12932   0.0 13.92    0 0.4370 6.678  31.1  5.9604   4 289    16.0 396.90\n297  0.05372   0.0 13.92    0 0.4370 6.549  51.0  5.9604   4 289    16.0 392.85\n298  0.14103   0.0 13.92    0 0.4370 5.790  58.0  6.3200   4 289    16.0 396.90\n299  0.06466  70.0  2.24    0 0.4000 6.345  20.1  7.8278   5 358    14.8 368.24\n300  0.05561  70.0  2.24    0 0.4000 7.041  10.0  7.8278   5 358    14.8 371.58\n301  0.04417  70.0  2.24    0 0.4000 6.871  47.4  7.8278   5 358    14.8 390.86\n302  0.03537  34.0  6.09    0 0.4330 6.590  40.4  5.4917   7 329    16.1 395.75\n303  0.09266  34.0  6.09    0 0.4330 6.495  18.4  5.4917   7 329    16.1 383.61\n304  0.10000  34.0  6.09    0 0.4330 6.982  17.7  5.4917   7 329    16.1 390.43\n305  0.05515  33.0  2.18    0 0.4720 7.236  41.1  4.0220   7 222    18.4 393.68\n306  0.05479  33.0  2.18    0 0.4720 6.616  58.1  3.3700   7 222    18.4 393.36\n307  0.07503  33.0  2.18    0 0.4720 7.420  71.9  3.0992   7 222    18.4 396.90\n308  0.04932  33.0  2.18    0 0.4720 6.849  70.3  3.1827   7 222    18.4 396.90\n309  0.49298   0.0  9.90    0 0.5440 6.635  82.5  3.3175   4 304    18.4 396.90\n310  0.34940   0.0  9.90    0 0.5440 5.972  76.7  3.1025   4 304    18.4 396.24\n311  2.63548   0.0  9.90    0 0.5440 4.973  37.8  2.5194   4 304    18.4 350.45\n312  0.79041   0.0  9.90    0 0.5440 6.122  52.8  2.6403   4 304    18.4 396.90\n313  0.26169   0.0  9.90    0 0.5440 6.023  90.4  2.8340   4 304    18.4 396.30\n314  0.26938   0.0  9.90    0 0.5440 6.266  82.8  3.2628   4 304    18.4 393.39\n315  0.36920   0.0  9.90    0 0.5440 6.567  87.3  3.6023   4 304    18.4 395.69\n316  0.25356   0.0  9.90    0 0.5440 5.705  77.7  3.9450   4 304    18.4 396.42\n317  0.31827   0.0  9.90    0 0.5440 5.914  83.2  3.9986   4 304    18.4 390.70\n318  0.24522   0.0  9.90    0 0.5440 5.782  71.7  4.0317   4 304    18.4 396.90\n319  0.40202   0.0  9.90    0 0.5440 6.382  67.2  3.5325   4 304    18.4 395.21\n320  0.47547   0.0  9.90    0 0.5440 6.113  58.8  4.0019   4 304    18.4 396.23\n321  0.16760   0.0  7.38    0 0.4930 6.426  52.3  4.5404   5 287    19.6 396.90\n322  0.18159   0.0  7.38    0 0.4930 6.376  54.3  4.5404   5 287    19.6 396.90\n323  0.35114   0.0  7.38    0 0.4930 6.041  49.9  4.7211   5 287    19.6 396.90\n324  0.28392   0.0  7.38    0 0.4930 5.708  74.3  4.7211   5 287    19.6 391.13\n325  0.34109   0.0  7.38    0 0.4930 6.415  40.1  4.7211   5 287    19.6 396.90\n326  0.19186   0.0  7.38    0 0.4930 6.431  14.7  5.4159   5 287    19.6 393.68\n327  0.30347   0.0  7.38    0 0.4930 6.312  28.9  5.4159   5 287    19.6 396.90\n328  0.24103   0.0  7.38    0 0.4930 6.083  43.7  5.4159   5 287    19.6 396.90\n329  0.06617   0.0  3.24    0 0.4600 5.868  25.8  5.2146   4 430    16.9 382.44\n330  0.06724   0.0  3.24    0 0.4600 6.333  17.2  5.2146   4 430    16.9 375.21\n331  0.04544   0.0  3.24    0 0.4600 6.144  32.2  5.8736   4 430    16.9 368.57\n332  0.05023  35.0  6.06    0 0.4379 5.706  28.4  6.6407   1 304    16.9 394.02\n333  0.03466  35.0  6.06    0 0.4379 6.031  23.3  6.6407   1 304    16.9 362.25\n334  0.05083   0.0  5.19    0 0.5150 6.316  38.1  6.4584   5 224    20.2 389.71\n335  0.03738   0.0  5.19    0 0.5150 6.310  38.5  6.4584   5 224    20.2 389.40\n336  0.03961   0.0  5.19    0 0.5150 6.037  34.5  5.9853   5 224    20.2 396.90\n337  0.03427   0.0  5.19    0 0.5150 5.869  46.3  5.2311   5 224    20.2 396.90\n338  0.03041   0.0  5.19    0 0.5150 5.895  59.6  5.6150   5 224    20.2 394.81\n339  0.03306   0.0  5.19    0 0.5150 6.059  37.3  4.8122   5 224    20.2 396.14\n340  0.05497   0.0  5.19    0 0.5150 5.985  45.4  4.8122   5 224    20.2 396.90\n341  0.06151   0.0  5.19    0 0.5150 5.968  58.5  4.8122   5 224    20.2 396.90\n342  0.01301  35.0  1.52    0 0.4420 7.241  49.3  7.0379   1 284    15.5 394.74\n343  0.02498   0.0  1.89    0 0.5180 6.540  59.7  6.2669   1 422    15.9 389.96\n344  0.02543  55.0  3.78    0 0.4840 6.696  56.4  5.7321   5 370    17.6 396.90\n345  0.03049  55.0  3.78    0 0.4840 6.874  28.1  6.4654   5 370    17.6 387.97\n346  0.03113   0.0  4.39    0 0.4420 6.014  48.5  8.0136   3 352    18.8 385.64\n347  0.06162   0.0  4.39    0 0.4420 5.898  52.3  8.0136   3 352    18.8 364.61\n348  0.01870  85.0  4.15    0 0.4290 6.516  27.7  8.5353   4 351    17.9 392.43\n349  0.01501  80.0  2.01    0 0.4350 6.635  29.7  8.3440   4 280    17.0 390.94\n350  0.02899  40.0  1.25    0 0.4290 6.939  34.5  8.7921   1 335    19.7 389.85\n351  0.06211  40.0  1.25    0 0.4290 6.490  44.4  8.7921   1 335    19.7 396.90\n352  0.07950  60.0  1.69    0 0.4110 6.579  35.9 10.7103   4 411    18.3 370.78\n353  0.07244  60.0  1.69    0 0.4110 5.884  18.5 10.7103   4 411    18.3 392.33\n354  0.01709  90.0  2.02    0 0.4100 6.728  36.1 12.1265   5 187    17.0 384.46\n355  0.04301  80.0  1.91    0 0.4130 5.663  21.9 10.5857   4 334    22.0 382.80\n356  0.10659  80.0  1.91    0 0.4130 5.936  19.5 10.5857   4 334    22.0 376.04\n357  8.98296   0.0 18.10    1 0.7700 6.212  97.4  2.1222  24 666    20.2 377.73\n358  3.84970   0.0 18.10    1 0.7700 6.395  91.0  2.5052  24 666    20.2 391.34\n359  5.20177   0.0 18.10    1 0.7700 6.127  83.4  2.7227  24 666    20.2 395.43\n360  4.26131   0.0 18.10    0 0.7700 6.112  81.3  2.5091  24 666    20.2 390.74\n361  4.54192   0.0 18.10    0 0.7700 6.398  88.0  2.5182  24 666    20.2 374.56\n362  3.83684   0.0 18.10    0 0.7700 6.251  91.1  2.2955  24 666    20.2 350.65\n363  3.67822   0.0 18.10    0 0.7700 5.362  96.2  2.1036  24 666    20.2 380.79\n364  4.22239   0.0 18.10    1 0.7700 5.803  89.0  1.9047  24 666    20.2 353.04\n365  3.47428   0.0 18.10    1 0.7180 8.780  82.9  1.9047  24 666    20.2 354.55\n366  4.55587   0.0 18.10    0 0.7180 3.561  87.9  1.6132  24 666    20.2 354.70\n367  3.69695   0.0 18.10    0 0.7180 4.963  91.4  1.7523  24 666    20.2 316.03\n368 13.52220   0.0 18.10    0 0.6310 3.863 100.0  1.5106  24 666    20.2 131.42\n369  4.89822   0.0 18.10    0 0.6310 4.970 100.0  1.3325  24 666    20.2 375.52\n370  5.66998   0.0 18.10    1 0.6310 6.683  96.8  1.3567  24 666    20.2 375.33\n371  6.53876   0.0 18.10    1 0.6310 7.016  97.5  1.2024  24 666    20.2 392.05\n372  9.23230   0.0 18.10    0 0.6310 6.216 100.0  1.1691  24 666    20.2 366.15\n373  8.26725   0.0 18.10    1 0.6680 5.875  89.6  1.1296  24 666    20.2 347.88\n374 11.10810   0.0 18.10    0 0.6680 4.906 100.0  1.1742  24 666    20.2 396.90\n375 18.49820   0.0 18.10    0 0.6680 4.138 100.0  1.1370  24 666    20.2 396.90\n376 19.60910   0.0 18.10    0 0.6710 7.313  97.9  1.3163  24 666    20.2 396.90\n377 15.28800   0.0 18.10    0 0.6710 6.649  93.3  1.3449  24 666    20.2 363.02\n378  9.82349   0.0 18.10    0 0.6710 6.794  98.8  1.3580  24 666    20.2 396.90\n379 23.64820   0.0 18.10    0 0.6710 6.380  96.2  1.3861  24 666    20.2 396.90\n380 17.86670   0.0 18.10    0 0.6710 6.223 100.0  1.3861  24 666    20.2 393.74\n381 88.97620   0.0 18.10    0 0.6710 6.968  91.9  1.4165  24 666    20.2 396.90\n382 15.87440   0.0 18.10    0 0.6710 6.545  99.1  1.5192  24 666    20.2 396.90\n383  9.18702   0.0 18.10    0 0.7000 5.536 100.0  1.5804  24 666    20.2 396.90\n384  7.99248   0.0 18.10    0 0.7000 5.520 100.0  1.5331  24 666    20.2 396.90\n385 20.08490   0.0 18.10    0 0.7000 4.368  91.2  1.4395  24 666    20.2 285.83\n386 16.81180   0.0 18.10    0 0.7000 5.277  98.1  1.4261  24 666    20.2 396.90\n387 24.39380   0.0 18.10    0 0.7000 4.652 100.0  1.4672  24 666    20.2 396.90\n388 22.59710   0.0 18.10    0 0.7000 5.000  89.5  1.5184  24 666    20.2 396.90\n389 14.33370   0.0 18.10    0 0.7000 4.880 100.0  1.5895  24 666    20.2 372.92\n390  8.15174   0.0 18.10    0 0.7000 5.390  98.9  1.7281  24 666    20.2 396.90\n391  6.96215   0.0 18.10    0 0.7000 5.713  97.0  1.9265  24 666    20.2 394.43\n392  5.29305   0.0 18.10    0 0.7000 6.051  82.5  2.1678  24 666    20.2 378.38\n393 11.57790   0.0 18.10    0 0.7000 5.036  97.0  1.7700  24 666    20.2 396.90\n394  8.64476   0.0 18.10    0 0.6930 6.193  92.6  1.7912  24 666    20.2 396.90\n395 13.35980   0.0 18.10    0 0.6930 5.887  94.7  1.7821  24 666    20.2 396.90\n396  8.71675   0.0 18.10    0 0.6930 6.471  98.8  1.7257  24 666    20.2 391.98\n397  5.87205   0.0 18.10    0 0.6930 6.405  96.0  1.6768  24 666    20.2 396.90\n398  7.67202   0.0 18.10    0 0.6930 5.747  98.9  1.6334  24 666    20.2 393.10\n399 38.35180   0.0 18.10    0 0.6930 5.453 100.0  1.4896  24 666    20.2 396.90\n400  9.91655   0.0 18.10    0 0.6930 5.852  77.8  1.5004  24 666    20.2 338.16\n401 25.04610   0.0 18.10    0 0.6930 5.987 100.0  1.5888  24 666    20.2 396.90\n402 14.23620   0.0 18.10    0 0.6930 6.343 100.0  1.5741  24 666    20.2 396.90\n403  9.59571   0.0 18.10    0 0.6930 6.404 100.0  1.6390  24 666    20.2 376.11\n404 24.80170   0.0 18.10    0 0.6930 5.349  96.0  1.7028  24 666    20.2 396.90\n405 41.52920   0.0 18.10    0 0.6930 5.531  85.4  1.6074  24 666    20.2 329.46\n406 67.92080   0.0 18.10    0 0.6930 5.683 100.0  1.4254  24 666    20.2 384.97\n407 20.71620   0.0 18.10    0 0.6590 4.138 100.0  1.1781  24 666    20.2 370.22\n408 11.95110   0.0 18.10    0 0.6590 5.608 100.0  1.2852  24 666    20.2 332.09\n409  7.40389   0.0 18.10    0 0.5970 5.617  97.9  1.4547  24 666    20.2 314.64\n410 14.43830   0.0 18.10    0 0.5970 6.852 100.0  1.4655  24 666    20.2 179.36\n411 51.13580   0.0 18.10    0 0.5970 5.757 100.0  1.4130  24 666    20.2   2.60\n412 14.05070   0.0 18.10    0 0.5970 6.657 100.0  1.5275  24 666    20.2  35.05\n413 18.81100   0.0 18.10    0 0.5970 4.628 100.0  1.5539  24 666    20.2  28.79\n414 28.65580   0.0 18.10    0 0.5970 5.155 100.0  1.5894  24 666    20.2 210.97\n415 45.74610   0.0 18.10    0 0.6930 4.519 100.0  1.6582  24 666    20.2  88.27\n416 18.08460   0.0 18.10    0 0.6790 6.434 100.0  1.8347  24 666    20.2  27.25\n417 10.83420   0.0 18.10    0 0.6790 6.782  90.8  1.8195  24 666    20.2  21.57\n418 25.94060   0.0 18.10    0 0.6790 5.304  89.1  1.6475  24 666    20.2 127.36\n419 73.53410   0.0 18.10    0 0.6790 5.957 100.0  1.8026  24 666    20.2  16.45\n420 11.81230   0.0 18.10    0 0.7180 6.824  76.5  1.7940  24 666    20.2  48.45\n421 11.08740   0.0 18.10    0 0.7180 6.411 100.0  1.8589  24 666    20.2 318.75\n422  7.02259   0.0 18.10    0 0.7180 6.006  95.3  1.8746  24 666    20.2 319.98\n423 12.04820   0.0 18.10    0 0.6140 5.648  87.6  1.9512  24 666    20.2 291.55\n424  7.05042   0.0 18.10    0 0.6140 6.103  85.1  2.0218  24 666    20.2   2.52\n425  8.79212   0.0 18.10    0 0.5840 5.565  70.6  2.0635  24 666    20.2   3.65\n426 15.86030   0.0 18.10    0 0.6790 5.896  95.4  1.9096  24 666    20.2   7.68\n427 12.24720   0.0 18.10    0 0.5840 5.837  59.7  1.9976  24 666    20.2  24.65\n428 37.66190   0.0 18.10    0 0.6790 6.202  78.7  1.8629  24 666    20.2  18.82\n429  7.36711   0.0 18.10    0 0.6790 6.193  78.1  1.9356  24 666    20.2  96.73\n430  9.33889   0.0 18.10    0 0.6790 6.380  95.6  1.9682  24 666    20.2  60.72\n431  8.49213   0.0 18.10    0 0.5840 6.348  86.1  2.0527  24 666    20.2  83.45\n432 10.06230   0.0 18.10    0 0.5840 6.833  94.3  2.0882  24 666    20.2  81.33\n433  6.44405   0.0 18.10    0 0.5840 6.425  74.8  2.2004  24 666    20.2  97.95\n434  5.58107   0.0 18.10    0 0.7130 6.436  87.9  2.3158  24 666    20.2 100.19\n435 13.91340   0.0 18.10    0 0.7130 6.208  95.0  2.2222  24 666    20.2 100.63\n436 11.16040   0.0 18.10    0 0.7400 6.629  94.6  2.1247  24 666    20.2 109.85\n437 14.42080   0.0 18.10    0 0.7400 6.461  93.3  2.0026  24 666    20.2  27.49\n438 15.17720   0.0 18.10    0 0.7400 6.152 100.0  1.9142  24 666    20.2   9.32\n439 13.67810   0.0 18.10    0 0.7400 5.935  87.9  1.8206  24 666    20.2  68.95\n440  9.39063   0.0 18.10    0 0.7400 5.627  93.9  1.8172  24 666    20.2 396.90\n441 22.05110   0.0 18.10    0 0.7400 5.818  92.4  1.8662  24 666    20.2 391.45\n442  9.72418   0.0 18.10    0 0.7400 6.406  97.2  2.0651  24 666    20.2 385.96\n443  5.66637   0.0 18.10    0 0.7400 6.219 100.0  2.0048  24 666    20.2 395.69\n444  9.96654   0.0 18.10    0 0.7400 6.485 100.0  1.9784  24 666    20.2 386.73\n445 12.80230   0.0 18.10    0 0.7400 5.854  96.6  1.8956  24 666    20.2 240.52\n446 10.67180   0.0 18.10    0 0.7400 6.459  94.8  1.9879  24 666    20.2  43.06\n447  6.28807   0.0 18.10    0 0.7400 6.341  96.4  2.0720  24 666    20.2 318.01\n448  9.92485   0.0 18.10    0 0.7400 6.251  96.6  2.1980  24 666    20.2 388.52\n449  9.32909   0.0 18.10    0 0.7130 6.185  98.7  2.2616  24 666    20.2 396.90\n450  7.52601   0.0 18.10    0 0.7130 6.417  98.3  2.1850  24 666    20.2 304.21\n451  6.71772   0.0 18.10    0 0.7130 6.749  92.6  2.3236  24 666    20.2   0.32\n452  5.44114   0.0 18.10    0 0.7130 6.655  98.2  2.3552  24 666    20.2 355.29\n453  5.09017   0.0 18.10    0 0.7130 6.297  91.8  2.3682  24 666    20.2 385.09\n454  8.24809   0.0 18.10    0 0.7130 7.393  99.3  2.4527  24 666    20.2 375.87\n455  9.51363   0.0 18.10    0 0.7130 6.728  94.1  2.4961  24 666    20.2   6.68\n456  4.75237   0.0 18.10    0 0.7130 6.525  86.5  2.4358  24 666    20.2  50.92\n457  4.66883   0.0 18.10    0 0.7130 5.976  87.9  2.5806  24 666    20.2  10.48\n458  8.20058   0.0 18.10    0 0.7130 5.936  80.3  2.7792  24 666    20.2   3.50\n459  7.75223   0.0 18.10    0 0.7130 6.301  83.7  2.7831  24 666    20.2 272.21\n460  6.80117   0.0 18.10    0 0.7130 6.081  84.4  2.7175  24 666    20.2 396.90\n461  4.81213   0.0 18.10    0 0.7130 6.701  90.0  2.5975  24 666    20.2 255.23\n462  3.69311   0.0 18.10    0 0.7130 6.376  88.4  2.5671  24 666    20.2 391.43\n463  6.65492   0.0 18.10    0 0.7130 6.317  83.0  2.7344  24 666    20.2 396.90\n464  5.82115   0.0 18.10    0 0.7130 6.513  89.9  2.8016  24 666    20.2 393.82\n465  7.83932   0.0 18.10    0 0.6550 6.209  65.4  2.9634  24 666    20.2 396.90\n466  3.16360   0.0 18.10    0 0.6550 5.759  48.2  3.0665  24 666    20.2 334.40\n467  3.77498   0.0 18.10    0 0.6550 5.952  84.7  2.8715  24 666    20.2  22.01\n468  4.42228   0.0 18.10    0 0.5840 6.003  94.5  2.5403  24 666    20.2 331.29\n469 15.57570   0.0 18.10    0 0.5800 5.926  71.0  2.9084  24 666    20.2 368.74\n470 13.07510   0.0 18.10    0 0.5800 5.713  56.7  2.8237  24 666    20.2 396.90\n471  4.34879   0.0 18.10    0 0.5800 6.167  84.0  3.0334  24 666    20.2 396.90\n472  4.03841   0.0 18.10    0 0.5320 6.229  90.7  3.0993  24 666    20.2 395.33\n473  3.56868   0.0 18.10    0 0.5800 6.437  75.0  2.8965  24 666    20.2 393.37\n474  4.64689   0.0 18.10    0 0.6140 6.980  67.6  2.5329  24 666    20.2 374.68\n475  8.05579   0.0 18.10    0 0.5840 5.427  95.4  2.4298  24 666    20.2 352.58\n476  6.39312   0.0 18.10    0 0.5840 6.162  97.4  2.2060  24 666    20.2 302.76\n477  4.87141   0.0 18.10    0 0.6140 6.484  93.6  2.3053  24 666    20.2 396.21\n478 15.02340   0.0 18.10    0 0.6140 5.304  97.3  2.1007  24 666    20.2 349.48\n479 10.23300   0.0 18.10    0 0.6140 6.185  96.7  2.1705  24 666    20.2 379.70\n480 14.33370   0.0 18.10    0 0.6140 6.229  88.0  1.9512  24 666    20.2 383.32\n481  5.82401   0.0 18.10    0 0.5320 6.242  64.7  3.4242  24 666    20.2 396.90\n482  5.70818   0.0 18.10    0 0.5320 6.750  74.9  3.3317  24 666    20.2 393.07\n483  5.73116   0.0 18.10    0 0.5320 7.061  77.0  3.4106  24 666    20.2 395.28\n484  2.81838   0.0 18.10    0 0.5320 5.762  40.3  4.0983  24 666    20.2 392.92\n485  2.37857   0.0 18.10    0 0.5830 5.871  41.9  3.7240  24 666    20.2 370.73\n486  3.67367   0.0 18.10    0 0.5830 6.312  51.9  3.9917  24 666    20.2 388.62\n487  5.69175   0.0 18.10    0 0.5830 6.114  79.8  3.5459  24 666    20.2 392.68\n488  4.83567   0.0 18.10    0 0.5830 5.905  53.2  3.1523  24 666    20.2 388.22\n489  0.15086   0.0 27.74    0 0.6090 5.454  92.7  1.8209   4 711    20.1 395.09\n490  0.18337   0.0 27.74    0 0.6090 5.414  98.3  1.7554   4 711    20.1 344.05\n491  0.20746   0.0 27.74    0 0.6090 5.093  98.0  1.8226   4 711    20.1 318.43\n492  0.10574   0.0 27.74    0 0.6090 5.983  98.8  1.8681   4 711    20.1 390.11\n493  0.11132   0.0 27.74    0 0.6090 5.983  83.5  2.1099   4 711    20.1 396.90\n494  0.17331   0.0  9.69    0 0.5850 5.707  54.0  2.3817   6 391    19.2 396.90\n495  0.27957   0.0  9.69    0 0.5850 5.926  42.6  2.3817   6 391    19.2 396.90\n496  0.17899   0.0  9.69    0 0.5850 5.670  28.8  2.7986   6 391    19.2 393.29\n497  0.28960   0.0  9.69    0 0.5850 5.390  72.9  2.7986   6 391    19.2 396.90\n498  0.26838   0.0  9.69    0 0.5850 5.794  70.6  2.8927   6 391    19.2 396.90\n499  0.23912   0.0  9.69    0 0.5850 6.019  65.3  2.4091   6 391    19.2 396.90\n500  0.17783   0.0  9.69    0 0.5850 5.569  73.5  2.3999   6 391    19.2 395.77\n501  0.22438   0.0  9.69    0 0.5850 6.027  79.7  2.4982   6 391    19.2 396.90\n502  0.06263   0.0 11.93    0 0.5730 6.593  69.1  2.4786   1 273    21.0 391.99\n503  0.04527   0.0 11.93    0 0.5730 6.120  76.7  2.2875   1 273    21.0 396.90\n504  0.06076   0.0 11.93    0 0.5730 6.976  91.0  2.1675   1 273    21.0 396.90\n505  0.10959   0.0 11.93    0 0.5730 6.794  89.3  2.3889   1 273    21.0 393.45\n506  0.04741   0.0 11.93    0 0.5730 6.030  80.8  2.5050   1 273    21.0 396.90\n    lstat medv\n1    4.98 24.0\n2    9.14 21.6\n3    4.03 34.7\n4    2.94 33.4\n5    5.33 36.2\n6    5.21 28.7\n7   12.43 22.9\n8   19.15 27.1\n9   29.93 16.5\n10  17.10 18.9\n11  20.45 15.0\n12  13.27 18.9\n13  15.71 21.7\n14   8.26 20.4\n15  10.26 18.2\n16   8.47 19.9\n17   6.58 23.1\n18  14.67 17.5\n19  11.69 20.2\n20  11.28 18.2\n21  21.02 13.6\n22  13.83 19.6\n23  18.72 15.2\n24  19.88 14.5\n25  16.30 15.6\n26  16.51 13.9\n27  14.81 16.6\n28  17.28 14.8\n29  12.80 18.4\n30  11.98 21.0\n31  22.60 12.7\n32  13.04 14.5\n33  27.71 13.2\n34  18.35 13.1\n35  20.34 13.5\n36   9.68 18.9\n37  11.41 20.0\n38   8.77 21.0\n39  10.13 24.7\n40   4.32 30.8\n41   1.98 34.9\n42   4.84 26.6\n43   5.81 25.3\n44   7.44 24.7\n45   9.55 21.2\n46  10.21 19.3\n47  14.15 20.0\n48  18.80 16.6\n49  30.81 14.4\n50  16.20 19.4\n51  13.45 19.7\n52   9.43 20.5\n53   5.28 25.0\n54   8.43 23.4\n55  14.80 18.9\n56   4.81 35.4\n57   5.77 24.7\n58   3.95 31.6\n59   6.86 23.3\n60   9.22 19.6\n61  13.15 18.7\n62  14.44 16.0\n63   6.73 22.2\n64   9.50 25.0\n65   8.05 33.0\n66   4.67 23.5\n67  10.24 19.4\n68   8.10 22.0\n69  13.09 17.4\n70   8.79 20.9\n71   6.72 24.2\n72   9.88 21.7\n73   5.52 22.8\n74   7.54 23.4\n75   6.78 24.1\n76   8.94 21.4\n77  11.97 20.0\n78  10.27 20.8\n79  12.34 21.2\n80   9.10 20.3\n81   5.29 28.0\n82   7.22 23.9\n83   6.72 24.8\n84   7.51 22.9\n85   9.62 23.9\n86   6.53 26.6\n87  12.86 22.5\n88   8.44 22.2\n89   5.50 23.6\n90   5.70 28.7\n91   8.81 22.6\n92   8.20 22.0\n93   8.16 22.9\n94   6.21 25.0\n95  10.59 20.6\n96   6.65 28.4\n97  11.34 21.4\n98   4.21 38.7\n99   3.57 43.8\n100  6.19 33.2\n101  9.42 27.5\n102  7.67 26.5\n103 10.63 18.6\n104 13.44 19.3\n105 12.33 20.1\n106 16.47 19.5\n107 18.66 19.5\n108 14.09 20.4\n109 12.27 19.8\n110 15.55 19.4\n111 13.00 21.7\n112 10.16 22.8\n113 16.21 18.8\n114 17.09 18.7\n115 10.45 18.5\n116 15.76 18.3\n117 12.04 21.2\n118 10.30 19.2\n119 15.37 20.4\n120 13.61 19.3\n121 14.37 22.0\n122 14.27 20.3\n123 17.93 20.5\n124 25.41 17.3\n125 17.58 18.8\n126 14.81 21.4\n127 27.26 15.7\n128 17.19 16.2\n129 15.39 18.0\n130 18.34 14.3\n131 12.60 19.2\n132 12.26 19.6\n133 11.12 23.0\n134 15.03 18.4\n135 17.31 15.6\n136 16.96 18.1\n137 16.90 17.4\n138 14.59 17.1\n139 21.32 13.3\n140 18.46 17.8\n141 24.16 14.0\n142 34.41 14.4\n143 26.82 13.4\n144 26.42 15.6\n145 29.29 11.8\n146 27.80 13.8\n147 16.65 15.6\n148 29.53 14.6\n149 28.32 17.8\n150 21.45 15.4\n151 14.10 21.5\n152 13.28 19.6\n153 12.12 15.3\n154 15.79 19.4\n155 15.12 17.0\n156 15.02 15.6\n157 16.14 13.1\n158  4.59 41.3\n159  6.43 24.3\n160  7.39 23.3\n161  5.50 27.0\n162  1.73 50.0\n163  1.92 50.0\n164  3.32 50.0\n165 11.64 22.7\n166  9.81 25.0\n167  3.70 50.0\n168 12.14 23.8\n169 11.10 23.8\n170 11.32 22.3\n171 14.43 17.4\n172 12.03 19.1\n173 14.69 23.1\n174  9.04 23.6\n175  9.64 22.6\n176  5.33 29.4\n177 10.11 23.2\n178  6.29 24.6\n179  6.92 29.9\n180  5.04 37.2\n181  7.56 39.8\n182  9.45 36.2\n183  4.82 37.9\n184  5.68 32.5\n185 13.98 26.4\n186 13.15 29.6\n187  4.45 50.0\n188  6.68 32.0\n189  4.56 29.8\n190  5.39 34.9\n191  5.10 37.0\n192  4.69 30.5\n193  2.87 36.4\n194  5.03 31.1\n195  4.38 29.1\n196  2.97 50.0\n197  4.08 33.3\n198  8.61 30.3\n199  6.62 34.6\n200  4.56 34.9\n201  4.45 32.9\n202  7.43 24.1\n203  3.11 42.3\n204  3.81 48.5\n205  2.88 50.0\n206 10.87 22.6\n207 10.97 24.4\n208 18.06 22.5\n209 14.66 24.4\n210 23.09 20.0\n211 17.27 21.7\n212 23.98 19.3\n213 16.03 22.4\n214  9.38 28.1\n215 29.55 23.7\n216  9.47 25.0\n217 13.51 23.3\n218  9.69 28.7\n219 17.92 21.5\n220 10.50 23.0\n221  9.71 26.7\n222 21.46 21.7\n223  9.93 27.5\n224  7.60 30.1\n225  4.14 44.8\n226  4.63 50.0\n227  3.13 37.6\n228  6.36 31.6\n229  3.92 46.7\n230  3.76 31.5\n231 11.65 24.3\n232  5.25 31.7\n233  2.47 41.7\n234  3.95 48.3\n235  8.05 29.0\n236 10.88 24.0\n237  9.54 25.1\n238  4.73 31.5\n239  6.36 23.7\n240  7.37 23.3\n241 11.38 22.0\n242 12.40 20.1\n243 11.22 22.2\n244  5.19 23.7\n245 12.50 17.6\n246 18.46 18.5\n247  9.16 24.3\n248 10.15 20.5\n249  9.52 24.5\n250  6.56 26.2\n251  5.90 24.4\n252  3.59 24.8\n253  3.53 29.6\n254  3.54 42.8\n255  6.57 21.9\n256  9.25 20.9\n257  3.11 44.0\n258  5.12 50.0\n259  7.79 36.0\n260  6.90 30.1\n261  9.59 33.8\n262  7.26 43.1\n263  5.91 48.8\n264 11.25 31.0\n265  8.10 36.5\n266 10.45 22.8\n267 14.79 30.7\n268  7.44 50.0\n269  3.16 43.5\n270 13.65 20.7\n271 13.00 21.1\n272  6.59 25.2\n273  7.73 24.4\n274  6.58 35.2\n275  3.53 32.4\n276  2.98 32.0\n277  6.05 33.2\n278  4.16 33.1\n279  7.19 29.1\n280  4.85 35.1\n281  3.76 45.4\n282  4.59 35.4\n283  3.01 46.0\n284  3.16 50.0\n285  7.85 32.2\n286  8.23 22.0\n287 12.93 20.1\n288  7.14 23.2\n289  7.60 22.3\n290  9.51 24.8\n291  3.33 28.5\n292  3.56 37.3\n293  4.70 27.9\n294  8.58 23.9\n295 10.40 21.7\n296  6.27 28.6\n297  7.39 27.1\n298 15.84 20.3\n299  4.97 22.5\n300  4.74 29.0\n301  6.07 24.8\n302  9.50 22.0\n303  8.67 26.4\n304  4.86 33.1\n305  6.93 36.1\n306  8.93 28.4\n307  6.47 33.4\n308  7.53 28.2\n309  4.54 22.8\n310  9.97 20.3\n311 12.64 16.1\n312  5.98 22.1\n313 11.72 19.4\n314  7.90 21.6\n315  9.28 23.8\n316 11.50 16.2\n317 18.33 17.8\n318 15.94 19.8\n319 10.36 23.1\n320 12.73 21.0\n321  7.20 23.8\n322  6.87 23.1\n323  7.70 20.4\n324 11.74 18.5\n325  6.12 25.0\n326  5.08 24.6\n327  6.15 23.0\n328 12.79 22.2\n329  9.97 19.3\n330  7.34 22.6\n331  9.09 19.8\n332 12.43 17.1\n333  7.83 19.4\n334  5.68 22.2\n335  6.75 20.7\n336  8.01 21.1\n337  9.80 19.5\n338 10.56 18.5\n339  8.51 20.6\n340  9.74 19.0\n341  9.29 18.7\n342  5.49 32.7\n343  8.65 16.5\n344  7.18 23.9\n345  4.61 31.2\n346 10.53 17.5\n347 12.67 17.2\n348  6.36 23.1\n349  5.99 24.5\n350  5.89 26.6\n351  5.98 22.9\n352  5.49 24.1\n353  7.79 18.6\n354  4.50 30.1\n355  8.05 18.2\n356  5.57 20.6\n357 17.60 17.8\n358 13.27 21.7\n359 11.48 22.7\n360 12.67 22.6\n361  7.79 25.0\n362 14.19 19.9\n363 10.19 20.8\n364 14.64 16.8\n365  5.29 21.9\n366  7.12 27.5\n367 14.00 21.9\n368 13.33 23.1\n369  3.26 50.0\n370  3.73 50.0\n371  2.96 50.0\n372  9.53 50.0\n373  8.88 50.0\n374 34.77 13.8\n375 37.97 13.8\n376 13.44 15.0\n377 23.24 13.9\n378 21.24 13.3\n379 23.69 13.1\n380 21.78 10.2\n381 17.21 10.4\n382 21.08 10.9\n383 23.60 11.3\n384 24.56 12.3\n385 30.63  8.8\n386 30.81  7.2\n387 28.28 10.5\n388 31.99  7.4\n389 30.62 10.2\n390 20.85 11.5\n391 17.11 15.1\n392 18.76 23.2\n393 25.68  9.7\n394 15.17 13.8\n395 16.35 12.7\n396 17.12 13.1\n397 19.37 12.5\n398 19.92  8.5\n399 30.59  5.0\n400 29.97  6.3\n401 26.77  5.6\n402 20.32  7.2\n403 20.31 12.1\n404 19.77  8.3\n405 27.38  8.5\n406 22.98  5.0\n407 23.34 11.9\n408 12.13 27.9\n409 26.40 17.2\n410 19.78 27.5\n411 10.11 15.0\n412 21.22 17.2\n413 34.37 17.9\n414 20.08 16.3\n415 36.98  7.0\n416 29.05  7.2\n417 25.79  7.5\n418 26.64 10.4\n419 20.62  8.8\n420 22.74  8.4\n421 15.02 16.7\n422 15.70 14.2\n423 14.10 20.8\n424 23.29 13.4\n425 17.16 11.7\n426 24.39  8.3\n427 15.69 10.2\n428 14.52 10.9\n429 21.52 11.0\n430 24.08  9.5\n431 17.64 14.5\n432 19.69 14.1\n433 12.03 16.1\n434 16.22 14.3\n435 15.17 11.7\n436 23.27 13.4\n437 18.05  9.6\n438 26.45  8.7\n439 34.02  8.4\n440 22.88 12.8\n441 22.11 10.5\n442 19.52 17.1\n443 16.59 18.4\n444 18.85 15.4\n445 23.79 10.8\n446 23.98 11.8\n447 17.79 14.9\n448 16.44 12.6\n449 18.13 14.1\n450 19.31 13.0\n451 17.44 13.4\n452 17.73 15.2\n453 17.27 16.1\n454 16.74 17.8\n455 18.71 14.9\n456 18.13 14.1\n457 19.01 12.7\n458 16.94 13.5\n459 16.23 14.9\n460 14.70 20.0\n461 16.42 16.4\n462 14.65 17.7\n463 13.99 19.5\n464 10.29 20.2\n465 13.22 21.4\n466 14.13 19.9\n467 17.15 19.0\n468 21.32 19.1\n469 18.13 19.1\n470 14.76 20.1\n471 16.29 19.9\n472 12.87 19.6\n473 14.36 23.2\n474 11.66 29.8\n475 18.14 13.8\n476 24.10 13.3\n477 18.68 16.7\n478 24.91 12.0\n479 18.03 14.6\n480 13.11 21.4\n481 10.74 23.0\n482  7.74 23.7\n483  7.01 25.0\n484 10.42 21.8\n485 13.34 20.6\n486 10.58 21.2\n487 14.98 19.1\n488 11.45 20.6\n489 18.06 15.2\n490 23.97  7.0\n491 29.68  8.1\n492 18.07 13.6\n493 13.35 20.1\n494 12.01 21.8\n495 13.59 24.5\n496 17.60 23.1\n497 21.14 19.7\n498 14.10 18.3\n499 12.92 21.2\n500 15.10 17.5\n501 14.33 16.8\n502  9.67 22.4\n503  9.08 20.6\n504  5.64 23.9\n505  6.48 22.0\n506  7.88 11.9"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#回帰分析の練習-1",
    "href": "prezemi_2023_12_presen.html#回帰分析の練習-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析の練習",
    "text": "回帰分析の練習\n\n\n\ncrim : 犯罪率\nzn: 広い家の割合\nindus: 非小売業の割合\nchas: 川に近接(1:yes, 0:no)\nnox: 一酸化窒素濃度\nrm: 平均部屋数\nage: 古い家の割合\n\n\n\ndis: 主要施設への距離\nrad: 主要高速道路へのアクセス性\ntax: 固定資産税率\nptratio: 生徒先生の比率\nblack: 黒人の割合\nlstat: 低所得者割合\nmedv: 住宅価格"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#回帰分析の練習-2",
    "href": "prezemi_2023_12_presen.html#回帰分析の練習-2",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析の練習",
    "text": "回帰分析の練習\nこのデータを使って、回帰モデルを構築してみてください。 たとえば、\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_12_presen.html#説明変数がダミー変数のみの回帰",
    "href": "prezemi_2023_12_presen.html#説明変数がダミー変数のみの回帰",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "説明変数がダミー変数のみの回帰",
    "text": "説明変数がダミー変数のみの回帰\n例えば、単回帰分析の説明変数がダミー変数\\(D\\)である場合\n\\[\n\\begin{aligned}\nY = \\beta_0 + \\beta_1 D + \\varepsilon\n\\end{aligned}\n\\]\nこのとき、この単回帰モデルを次のように書くことが出来ます。\n\\[\n\\begin{aligned}\nY = \\begin{cases}\n\\beta_0 + \\varepsilon & \\text{if } D = 0 \\\\\n\\beta_0 + \\beta_1 + \\varepsilon & \\text{if } D = 1\n\\end{cases}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#説明変数がダミー変数のみの回帰-1",
    "href": "prezemi_2023_12_presen.html#説明変数がダミー変数のみの回帰-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "説明変数がダミー変数のみの回帰",
    "text": "説明変数がダミー変数のみの回帰\nこのとき、期待値\\(\\mathrm{E}[Y]\\)は次のようになります。\n\\[\n\\begin{aligned}\n\\mathrm{E}[Y] = \\begin{cases}\n\\beta_0  & \\text{if } D = 0 \\\\\n\\beta_0 + \\beta_1 & \\text{if } D = 1\n\\end{cases}\n\\end{aligned}\n\\]\nこの単回帰モデルの切片\\(\\beta_0\\)は、ダミー変数\\(D\\)が0のときの\\(Y\\)の平均値を表しています。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#会計研究のダミー変数の例",
    "href": "prezemi_2023_12_presen.html#会計研究のダミー変数の例",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "会計研究のダミー変数の例",
    "text": "会計研究のダミー変数の例\n経営の定量研究では，コントロール変数として頻出の\n\n企業ダミー\n業種ダミー\n年度ダミー\n\nに加えて，会計だと\n\n監査の質の代理変数となる四大監査法人ダミー\nIFRSダミー\n\nと広範囲で利用されている。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#ダミー変数の注意点",
    "href": "prezemi_2023_12_presen.html#ダミー変数の注意点",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\n回帰分析にダミー変数を使う場合に気をつける点として，\n\nカテゴリの数が\\(k\\)個のカテゴリー変数は，\\(k-1\\)個のダミー変数を回帰分析に組み込む\nダミー変数の数が多すぎると，推定値の標準誤差が大きくなる\n\nという2点があります。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#説明変数がダミー変数のみの回帰-2",
    "href": "prezemi_2023_12_presen.html#説明変数がダミー変数のみの回帰-2",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "説明変数がダミー変数のみの回帰",
    "text": "説明変数がダミー変数のみの回帰\n住宅価格と川に隣接しているかどうかのダミー変数を使って回帰分析\n\nres &lt;- lm(medv ~ chas, data = df)\ncoef(res)\n\n(Intercept)        chas \n  22.093843    6.346157 \n\n\n\n川に接してない家の平均価格は、22.0938429ドル\n川に接している家の平均価格は、28.44ドル\nchasの係数の\\(p\\)値は、0"
  },
  {
    "objectID": "prezemi_2023_webr.html#welcome",
    "href": "prezemi_2023_webr.html#welcome",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Welcome",
    "text": "Welcome\nWelcome to a demo RevealJS presentation that uses the quarto-webr extension to generate interactive code cells with Quarto and webR.\n\n\n\n\n\n\n重要\n\n\nThis template requires a pre-release version of Quarto that is 1.4.502 or greater that contains an updated copy of pandoc. For more details, please see Issue #14.\n\n\n\nNot the right template? Let’s go back to the documentation portal"
  },
  {
    "objectID": "prezemi_2023_webr.html#webr-in-revealjs",
    "href": "prezemi_2023_webr.html#webr-in-revealjs",
    "title": "プレゼミ2023  WebRの実験",
    "section": "webR in RevealJS",
    "text": "webR in RevealJS\nThis is a webR-enabled code cell in a Quarto RevealJS document.\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_webr.html#base-r-graphing-with-webr",
    "href": "prezemi_2023_webr.html#base-r-graphing-with-webr",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Base R Graphing with webR",
    "text": "Base R Graphing with webR\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_webr.html#ggplot2-in-webr",
    "href": "prezemi_2023_webr.html#ggplot2-in-webr",
    "title": "プレゼミ2023  WebRの実験",
    "section": "ggplot2 in webR",
    "text": "ggplot2 in webR\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_webr.html#help-documentation",
    "href": "prezemi_2023_webr.html#help-documentation",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Help Documentation",
    "text": "Help Documentation\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_webr.html#prints-warnings-and-errors",
    "href": "prezemi_2023_webr.html#prints-warnings-and-errors",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Prints, Warnings, and Errors",
    "text": "Prints, Warnings, and Errors\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_webr.html#keyboard-shortcuts",
    "href": "prezemi_2023_webr.html#keyboard-shortcuts",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Keyboard Shortcuts",
    "text": "Keyboard Shortcuts\n\nRun selected code using either:\n\nmacOS: ⌘ + ↩︎/Return\nWindows/Linux: Ctrl + ↩︎/Enter\n\nRun the entire code by clicking the “Run code” button or pressing Shift+↩︎.\n\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_webr.html#embedded-slides",
    "href": "prezemi_2023_webr.html#embedded-slides",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Embedded Slides",
    "text": "Embedded Slides\nYou can embed the slide deck inside of a Quarto Website or Book by using:\n&lt;style&gt;\n.slide-deck {\n    border: 3px solid #dee2e6;\n    width: 100%;\n    height: 475px;\n}\n&lt;/style&gt;\n\n&lt;div&gt;\n```{=html}\n&lt;iframe class=\"slide-deck\" src=\"path/to/presentation/\"&gt;&lt;/iframe&gt;\n```\n&lt;/div&gt;\n\n\n\n\n\n\nノート\n\n\nAvoid using within a RevealJS presentation. Only 1 instance of webR should be running."
  },
  {
    "objectID": "prezemi_2023_webr.html#fin",
    "href": "prezemi_2023_webr.html#fin",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Fin",
    "text": "Fin\nThanks for checking out the demo! Let’s head back to the documentation portal."
  },
  {
    "objectID": "prezemi_2023_webr.html#help-documentation-1",
    "href": "prezemi_2023_webr.html#help-documentation-1",
    "title": "プレゼミ2023  WebRの実験",
    "section": "Help Documentation",
    "text": "Help Documentation"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#準備",
    "href": "prezemi_2023_12_presen.html#準備",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "準備",
    "text": "準備\n\nknitr::opts_chunk$set(dev = \"ragg_png\")\nlibrary(tidyverse) # とりあえずこれ\nlibrary(ggthemes) # ggplot2のテーマ\nlibrary(knitr) # 作表\nlibrary(kableExtra) # 作表の拡張\nlibrary(scales) # 軸の単位を制御\nlibrary(modelsummary) # モデルのまとめ\ntheme_set(theme_few(base_size = 12))\nupdate_geom_defaults(\"point\", list(size = 3))"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#ダミー変数の注意点-1",
    "href": "prezemi_2023_12_presen.html#ダミー変数の注意点-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\nダミー変数が表すカテゴリーの数より1つ少ないダミー変数を使う。 カテゴリーが3つある場合は、2つのダミー変数を使う。 次のデータで確認してみる。\n\ndf &lt;- read_csv(\"data/RD_2022.csv\")\nnames(df)\n\n [1] \"会社コード\"                     \"企業名\"                        \n [3] \"決算期\"                         \"決算種別\"                      \n [5] \"連結基準\"                       \"決算月数\"                      \n [7] \"上場コード\"                     \"日経業種コード\"                \n [9] \"現金預金\"                       \"資産合計\"                      \n[11] \"資本金\"                         \"資本剰余金\"                    \n[13] \"利益剰余金\"                     \"自己株式\"                      \n[15] \"売上高\"                         \"経常利益\"                      \n[17] \"法人税等\"                       \"法人税等調整額\"                \n[19] \"親会社株主に帰属する当期純利益\" \"研究開発費IFRS\"                \n[21] \"研究開発費\"                     \"開発費・試験研究費\"            \n[23] \"現金及び現金同等物の期末残高\""
  },
  {
    "objectID": "prezemi_2023_12_presen.html#製造業ダミーの例",
    "href": "prezemi_2023_12_presen.html#製造業ダミーの例",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "製造業ダミーの例",
    "text": "製造業ダミーの例\n\nすべての企業が製造業か非製造業のどちらかに属する\n製造業に属するかどうかを表すダミー変数\\(mani\\)と，非製造業に属するかどうかを表すダミー変数\\(nomani\\)を作成\n製造業であれば\\(mani = 1\\)，非製造業であれば\\(mani = 0\\)という製造業ダミー変数と，\n非製造であれば\\(nomani = 1\\)，製造業であれば\\(nomani = 0\\)をとる非製造業ダミー変数を作る。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#多重共線性",
    "href": "prezemi_2023_12_presen.html#多重共線性",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "多重共線性",
    "text": "多重共線性\n\nここで，製造業ダミーが\\(1\\)の値をとるとき，非製造業ダミーは必ず\\(0\\)をとり，逆に非製造業ダミーが\\(1\\)の値を取るとき，製造業ダミーはかならず\\(0\\)の値を取ります。つまりこの2つのダミー変数は相関係数が\\(-1\\)となり，同じ情報をもっている変数となります。\nこのような完全な負の関係にある2つの変数を回帰分析に組み込むと，多重共線性が発生する。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#ダミー変数の注意点-2",
    "href": "prezemi_2023_12_presen.html#ダミー変数の注意点-2",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\nsubstr()関数を使って，日経業種コードの大分類を作成\n\ndf$dai &lt;- substr(df$日経業種コード,1,1) # 大分類\ntable(df$dai) # 大分類の頻度\n\n\n    1     2 \n27551 30272 \n\n\nこの大分類を用いてダミー変数を作ります。\n\ndf &lt;- df %&gt;%\n  mutate(\n    製造業ダミー = ifelse(dai == 1, 1, 0),\n    非製造業ダミー = ifelse(dai == 2, 1, 0)\n  )\ntable(df$製造業ダミー, df$非製造業ダミー)\n\n   \n        0     1\n  0     0 30272\n  1 27551     0"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#ダミー変数の注意点-3",
    "href": "prezemi_2023_12_presen.html#ダミー変数の注意点-3",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\n研究開発費が翌期の売上高に与える影響を分析する回帰式に，製造業ダミーと非製造業ダミーの2つのダミー変数を組み込んでみる。\n\nres &lt;- lm(売上高 ~ lag(研究開発費) + 製造業ダミー + 非製造業ダミー, data = df)\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + 製造業ダミー + \n    非製造業ダミー, data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-21499834   -118247    -57215    -10030  13666084 \n\nCoefficients: (1 not defined because of singularities)\n                  Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)      2.332e+05  5.790e+03   40.28   &lt;2e-16 ***\nlag(研究開発費)  1.945e+01  7.086e-02  274.45   &lt;2e-16 ***\n製造業ダミー    -1.643e+05  6.918e+03  -23.75   &lt;2e-16 ***\n非製造業ダミー          NA         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 597800 on 36278 degrees of freedom\n  ( 21542 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.6749,    Adjusted R-squared:  0.6749 \nF-statistic: 3.766e+04 on 2 and 36278 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#ダミー変数の注意点-4",
    "href": "prezemi_2023_12_presen.html#ダミー変数の注意点-4",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\n分析結果をみると，1 not defined because of singularitiesというメッセージがあり，非製造業ダミーがNAになっていることが分かる。Rが自動で変数を落としている。\nこんなことしなくても、Rはダミー変数となりうる変数を因子型にして回帰分析に組み込めば、勝手にダミー変数として適切に処理してくれる。\n\nres01 &lt;- lm(売上高 ~ lag(研究開発費) + 非製造業ダミー, data = df)\nres02 &lt;- lm(売上高 ~ lag(研究開発費) + factor(dai), data = df)\nresult &lt;- list(res01,res02)\nmodelsummary(result)"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#ダミー変数の注意点-4-output",
    "href": "prezemi_2023_12_presen.html#ダミー変数の注意点-4-output",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\n\n\n\n\n\n (1)\n  (2)\n\n\n\n\n(Intercept)\n68916.622\n68916.622\n\n\n\n(3817.175)\n(3817.175)\n\n\nlag(研究開発費)\n19.447\n19.447\n\n\n\n(0.071)\n(0.071)\n\n\n非製造業ダミー\n164270.989\n\n\n\n\n(6917.606)\n\n\n\nfactor(dai)2\n\n164270.989\n\n\n\n\n(6917.606)\n\n\nNum.Obs.\n36281\n36281\n\n\nR2\n0.675\n0.675\n\n\nR2 Adj.\n0.675\n0.675\n\n\nAIC\n1068119.6\n1068119.6\n\n\nBIC\n1068153.6\n1068153.6\n\n\nLog.Lik.\n-534055.790\n-534055.790\n\n\nRMSE\n597821.12\n597821.12"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#線形変換",
    "href": "prezemi_2023_12_presen.html#線形変換",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "線形変換",
    "text": "線形変換\n確率変数\\(X\\)がアフィン変換(affine transformation)をする場合を考える。\n\\[\n\\begin{aligned}\nY =  a + bX\n\\end{aligned}\n\\]\n\n確率変数\\(X\\)が確率変数\\(Y\\)に変換されたとする。\n\\(a\\)と\\(b\\)はパラメータです。\n\nこのとき，次の関係が成立します。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#線形変換の期待値と分散",
    "href": "prezemi_2023_12_presen.html#線形変換の期待値と分散",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "線形変換の期待値と分散",
    "text": "線形変換の期待値と分散\n期待値については，\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= \\mathbb{E}[a + bX] \\nonumber \\\\\n       &= \\mathbb{E}[a] + \\mathbb{E}[bX] \\nonumber\\\\\n       &= a + b \\mathbb{E}[X]\n\\end{aligned}\n\\] となり，分散については， \\[\n\\begin{aligned}\n\\mathbb{V}[Y]\n        &= \\mathbb{E}[(Y - \\mathbb{E}[Y])^2]      \\nonumber \\\\\n        &= \\mathbb{E}[(a + bX - (a+b\\mathbb{E}[X]))^2] \\nonumber\\\\\n        &= \\mathbb{E}[(bX - b \\mathbb{E}[X])^2]   \\nonumber\\\\\n        &= \\mathbb{E}[b^2 (X - \\mathbb{E}[X])^2]  \\nonumber\\\\\n        &= b^2 \\mathbb{E}[ (X - \\mathbb{E}[X])^2] \\nonumber\\\\\n        &= b^2 \\mathbb{V}[X]\n\\end{aligned}\n\\]\nとなる。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#標準偏差",
    "href": "prezemi_2023_12_presen.html#標準偏差",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "標準偏差",
    "text": "標準偏差\n標準偏差は，次の通り\n\\[\n\\begin{aligned}\n\\sigma _Y = \\sqrt{\\mathbb{V}[Y]} = |b| \\sqrt{\\mathbb{V}[X]}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#アフィン変換の例",
    "href": "prezemi_2023_12_presen.html#アフィン変換の例",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "アフィン変換の例",
    "text": "アフィン変換の例\nある工事が完了する日数とその確率が次のように予測されているとする。\n\n\n\n日数\\(X\\)\n1\n2\n3\n4\n5\n\n\n\n\n確率\\(p(x)\\)\n\\(5\\%\\)\n\\(20\\%\\)\n\\(35\\%\\)\n\\(30\\%\\)\n\\(10\\%\\)\n\n\n\nこのとき\n\\[\n\\begin{aligned}\n\\mathbb{E}[X] &\\equiv \\sum _k p_k x_k \\text{より} & \\mathbb{E}[X] &= 3.2\\\\\n\\mathbb{V} [X] &\\equiv \\sum _k p_k (x_k - \\mathbb{E}[X])^2 \\text{より} & \\mathbb{V} [X] &= 1.06\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#アフィン変換の例-1",
    "href": "prezemi_2023_12_presen.html#アフィン変換の例-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "アフィン変換の例",
    "text": "アフィン変換の例\nこの工事では，固定費として100万円，変動費として1日あたり10万円の費用がかかるとすると，総費用は，\n\\[\n\\begin{aligned}\nY = 100  + 10 X\n\\end{aligned}\n\\]\nとして表される。 このとき，総費用の期待値および分散は，\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= 100 + 10 \\mathbb{E}[X] = 100 + 10 \\times 3.2 = 132\\\\\n\\mathbb{V}[Y] &= 10^2 \\mathbb{V}[X] = 100  \\times 1.06 = 106\n\\end{aligned}\n\\]\nとなる。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#一般的な例",
    "href": "prezemi_2023_12_presen.html#一般的な例",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "一般的な例",
    "text": "一般的な例\nより一般的に，\\(k\\)個の確率変数\\(X_i\\), \\(i = 1, \\dots ,k\\)の一次結合\\(Y = c_0 + c_1 X_1 + \\cdots + c_k X_k\\)で表される確率変数\\(Y\\)において，次の関係が成立する。 ここで，\\(c_0,c_1, \\dots, c_k\\)はパラメータで，定数です。\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= c_0 + c_1 \\mu _1 + \\cdots c_k \\mu_k\\\\\n\\mathbb{V} [Y] &= c_1^2 \\sigma_1^2 + \\cdots +  c_k^2 \\sigma _k^2 + \\sum _{i\\not = j}^k \\sum_{j \\not = i}^k c_i c_j \\sigma _{ij}\n\\end{aligned}\n\\]\nここで，\\(\\mu _i = \\mathbb{E}[X_i]\\)，\\(\\sigma _i^2 = \\mathbb{V}[X_i]\\)，\\(\\sigma _{ij} = \\mathbb{COV}[X_i,X_j]\\)である。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#一般的な例k2のケース",
    "href": "prezemi_2023_12_presen.html#一般的な例k2のケース",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "一般的な例\\(k=2\\)のケース",
    "text": "一般的な例\\(k=2\\)のケース\n\\[\n\\begin{align}\n\\mathbb{E}[Y]   &= c_0 + c_1 \\mu _1 + c_2 \\mu_2\\\\\n\\mathbb{V} [Y] &= c_1^2 \\sigma_1^2 + c_2^2 \\sigma _2^2 + 2 c_1 c_2 \\sigma _{12}\n\\end{align}\n\\]"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#線形変換の期待値",
    "href": "prezemi_2023_12_presen.html#線形変換の期待値",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "線形変換の期待値",
    "text": "線形変換の期待値\n期待値については，\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= \\mathbb{E}[a + bX] \\nonumber \\\\\n       &= \\mathbb{E}[a] + \\mathbb{E}[bX] \\nonumber\\\\\n       &= a + b \\mathbb{E}[X]\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#線形変換の分散",
    "href": "prezemi_2023_12_presen.html#線形変換の分散",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "線形変換の分散",
    "text": "線形変換の分散\n分散については， \\[\n\\begin{aligned}\n\\mathbb{V}[Y]\n        &= \\mathbb{E}[(Y - \\mathbb{E}[Y])^2]      \\nonumber \\\\\n        &= \\mathbb{E}[(a + bX - (a+b\\mathbb{E}[X]))^2] \\nonumber\\\\\n        &= \\mathbb{E}[(bX - b \\mathbb{E}[X])^2]   \\nonumber\\\\\n        &= \\mathbb{E}[b^2 (X - \\mathbb{E}[X])^2]  \\nonumber\\\\\n        &= b^2 \\mathbb{E}[ (X - \\mathbb{E}[X])^2] \\nonumber\\\\\n        &= b^2 \\mathbb{V}[X]\n\\end{aligned}\n\\]\nとなる。"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#線形変換の標準偏差",
    "href": "prezemi_2023_12_presen.html#線形変換の標準偏差",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "線形変換の標準偏差",
    "text": "線形変換の標準偏差\n標準偏差は，次の通り\n\\[\n\\begin{aligned}\n\\sigma _Y = \\sqrt{\\mathbb{V}[Y]} = |b| \\sqrt{\\mathbb{V}[X]}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#例8",
    "href": "prezemi_2023_12_presen.html#例8",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "例8",
    "text": "例8\n\\(k=2\\)のケースで，\\(Y=0.5X_1 + 0.5 X_2\\)の期待値および分散を求めます。 ただし，\\(\\mu _1 = 0.07\\)，\\(\\sigma _1^2 = 1.48\\)，\\(\\mu_2 = -0.02\\)，\\(\\sigma _2^2 = 1.46\\)とします。\n\n無相関(\\(\\rho _{12} = 0\\), $[X_1,X_2] =0 $)のケース \\[\n\\begin{aligned}\n  \\mathbb{E}[Y]   &= 0.5 \\times 0.07 + 0.5 \\times - 0.02 = 0.025\\\\\n  \\mathbb{V} [Y] &= 0.5^2 \\times 1.48 + 0.5^2 \\times 1.46 + 2 \\times 0.5 \\times 0.5 \\times 0 = 0.735\n  \\end{aligned}\n\\]\n\\(Y\\)の分散は，\\(X_1\\)と\\(X_2\\)の分散よりも小さい。\n負の相関($_{12} = -0.99 [X_1,X_2] = -1.46 $)のケース \\[\n\\begin{aligned}\n  \\mathbb{E}[Y]   &= 0.5 \\times 0.07 + 0.5 \\times - 0.02 = 0.025\\\\\n  \\mathbb{V} [Y] &= 0.5^2 \\times 1.48 + 0.5^2 \\times 1.46 + 2 \\times 0.5 \\times 0.5 \\times -1.46 = 0.005\n  \\end{aligned}\n\\]\n\\(Y\\)の分散は，\\(X_1\\)と\\(X_2\\)の分散よりも小さい。\n\n\\(X_1\\)と\\(X_2\\)の共分散は，\\(Y\\)の分散に影響を与える。 :::\n中心化\n\n変数変換の一つである中心化(centering)\n説明変数からその平均値を引くことで平均値を0にする変換\n一次関数の平行移動に相当する線形変換の一種で，回帰式の切片の解釈を容易にするために利用される\n中心化や標準化を行うscale()関数が便利"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#中心化した回帰分析",
    "href": "prezemi_2023_12_presen.html#中心化した回帰分析",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化した回帰分析",
    "text": "中心化した回帰分析\n先の回帰分析では，次のようなモデルを推定\n\\[\n\\text{売上高} = \\alpha + \\beta_1 \\text{研究開発費} + \\beta_2 \\text{非製造業ダミー} + \\varepsilon\n\\]\nこの回帰式を推定すると，次のようになります。\n\nres01 &lt;- lm(売上高 ~ lag(研究開発費) + 非製造業ダミー , data = df)\ncoef(res01)\n\n    (Intercept) lag(研究開発費)  非製造業ダミー \n    68916.62208        19.44671    164270.98889"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#中心化した回帰",
    "href": "prezemi_2023_12_presen.html#中心化した回帰",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化した回帰",
    "text": "中心化した回帰\n\nこの回帰式の切片2.3318761^{5}の意味を考えてみる。\n切片は，研究開発費と製造業ダミーが0の場合の売上高の平均値を表す。\n研究開発費がゼロの企業というのはそれなりに存在しているので，教科書のように父親の身長がゼロのとき，といった非現実的な状況を表しているわけではないですが，非製造業企業だけの平均売上高だけでなく，全体の平均を表すために，変数を中心化(centering)"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#中心化",
    "href": "prezemi_2023_12_presen.html#中心化",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化",
    "text": "中心化\n\n変数変換の一つである中心化(centering)\n説明変数からその平均値を引くことで平均値を0にする変換\n一次関数の平行移動に相当する線形変換の一種で，回帰式の切片の解釈を容易にするために利用される\n中心化や標準化を行うscale()関数が便利"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#中心化した回帰-1",
    "href": "prezemi_2023_12_presen.html#中心化した回帰-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化した回帰",
    "text": "中心化した回帰\n標本平均を差し引くことで中心化を行う。 中心化は、scale()関数を使って行う。\n\ndf &lt;- df %&gt;%\n  mutate(\n    研究開発費中心化 = scale(研究開発費, center = TRUE, scale = FALSE),\n    売上高中心化 = scale(売上高, center = TRUE, scale = FALSE)\n  )\nres02 &lt;- lm(売上高中心化 ~ lag(研究開発費中心化) + 非製造業ダミー , data = df)\nres &lt;- list(res01,res02)\nmodelsummary(res)\n\n\n先の中心化前の回帰分析結果と比べて違っているのは，切片(intercept)の値だけ"
  },
  {
    "objectID": "prezemi_2023_12_presen.html#中心化した回帰-1-output",
    "href": "prezemi_2023_12_presen.html#中心化した回帰-1-output",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化した回帰",
    "text": "中心化した回帰\n\n\n\n\n\n (1)\n  (2)\n\n\n\n\n(Intercept)\n68916.622\n-4380.324\n\n\n\n(3817.175)\n(3740.372)\n\n\nlag(研究開発費)\n19.447\n\n\n\n\n(0.071)\n\n\n\n非製造業ダミー\n164270.989\n164270.989\n\n\n\n(6917.606)\n(6917.606)\n\n\nlag(研究開発費中心化)\n\n19.447\n\n\n\n\n(0.071)\n\n\nNum.Obs.\n36281\n36281\n\n\nR2\n0.675\n0.675\n\n\nR2 Adj.\n0.675\n0.675\n\n\nAIC\n1068119.6\n1068119.6\n\n\nBIC\n1068153.6\n1068153.6\n\n\nLog.Lik.\n-534055.790\n-534055.790\n\n\nRMSE\n597821.12\n597821.12"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#回帰分析とは",
    "href": "prezemi_2023_11_presen.html#回帰分析とは",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析とは",
    "text": "回帰分析とは\n\n1つ以上の説明変数と1つの応答変数との間の因果関係を調べるための統計的手法\nここでは、説明変数\\(X\\)と応答変数\\(Y\\)との間に線形関係を仮定する線形回帰モデルを考える。\n\n\\[\nY = \\alpha + \\sum _{i=1}^k \\beta _i X_i + \\varepsilon\n\\]\n\n回帰パラメータ\\(\\alpha\\)と\\(\\beta\\)を推定する方法として最小二乗法を用いる。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#最小二乗法",
    "href": "prezemi_2023_11_presen.html#最小二乗法",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "最小二乗法",
    "text": "最小二乗法\n\n今手元に説明変数\\(X\\)と応答変数\\(Y\\)のデータの組\\((x_i,y_i)\\)があるとする。\nこのデータから回帰パラメータを推定する最小二乗法は、残差平方和を最小にするような回帰パラメータを求める方法である。\n\n\\[\n\\begin{aligned}\n\\min _{\\hat{\\alpha}, \\hat{\\beta}} \\sum _{i=1}^n (y_i - \\alpha - \\sum _{j=1}^k \\beta _j x_{ij})^2\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#回帰分析の実装",
    "href": "prezemi_2023_11_presen.html#回帰分析の実装",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析の実装",
    "text": "回帰分析の実装\nRではlm()関数を使って最小二乗法による回帰分析を行う。 lm()の主要な引数は，formulaとdataの2つ\n\nformula ： 回帰式を表す式で，Y ~ Xのように書く。\ndata ： 回帰分析に用いるデータフレーム\n\n\nres &lt;- lm(Y ~ X, data = df)"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#回帰分析の練習",
    "href": "prezemi_2023_11_presen.html#回帰分析の練習",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析の練習",
    "text": "回帰分析の練習\nボストン住宅価格データを使って回帰分析を実行\n\nlibrary(MASS) # データを取得\ndf &lt;- Boston\ndf\n\n        crim    zn indus chas    nox    rm   age     dis rad tax ptratio  black\n1    0.00632  18.0  2.31    0 0.5380 6.575  65.2  4.0900   1 296    15.3 396.90\n2    0.02731   0.0  7.07    0 0.4690 6.421  78.9  4.9671   2 242    17.8 396.90\n3    0.02729   0.0  7.07    0 0.4690 7.185  61.1  4.9671   2 242    17.8 392.83\n4    0.03237   0.0  2.18    0 0.4580 6.998  45.8  6.0622   3 222    18.7 394.63\n5    0.06905   0.0  2.18    0 0.4580 7.147  54.2  6.0622   3 222    18.7 396.90\n6    0.02985   0.0  2.18    0 0.4580 6.430  58.7  6.0622   3 222    18.7 394.12\n7    0.08829  12.5  7.87    0 0.5240 6.012  66.6  5.5605   5 311    15.2 395.60\n8    0.14455  12.5  7.87    0 0.5240 6.172  96.1  5.9505   5 311    15.2 396.90\n9    0.21124  12.5  7.87    0 0.5240 5.631 100.0  6.0821   5 311    15.2 386.63\n10   0.17004  12.5  7.87    0 0.5240 6.004  85.9  6.5921   5 311    15.2 386.71\n11   0.22489  12.5  7.87    0 0.5240 6.377  94.3  6.3467   5 311    15.2 392.52\n12   0.11747  12.5  7.87    0 0.5240 6.009  82.9  6.2267   5 311    15.2 396.90\n13   0.09378  12.5  7.87    0 0.5240 5.889  39.0  5.4509   5 311    15.2 390.50\n14   0.62976   0.0  8.14    0 0.5380 5.949  61.8  4.7075   4 307    21.0 396.90\n15   0.63796   0.0  8.14    0 0.5380 6.096  84.5  4.4619   4 307    21.0 380.02\n16   0.62739   0.0  8.14    0 0.5380 5.834  56.5  4.4986   4 307    21.0 395.62\n17   1.05393   0.0  8.14    0 0.5380 5.935  29.3  4.4986   4 307    21.0 386.85\n18   0.78420   0.0  8.14    0 0.5380 5.990  81.7  4.2579   4 307    21.0 386.75\n19   0.80271   0.0  8.14    0 0.5380 5.456  36.6  3.7965   4 307    21.0 288.99\n20   0.72580   0.0  8.14    0 0.5380 5.727  69.5  3.7965   4 307    21.0 390.95\n21   1.25179   0.0  8.14    0 0.5380 5.570  98.1  3.7979   4 307    21.0 376.57\n22   0.85204   0.0  8.14    0 0.5380 5.965  89.2  4.0123   4 307    21.0 392.53\n23   1.23247   0.0  8.14    0 0.5380 6.142  91.7  3.9769   4 307    21.0 396.90\n24   0.98843   0.0  8.14    0 0.5380 5.813 100.0  4.0952   4 307    21.0 394.54\n25   0.75026   0.0  8.14    0 0.5380 5.924  94.1  4.3996   4 307    21.0 394.33\n26   0.84054   0.0  8.14    0 0.5380 5.599  85.7  4.4546   4 307    21.0 303.42\n27   0.67191   0.0  8.14    0 0.5380 5.813  90.3  4.6820   4 307    21.0 376.88\n28   0.95577   0.0  8.14    0 0.5380 6.047  88.8  4.4534   4 307    21.0 306.38\n29   0.77299   0.0  8.14    0 0.5380 6.495  94.4  4.4547   4 307    21.0 387.94\n30   1.00245   0.0  8.14    0 0.5380 6.674  87.3  4.2390   4 307    21.0 380.23\n31   1.13081   0.0  8.14    0 0.5380 5.713  94.1  4.2330   4 307    21.0 360.17\n32   1.35472   0.0  8.14    0 0.5380 6.072 100.0  4.1750   4 307    21.0 376.73\n33   1.38799   0.0  8.14    0 0.5380 5.950  82.0  3.9900   4 307    21.0 232.60\n34   1.15172   0.0  8.14    0 0.5380 5.701  95.0  3.7872   4 307    21.0 358.77\n35   1.61282   0.0  8.14    0 0.5380 6.096  96.9  3.7598   4 307    21.0 248.31\n36   0.06417   0.0  5.96    0 0.4990 5.933  68.2  3.3603   5 279    19.2 396.90\n37   0.09744   0.0  5.96    0 0.4990 5.841  61.4  3.3779   5 279    19.2 377.56\n38   0.08014   0.0  5.96    0 0.4990 5.850  41.5  3.9342   5 279    19.2 396.90\n39   0.17505   0.0  5.96    0 0.4990 5.966  30.2  3.8473   5 279    19.2 393.43\n40   0.02763  75.0  2.95    0 0.4280 6.595  21.8  5.4011   3 252    18.3 395.63\n41   0.03359  75.0  2.95    0 0.4280 7.024  15.8  5.4011   3 252    18.3 395.62\n42   0.12744   0.0  6.91    0 0.4480 6.770   2.9  5.7209   3 233    17.9 385.41\n43   0.14150   0.0  6.91    0 0.4480 6.169   6.6  5.7209   3 233    17.9 383.37\n44   0.15936   0.0  6.91    0 0.4480 6.211   6.5  5.7209   3 233    17.9 394.46\n45   0.12269   0.0  6.91    0 0.4480 6.069  40.0  5.7209   3 233    17.9 389.39\n46   0.17142   0.0  6.91    0 0.4480 5.682  33.8  5.1004   3 233    17.9 396.90\n47   0.18836   0.0  6.91    0 0.4480 5.786  33.3  5.1004   3 233    17.9 396.90\n48   0.22927   0.0  6.91    0 0.4480 6.030  85.5  5.6894   3 233    17.9 392.74\n49   0.25387   0.0  6.91    0 0.4480 5.399  95.3  5.8700   3 233    17.9 396.90\n50   0.21977   0.0  6.91    0 0.4480 5.602  62.0  6.0877   3 233    17.9 396.90\n51   0.08873  21.0  5.64    0 0.4390 5.963  45.7  6.8147   4 243    16.8 395.56\n52   0.04337  21.0  5.64    0 0.4390 6.115  63.0  6.8147   4 243    16.8 393.97\n53   0.05360  21.0  5.64    0 0.4390 6.511  21.1  6.8147   4 243    16.8 396.90\n54   0.04981  21.0  5.64    0 0.4390 5.998  21.4  6.8147   4 243    16.8 396.90\n55   0.01360  75.0  4.00    0 0.4100 5.888  47.6  7.3197   3 469    21.1 396.90\n56   0.01311  90.0  1.22    0 0.4030 7.249  21.9  8.6966   5 226    17.9 395.93\n57   0.02055  85.0  0.74    0 0.4100 6.383  35.7  9.1876   2 313    17.3 396.90\n58   0.01432 100.0  1.32    0 0.4110 6.816  40.5  8.3248   5 256    15.1 392.90\n59   0.15445  25.0  5.13    0 0.4530 6.145  29.2  7.8148   8 284    19.7 390.68\n60   0.10328  25.0  5.13    0 0.4530 5.927  47.2  6.9320   8 284    19.7 396.90\n61   0.14932  25.0  5.13    0 0.4530 5.741  66.2  7.2254   8 284    19.7 395.11\n62   0.17171  25.0  5.13    0 0.4530 5.966  93.4  6.8185   8 284    19.7 378.08\n63   0.11027  25.0  5.13    0 0.4530 6.456  67.8  7.2255   8 284    19.7 396.90\n64   0.12650  25.0  5.13    0 0.4530 6.762  43.4  7.9809   8 284    19.7 395.58\n65   0.01951  17.5  1.38    0 0.4161 7.104  59.5  9.2229   3 216    18.6 393.24\n66   0.03584  80.0  3.37    0 0.3980 6.290  17.8  6.6115   4 337    16.1 396.90\n67   0.04379  80.0  3.37    0 0.3980 5.787  31.1  6.6115   4 337    16.1 396.90\n68   0.05789  12.5  6.07    0 0.4090 5.878  21.4  6.4980   4 345    18.9 396.21\n69   0.13554  12.5  6.07    0 0.4090 5.594  36.8  6.4980   4 345    18.9 396.90\n70   0.12816  12.5  6.07    0 0.4090 5.885  33.0  6.4980   4 345    18.9 396.90\n71   0.08826   0.0 10.81    0 0.4130 6.417   6.6  5.2873   4 305    19.2 383.73\n72   0.15876   0.0 10.81    0 0.4130 5.961  17.5  5.2873   4 305    19.2 376.94\n73   0.09164   0.0 10.81    0 0.4130 6.065   7.8  5.2873   4 305    19.2 390.91\n74   0.19539   0.0 10.81    0 0.4130 6.245   6.2  5.2873   4 305    19.2 377.17\n75   0.07896   0.0 12.83    0 0.4370 6.273   6.0  4.2515   5 398    18.7 394.92\n76   0.09512   0.0 12.83    0 0.4370 6.286  45.0  4.5026   5 398    18.7 383.23\n77   0.10153   0.0 12.83    0 0.4370 6.279  74.5  4.0522   5 398    18.7 373.66\n78   0.08707   0.0 12.83    0 0.4370 6.140  45.8  4.0905   5 398    18.7 386.96\n79   0.05646   0.0 12.83    0 0.4370 6.232  53.7  5.0141   5 398    18.7 386.40\n80   0.08387   0.0 12.83    0 0.4370 5.874  36.6  4.5026   5 398    18.7 396.06\n81   0.04113  25.0  4.86    0 0.4260 6.727  33.5  5.4007   4 281    19.0 396.90\n82   0.04462  25.0  4.86    0 0.4260 6.619  70.4  5.4007   4 281    19.0 395.63\n83   0.03659  25.0  4.86    0 0.4260 6.302  32.2  5.4007   4 281    19.0 396.90\n84   0.03551  25.0  4.86    0 0.4260 6.167  46.7  5.4007   4 281    19.0 390.64\n85   0.05059   0.0  4.49    0 0.4490 6.389  48.0  4.7794   3 247    18.5 396.90\n86   0.05735   0.0  4.49    0 0.4490 6.630  56.1  4.4377   3 247    18.5 392.30\n87   0.05188   0.0  4.49    0 0.4490 6.015  45.1  4.4272   3 247    18.5 395.99\n88   0.07151   0.0  4.49    0 0.4490 6.121  56.8  3.7476   3 247    18.5 395.15\n89   0.05660   0.0  3.41    0 0.4890 7.007  86.3  3.4217   2 270    17.8 396.90\n90   0.05302   0.0  3.41    0 0.4890 7.079  63.1  3.4145   2 270    17.8 396.06\n91   0.04684   0.0  3.41    0 0.4890 6.417  66.1  3.0923   2 270    17.8 392.18\n92   0.03932   0.0  3.41    0 0.4890 6.405  73.9  3.0921   2 270    17.8 393.55\n93   0.04203  28.0 15.04    0 0.4640 6.442  53.6  3.6659   4 270    18.2 395.01\n94   0.02875  28.0 15.04    0 0.4640 6.211  28.9  3.6659   4 270    18.2 396.33\n95   0.04294  28.0 15.04    0 0.4640 6.249  77.3  3.6150   4 270    18.2 396.90\n96   0.12204   0.0  2.89    0 0.4450 6.625  57.8  3.4952   2 276    18.0 357.98\n97   0.11504   0.0  2.89    0 0.4450 6.163  69.6  3.4952   2 276    18.0 391.83\n98   0.12083   0.0  2.89    0 0.4450 8.069  76.0  3.4952   2 276    18.0 396.90\n99   0.08187   0.0  2.89    0 0.4450 7.820  36.9  3.4952   2 276    18.0 393.53\n100  0.06860   0.0  2.89    0 0.4450 7.416  62.5  3.4952   2 276    18.0 396.90\n101  0.14866   0.0  8.56    0 0.5200 6.727  79.9  2.7778   5 384    20.9 394.76\n102  0.11432   0.0  8.56    0 0.5200 6.781  71.3  2.8561   5 384    20.9 395.58\n103  0.22876   0.0  8.56    0 0.5200 6.405  85.4  2.7147   5 384    20.9  70.80\n104  0.21161   0.0  8.56    0 0.5200 6.137  87.4  2.7147   5 384    20.9 394.47\n105  0.13960   0.0  8.56    0 0.5200 6.167  90.0  2.4210   5 384    20.9 392.69\n106  0.13262   0.0  8.56    0 0.5200 5.851  96.7  2.1069   5 384    20.9 394.05\n107  0.17120   0.0  8.56    0 0.5200 5.836  91.9  2.2110   5 384    20.9 395.67\n108  0.13117   0.0  8.56    0 0.5200 6.127  85.2  2.1224   5 384    20.9 387.69\n109  0.12802   0.0  8.56    0 0.5200 6.474  97.1  2.4329   5 384    20.9 395.24\n110  0.26363   0.0  8.56    0 0.5200 6.229  91.2  2.5451   5 384    20.9 391.23\n111  0.10793   0.0  8.56    0 0.5200 6.195  54.4  2.7778   5 384    20.9 393.49\n112  0.10084   0.0 10.01    0 0.5470 6.715  81.6  2.6775   6 432    17.8 395.59\n113  0.12329   0.0 10.01    0 0.5470 5.913  92.9  2.3534   6 432    17.8 394.95\n114  0.22212   0.0 10.01    0 0.5470 6.092  95.4  2.5480   6 432    17.8 396.90\n115  0.14231   0.0 10.01    0 0.5470 6.254  84.2  2.2565   6 432    17.8 388.74\n116  0.17134   0.0 10.01    0 0.5470 5.928  88.2  2.4631   6 432    17.8 344.91\n117  0.13158   0.0 10.01    0 0.5470 6.176  72.5  2.7301   6 432    17.8 393.30\n118  0.15098   0.0 10.01    0 0.5470 6.021  82.6  2.7474   6 432    17.8 394.51\n119  0.13058   0.0 10.01    0 0.5470 5.872  73.1  2.4775   6 432    17.8 338.63\n120  0.14476   0.0 10.01    0 0.5470 5.731  65.2  2.7592   6 432    17.8 391.50\n121  0.06899   0.0 25.65    0 0.5810 5.870  69.7  2.2577   2 188    19.1 389.15\n122  0.07165   0.0 25.65    0 0.5810 6.004  84.1  2.1974   2 188    19.1 377.67\n123  0.09299   0.0 25.65    0 0.5810 5.961  92.9  2.0869   2 188    19.1 378.09\n124  0.15038   0.0 25.65    0 0.5810 5.856  97.0  1.9444   2 188    19.1 370.31\n125  0.09849   0.0 25.65    0 0.5810 5.879  95.8  2.0063   2 188    19.1 379.38\n126  0.16902   0.0 25.65    0 0.5810 5.986  88.4  1.9929   2 188    19.1 385.02\n127  0.38735   0.0 25.65    0 0.5810 5.613  95.6  1.7572   2 188    19.1 359.29\n128  0.25915   0.0 21.89    0 0.6240 5.693  96.0  1.7883   4 437    21.2 392.11\n129  0.32543   0.0 21.89    0 0.6240 6.431  98.8  1.8125   4 437    21.2 396.90\n130  0.88125   0.0 21.89    0 0.6240 5.637  94.7  1.9799   4 437    21.2 396.90\n131  0.34006   0.0 21.89    0 0.6240 6.458  98.9  2.1185   4 437    21.2 395.04\n132  1.19294   0.0 21.89    0 0.6240 6.326  97.7  2.2710   4 437    21.2 396.90\n133  0.59005   0.0 21.89    0 0.6240 6.372  97.9  2.3274   4 437    21.2 385.76\n134  0.32982   0.0 21.89    0 0.6240 5.822  95.4  2.4699   4 437    21.2 388.69\n135  0.97617   0.0 21.89    0 0.6240 5.757  98.4  2.3460   4 437    21.2 262.76\n136  0.55778   0.0 21.89    0 0.6240 6.335  98.2  2.1107   4 437    21.2 394.67\n137  0.32264   0.0 21.89    0 0.6240 5.942  93.5  1.9669   4 437    21.2 378.25\n138  0.35233   0.0 21.89    0 0.6240 6.454  98.4  1.8498   4 437    21.2 394.08\n139  0.24980   0.0 21.89    0 0.6240 5.857  98.2  1.6686   4 437    21.2 392.04\n140  0.54452   0.0 21.89    0 0.6240 6.151  97.9  1.6687   4 437    21.2 396.90\n141  0.29090   0.0 21.89    0 0.6240 6.174  93.6  1.6119   4 437    21.2 388.08\n142  1.62864   0.0 21.89    0 0.6240 5.019 100.0  1.4394   4 437    21.2 396.90\n143  3.32105   0.0 19.58    1 0.8710 5.403 100.0  1.3216   5 403    14.7 396.90\n144  4.09740   0.0 19.58    0 0.8710 5.468 100.0  1.4118   5 403    14.7 396.90\n145  2.77974   0.0 19.58    0 0.8710 4.903  97.8  1.3459   5 403    14.7 396.90\n146  2.37934   0.0 19.58    0 0.8710 6.130 100.0  1.4191   5 403    14.7 172.91\n147  2.15505   0.0 19.58    0 0.8710 5.628 100.0  1.5166   5 403    14.7 169.27\n148  2.36862   0.0 19.58    0 0.8710 4.926  95.7  1.4608   5 403    14.7 391.71\n149  2.33099   0.0 19.58    0 0.8710 5.186  93.8  1.5296   5 403    14.7 356.99\n150  2.73397   0.0 19.58    0 0.8710 5.597  94.9  1.5257   5 403    14.7 351.85\n151  1.65660   0.0 19.58    0 0.8710 6.122  97.3  1.6180   5 403    14.7 372.80\n152  1.49632   0.0 19.58    0 0.8710 5.404 100.0  1.5916   5 403    14.7 341.60\n153  1.12658   0.0 19.58    1 0.8710 5.012  88.0  1.6102   5 403    14.7 343.28\n154  2.14918   0.0 19.58    0 0.8710 5.709  98.5  1.6232   5 403    14.7 261.95\n155  1.41385   0.0 19.58    1 0.8710 6.129  96.0  1.7494   5 403    14.7 321.02\n156  3.53501   0.0 19.58    1 0.8710 6.152  82.6  1.7455   5 403    14.7  88.01\n157  2.44668   0.0 19.58    0 0.8710 5.272  94.0  1.7364   5 403    14.7  88.63\n158  1.22358   0.0 19.58    0 0.6050 6.943  97.4  1.8773   5 403    14.7 363.43\n159  1.34284   0.0 19.58    0 0.6050 6.066 100.0  1.7573   5 403    14.7 353.89\n160  1.42502   0.0 19.58    0 0.8710 6.510 100.0  1.7659   5 403    14.7 364.31\n161  1.27346   0.0 19.58    1 0.6050 6.250  92.6  1.7984   5 403    14.7 338.92\n162  1.46336   0.0 19.58    0 0.6050 7.489  90.8  1.9709   5 403    14.7 374.43\n163  1.83377   0.0 19.58    1 0.6050 7.802  98.2  2.0407   5 403    14.7 389.61\n164  1.51902   0.0 19.58    1 0.6050 8.375  93.9  2.1620   5 403    14.7 388.45\n165  2.24236   0.0 19.58    0 0.6050 5.854  91.8  2.4220   5 403    14.7 395.11\n166  2.92400   0.0 19.58    0 0.6050 6.101  93.0  2.2834   5 403    14.7 240.16\n167  2.01019   0.0 19.58    0 0.6050 7.929  96.2  2.0459   5 403    14.7 369.30\n168  1.80028   0.0 19.58    0 0.6050 5.877  79.2  2.4259   5 403    14.7 227.61\n169  2.30040   0.0 19.58    0 0.6050 6.319  96.1  2.1000   5 403    14.7 297.09\n170  2.44953   0.0 19.58    0 0.6050 6.402  95.2  2.2625   5 403    14.7 330.04\n171  1.20742   0.0 19.58    0 0.6050 5.875  94.6  2.4259   5 403    14.7 292.29\n172  2.31390   0.0 19.58    0 0.6050 5.880  97.3  2.3887   5 403    14.7 348.13\n173  0.13914   0.0  4.05    0 0.5100 5.572  88.5  2.5961   5 296    16.6 396.90\n174  0.09178   0.0  4.05    0 0.5100 6.416  84.1  2.6463   5 296    16.6 395.50\n175  0.08447   0.0  4.05    0 0.5100 5.859  68.7  2.7019   5 296    16.6 393.23\n176  0.06664   0.0  4.05    0 0.5100 6.546  33.1  3.1323   5 296    16.6 390.96\n177  0.07022   0.0  4.05    0 0.5100 6.020  47.2  3.5549   5 296    16.6 393.23\n178  0.05425   0.0  4.05    0 0.5100 6.315  73.4  3.3175   5 296    16.6 395.60\n179  0.06642   0.0  4.05    0 0.5100 6.860  74.4  2.9153   5 296    16.6 391.27\n180  0.05780   0.0  2.46    0 0.4880 6.980  58.4  2.8290   3 193    17.8 396.90\n181  0.06588   0.0  2.46    0 0.4880 7.765  83.3  2.7410   3 193    17.8 395.56\n182  0.06888   0.0  2.46    0 0.4880 6.144  62.2  2.5979   3 193    17.8 396.90\n183  0.09103   0.0  2.46    0 0.4880 7.155  92.2  2.7006   3 193    17.8 394.12\n184  0.10008   0.0  2.46    0 0.4880 6.563  95.6  2.8470   3 193    17.8 396.90\n185  0.08308   0.0  2.46    0 0.4880 5.604  89.8  2.9879   3 193    17.8 391.00\n186  0.06047   0.0  2.46    0 0.4880 6.153  68.8  3.2797   3 193    17.8 387.11\n187  0.05602   0.0  2.46    0 0.4880 7.831  53.6  3.1992   3 193    17.8 392.63\n188  0.07875  45.0  3.44    0 0.4370 6.782  41.1  3.7886   5 398    15.2 393.87\n189  0.12579  45.0  3.44    0 0.4370 6.556  29.1  4.5667   5 398    15.2 382.84\n190  0.08370  45.0  3.44    0 0.4370 7.185  38.9  4.5667   5 398    15.2 396.90\n191  0.09068  45.0  3.44    0 0.4370 6.951  21.5  6.4798   5 398    15.2 377.68\n192  0.06911  45.0  3.44    0 0.4370 6.739  30.8  6.4798   5 398    15.2 389.71\n193  0.08664  45.0  3.44    0 0.4370 7.178  26.3  6.4798   5 398    15.2 390.49\n194  0.02187  60.0  2.93    0 0.4010 6.800   9.9  6.2196   1 265    15.6 393.37\n195  0.01439  60.0  2.93    0 0.4010 6.604  18.8  6.2196   1 265    15.6 376.70\n196  0.01381  80.0  0.46    0 0.4220 7.875  32.0  5.6484   4 255    14.4 394.23\n197  0.04011  80.0  1.52    0 0.4040 7.287  34.1  7.3090   2 329    12.6 396.90\n198  0.04666  80.0  1.52    0 0.4040 7.107  36.6  7.3090   2 329    12.6 354.31\n199  0.03768  80.0  1.52    0 0.4040 7.274  38.3  7.3090   2 329    12.6 392.20\n200  0.03150  95.0  1.47    0 0.4030 6.975  15.3  7.6534   3 402    17.0 396.90\n201  0.01778  95.0  1.47    0 0.4030 7.135  13.9  7.6534   3 402    17.0 384.30\n202  0.03445  82.5  2.03    0 0.4150 6.162  38.4  6.2700   2 348    14.7 393.77\n203  0.02177  82.5  2.03    0 0.4150 7.610  15.7  6.2700   2 348    14.7 395.38\n204  0.03510  95.0  2.68    0 0.4161 7.853  33.2  5.1180   4 224    14.7 392.78\n205  0.02009  95.0  2.68    0 0.4161 8.034  31.9  5.1180   4 224    14.7 390.55\n206  0.13642   0.0 10.59    0 0.4890 5.891  22.3  3.9454   4 277    18.6 396.90\n207  0.22969   0.0 10.59    0 0.4890 6.326  52.5  4.3549   4 277    18.6 394.87\n208  0.25199   0.0 10.59    0 0.4890 5.783  72.7  4.3549   4 277    18.6 389.43\n209  0.13587   0.0 10.59    1 0.4890 6.064  59.1  4.2392   4 277    18.6 381.32\n210  0.43571   0.0 10.59    1 0.4890 5.344 100.0  3.8750   4 277    18.6 396.90\n211  0.17446   0.0 10.59    1 0.4890 5.960  92.1  3.8771   4 277    18.6 393.25\n212  0.37578   0.0 10.59    1 0.4890 5.404  88.6  3.6650   4 277    18.6 395.24\n213  0.21719   0.0 10.59    1 0.4890 5.807  53.8  3.6526   4 277    18.6 390.94\n214  0.14052   0.0 10.59    0 0.4890 6.375  32.3  3.9454   4 277    18.6 385.81\n215  0.28955   0.0 10.59    0 0.4890 5.412   9.8  3.5875   4 277    18.6 348.93\n216  0.19802   0.0 10.59    0 0.4890 6.182  42.4  3.9454   4 277    18.6 393.63\n217  0.04560   0.0 13.89    1 0.5500 5.888  56.0  3.1121   5 276    16.4 392.80\n218  0.07013   0.0 13.89    0 0.5500 6.642  85.1  3.4211   5 276    16.4 392.78\n219  0.11069   0.0 13.89    1 0.5500 5.951  93.8  2.8893   5 276    16.4 396.90\n220  0.11425   0.0 13.89    1 0.5500 6.373  92.4  3.3633   5 276    16.4 393.74\n221  0.35809   0.0  6.20    1 0.5070 6.951  88.5  2.8617   8 307    17.4 391.70\n222  0.40771   0.0  6.20    1 0.5070 6.164  91.3  3.0480   8 307    17.4 395.24\n223  0.62356   0.0  6.20    1 0.5070 6.879  77.7  3.2721   8 307    17.4 390.39\n224  0.61470   0.0  6.20    0 0.5070 6.618  80.8  3.2721   8 307    17.4 396.90\n225  0.31533   0.0  6.20    0 0.5040 8.266  78.3  2.8944   8 307    17.4 385.05\n226  0.52693   0.0  6.20    0 0.5040 8.725  83.0  2.8944   8 307    17.4 382.00\n227  0.38214   0.0  6.20    0 0.5040 8.040  86.5  3.2157   8 307    17.4 387.38\n228  0.41238   0.0  6.20    0 0.5040 7.163  79.9  3.2157   8 307    17.4 372.08\n229  0.29819   0.0  6.20    0 0.5040 7.686  17.0  3.3751   8 307    17.4 377.51\n230  0.44178   0.0  6.20    0 0.5040 6.552  21.4  3.3751   8 307    17.4 380.34\n231  0.53700   0.0  6.20    0 0.5040 5.981  68.1  3.6715   8 307    17.4 378.35\n232  0.46296   0.0  6.20    0 0.5040 7.412  76.9  3.6715   8 307    17.4 376.14\n233  0.57529   0.0  6.20    0 0.5070 8.337  73.3  3.8384   8 307    17.4 385.91\n234  0.33147   0.0  6.20    0 0.5070 8.247  70.4  3.6519   8 307    17.4 378.95\n235  0.44791   0.0  6.20    1 0.5070 6.726  66.5  3.6519   8 307    17.4 360.20\n236  0.33045   0.0  6.20    0 0.5070 6.086  61.5  3.6519   8 307    17.4 376.75\n237  0.52058   0.0  6.20    1 0.5070 6.631  76.5  4.1480   8 307    17.4 388.45\n238  0.51183   0.0  6.20    0 0.5070 7.358  71.6  4.1480   8 307    17.4 390.07\n239  0.08244  30.0  4.93    0 0.4280 6.481  18.5  6.1899   6 300    16.6 379.41\n240  0.09252  30.0  4.93    0 0.4280 6.606  42.2  6.1899   6 300    16.6 383.78\n241  0.11329  30.0  4.93    0 0.4280 6.897  54.3  6.3361   6 300    16.6 391.25\n242  0.10612  30.0  4.93    0 0.4280 6.095  65.1  6.3361   6 300    16.6 394.62\n243  0.10290  30.0  4.93    0 0.4280 6.358  52.9  7.0355   6 300    16.6 372.75\n244  0.12757  30.0  4.93    0 0.4280 6.393   7.8  7.0355   6 300    16.6 374.71\n245  0.20608  22.0  5.86    0 0.4310 5.593  76.5  7.9549   7 330    19.1 372.49\n246  0.19133  22.0  5.86    0 0.4310 5.605  70.2  7.9549   7 330    19.1 389.13\n247  0.33983  22.0  5.86    0 0.4310 6.108  34.9  8.0555   7 330    19.1 390.18\n248  0.19657  22.0  5.86    0 0.4310 6.226  79.2  8.0555   7 330    19.1 376.14\n249  0.16439  22.0  5.86    0 0.4310 6.433  49.1  7.8265   7 330    19.1 374.71\n250  0.19073  22.0  5.86    0 0.4310 6.718  17.5  7.8265   7 330    19.1 393.74\n251  0.14030  22.0  5.86    0 0.4310 6.487  13.0  7.3967   7 330    19.1 396.28\n252  0.21409  22.0  5.86    0 0.4310 6.438   8.9  7.3967   7 330    19.1 377.07\n253  0.08221  22.0  5.86    0 0.4310 6.957   6.8  8.9067   7 330    19.1 386.09\n254  0.36894  22.0  5.86    0 0.4310 8.259   8.4  8.9067   7 330    19.1 396.90\n255  0.04819  80.0  3.64    0 0.3920 6.108  32.0  9.2203   1 315    16.4 392.89\n256  0.03548  80.0  3.64    0 0.3920 5.876  19.1  9.2203   1 315    16.4 395.18\n257  0.01538  90.0  3.75    0 0.3940 7.454  34.2  6.3361   3 244    15.9 386.34\n258  0.61154  20.0  3.97    0 0.6470 8.704  86.9  1.8010   5 264    13.0 389.70\n259  0.66351  20.0  3.97    0 0.6470 7.333 100.0  1.8946   5 264    13.0 383.29\n260  0.65665  20.0  3.97    0 0.6470 6.842 100.0  2.0107   5 264    13.0 391.93\n261  0.54011  20.0  3.97    0 0.6470 7.203  81.8  2.1121   5 264    13.0 392.80\n262  0.53412  20.0  3.97    0 0.6470 7.520  89.4  2.1398   5 264    13.0 388.37\n263  0.52014  20.0  3.97    0 0.6470 8.398  91.5  2.2885   5 264    13.0 386.86\n264  0.82526  20.0  3.97    0 0.6470 7.327  94.5  2.0788   5 264    13.0 393.42\n265  0.55007  20.0  3.97    0 0.6470 7.206  91.6  1.9301   5 264    13.0 387.89\n266  0.76162  20.0  3.97    0 0.6470 5.560  62.8  1.9865   5 264    13.0 392.40\n267  0.78570  20.0  3.97    0 0.6470 7.014  84.6  2.1329   5 264    13.0 384.07\n268  0.57834  20.0  3.97    0 0.5750 8.297  67.0  2.4216   5 264    13.0 384.54\n269  0.54050  20.0  3.97    0 0.5750 7.470  52.6  2.8720   5 264    13.0 390.30\n270  0.09065  20.0  6.96    1 0.4640 5.920  61.5  3.9175   3 223    18.6 391.34\n271  0.29916  20.0  6.96    0 0.4640 5.856  42.1  4.4290   3 223    18.6 388.65\n272  0.16211  20.0  6.96    0 0.4640 6.240  16.3  4.4290   3 223    18.6 396.90\n273  0.11460  20.0  6.96    0 0.4640 6.538  58.7  3.9175   3 223    18.6 394.96\n274  0.22188  20.0  6.96    1 0.4640 7.691  51.8  4.3665   3 223    18.6 390.77\n275  0.05644  40.0  6.41    1 0.4470 6.758  32.9  4.0776   4 254    17.6 396.90\n276  0.09604  40.0  6.41    0 0.4470 6.854  42.8  4.2673   4 254    17.6 396.90\n277  0.10469  40.0  6.41    1 0.4470 7.267  49.0  4.7872   4 254    17.6 389.25\n278  0.06127  40.0  6.41    1 0.4470 6.826  27.6  4.8628   4 254    17.6 393.45\n279  0.07978  40.0  6.41    0 0.4470 6.482  32.1  4.1403   4 254    17.6 396.90\n280  0.21038  20.0  3.33    0 0.4429 6.812  32.2  4.1007   5 216    14.9 396.90\n281  0.03578  20.0  3.33    0 0.4429 7.820  64.5  4.6947   5 216    14.9 387.31\n282  0.03705  20.0  3.33    0 0.4429 6.968  37.2  5.2447   5 216    14.9 392.23\n283  0.06129  20.0  3.33    1 0.4429 7.645  49.7  5.2119   5 216    14.9 377.07\n284  0.01501  90.0  1.21    1 0.4010 7.923  24.8  5.8850   1 198    13.6 395.52\n285  0.00906  90.0  2.97    0 0.4000 7.088  20.8  7.3073   1 285    15.3 394.72\n286  0.01096  55.0  2.25    0 0.3890 6.453  31.9  7.3073   1 300    15.3 394.72\n287  0.01965  80.0  1.76    0 0.3850 6.230  31.5  9.0892   1 241    18.2 341.60\n288  0.03871  52.5  5.32    0 0.4050 6.209  31.3  7.3172   6 293    16.6 396.90\n289  0.04590  52.5  5.32    0 0.4050 6.315  45.6  7.3172   6 293    16.6 396.90\n290  0.04297  52.5  5.32    0 0.4050 6.565  22.9  7.3172   6 293    16.6 371.72\n291  0.03502  80.0  4.95    0 0.4110 6.861  27.9  5.1167   4 245    19.2 396.90\n292  0.07886  80.0  4.95    0 0.4110 7.148  27.7  5.1167   4 245    19.2 396.90\n293  0.03615  80.0  4.95    0 0.4110 6.630  23.4  5.1167   4 245    19.2 396.90\n294  0.08265   0.0 13.92    0 0.4370 6.127  18.4  5.5027   4 289    16.0 396.90\n295  0.08199   0.0 13.92    0 0.4370 6.009  42.3  5.5027   4 289    16.0 396.90\n296  0.12932   0.0 13.92    0 0.4370 6.678  31.1  5.9604   4 289    16.0 396.90\n297  0.05372   0.0 13.92    0 0.4370 6.549  51.0  5.9604   4 289    16.0 392.85\n298  0.14103   0.0 13.92    0 0.4370 5.790  58.0  6.3200   4 289    16.0 396.90\n299  0.06466  70.0  2.24    0 0.4000 6.345  20.1  7.8278   5 358    14.8 368.24\n300  0.05561  70.0  2.24    0 0.4000 7.041  10.0  7.8278   5 358    14.8 371.58\n301  0.04417  70.0  2.24    0 0.4000 6.871  47.4  7.8278   5 358    14.8 390.86\n302  0.03537  34.0  6.09    0 0.4330 6.590  40.4  5.4917   7 329    16.1 395.75\n303  0.09266  34.0  6.09    0 0.4330 6.495  18.4  5.4917   7 329    16.1 383.61\n304  0.10000  34.0  6.09    0 0.4330 6.982  17.7  5.4917   7 329    16.1 390.43\n305  0.05515  33.0  2.18    0 0.4720 7.236  41.1  4.0220   7 222    18.4 393.68\n306  0.05479  33.0  2.18    0 0.4720 6.616  58.1  3.3700   7 222    18.4 393.36\n307  0.07503  33.0  2.18    0 0.4720 7.420  71.9  3.0992   7 222    18.4 396.90\n308  0.04932  33.0  2.18    0 0.4720 6.849  70.3  3.1827   7 222    18.4 396.90\n309  0.49298   0.0  9.90    0 0.5440 6.635  82.5  3.3175   4 304    18.4 396.90\n310  0.34940   0.0  9.90    0 0.5440 5.972  76.7  3.1025   4 304    18.4 396.24\n311  2.63548   0.0  9.90    0 0.5440 4.973  37.8  2.5194   4 304    18.4 350.45\n312  0.79041   0.0  9.90    0 0.5440 6.122  52.8  2.6403   4 304    18.4 396.90\n313  0.26169   0.0  9.90    0 0.5440 6.023  90.4  2.8340   4 304    18.4 396.30\n314  0.26938   0.0  9.90    0 0.5440 6.266  82.8  3.2628   4 304    18.4 393.39\n315  0.36920   0.0  9.90    0 0.5440 6.567  87.3  3.6023   4 304    18.4 395.69\n316  0.25356   0.0  9.90    0 0.5440 5.705  77.7  3.9450   4 304    18.4 396.42\n317  0.31827   0.0  9.90    0 0.5440 5.914  83.2  3.9986   4 304    18.4 390.70\n318  0.24522   0.0  9.90    0 0.5440 5.782  71.7  4.0317   4 304    18.4 396.90\n319  0.40202   0.0  9.90    0 0.5440 6.382  67.2  3.5325   4 304    18.4 395.21\n320  0.47547   0.0  9.90    0 0.5440 6.113  58.8  4.0019   4 304    18.4 396.23\n321  0.16760   0.0  7.38    0 0.4930 6.426  52.3  4.5404   5 287    19.6 396.90\n322  0.18159   0.0  7.38    0 0.4930 6.376  54.3  4.5404   5 287    19.6 396.90\n323  0.35114   0.0  7.38    0 0.4930 6.041  49.9  4.7211   5 287    19.6 396.90\n324  0.28392   0.0  7.38    0 0.4930 5.708  74.3  4.7211   5 287    19.6 391.13\n325  0.34109   0.0  7.38    0 0.4930 6.415  40.1  4.7211   5 287    19.6 396.90\n326  0.19186   0.0  7.38    0 0.4930 6.431  14.7  5.4159   5 287    19.6 393.68\n327  0.30347   0.0  7.38    0 0.4930 6.312  28.9  5.4159   5 287    19.6 396.90\n328  0.24103   0.0  7.38    0 0.4930 6.083  43.7  5.4159   5 287    19.6 396.90\n329  0.06617   0.0  3.24    0 0.4600 5.868  25.8  5.2146   4 430    16.9 382.44\n330  0.06724   0.0  3.24    0 0.4600 6.333  17.2  5.2146   4 430    16.9 375.21\n331  0.04544   0.0  3.24    0 0.4600 6.144  32.2  5.8736   4 430    16.9 368.57\n332  0.05023  35.0  6.06    0 0.4379 5.706  28.4  6.6407   1 304    16.9 394.02\n333  0.03466  35.0  6.06    0 0.4379 6.031  23.3  6.6407   1 304    16.9 362.25\n334  0.05083   0.0  5.19    0 0.5150 6.316  38.1  6.4584   5 224    20.2 389.71\n335  0.03738   0.0  5.19    0 0.5150 6.310  38.5  6.4584   5 224    20.2 389.40\n336  0.03961   0.0  5.19    0 0.5150 6.037  34.5  5.9853   5 224    20.2 396.90\n337  0.03427   0.0  5.19    0 0.5150 5.869  46.3  5.2311   5 224    20.2 396.90\n338  0.03041   0.0  5.19    0 0.5150 5.895  59.6  5.6150   5 224    20.2 394.81\n339  0.03306   0.0  5.19    0 0.5150 6.059  37.3  4.8122   5 224    20.2 396.14\n340  0.05497   0.0  5.19    0 0.5150 5.985  45.4  4.8122   5 224    20.2 396.90\n341  0.06151   0.0  5.19    0 0.5150 5.968  58.5  4.8122   5 224    20.2 396.90\n342  0.01301  35.0  1.52    0 0.4420 7.241  49.3  7.0379   1 284    15.5 394.74\n343  0.02498   0.0  1.89    0 0.5180 6.540  59.7  6.2669   1 422    15.9 389.96\n344  0.02543  55.0  3.78    0 0.4840 6.696  56.4  5.7321   5 370    17.6 396.90\n345  0.03049  55.0  3.78    0 0.4840 6.874  28.1  6.4654   5 370    17.6 387.97\n346  0.03113   0.0  4.39    0 0.4420 6.014  48.5  8.0136   3 352    18.8 385.64\n347  0.06162   0.0  4.39    0 0.4420 5.898  52.3  8.0136   3 352    18.8 364.61\n348  0.01870  85.0  4.15    0 0.4290 6.516  27.7  8.5353   4 351    17.9 392.43\n349  0.01501  80.0  2.01    0 0.4350 6.635  29.7  8.3440   4 280    17.0 390.94\n350  0.02899  40.0  1.25    0 0.4290 6.939  34.5  8.7921   1 335    19.7 389.85\n351  0.06211  40.0  1.25    0 0.4290 6.490  44.4  8.7921   1 335    19.7 396.90\n352  0.07950  60.0  1.69    0 0.4110 6.579  35.9 10.7103   4 411    18.3 370.78\n353  0.07244  60.0  1.69    0 0.4110 5.884  18.5 10.7103   4 411    18.3 392.33\n354  0.01709  90.0  2.02    0 0.4100 6.728  36.1 12.1265   5 187    17.0 384.46\n355  0.04301  80.0  1.91    0 0.4130 5.663  21.9 10.5857   4 334    22.0 382.80\n356  0.10659  80.0  1.91    0 0.4130 5.936  19.5 10.5857   4 334    22.0 376.04\n357  8.98296   0.0 18.10    1 0.7700 6.212  97.4  2.1222  24 666    20.2 377.73\n358  3.84970   0.0 18.10    1 0.7700 6.395  91.0  2.5052  24 666    20.2 391.34\n359  5.20177   0.0 18.10    1 0.7700 6.127  83.4  2.7227  24 666    20.2 395.43\n360  4.26131   0.0 18.10    0 0.7700 6.112  81.3  2.5091  24 666    20.2 390.74\n361  4.54192   0.0 18.10    0 0.7700 6.398  88.0  2.5182  24 666    20.2 374.56\n362  3.83684   0.0 18.10    0 0.7700 6.251  91.1  2.2955  24 666    20.2 350.65\n363  3.67822   0.0 18.10    0 0.7700 5.362  96.2  2.1036  24 666    20.2 380.79\n364  4.22239   0.0 18.10    1 0.7700 5.803  89.0  1.9047  24 666    20.2 353.04\n365  3.47428   0.0 18.10    1 0.7180 8.780  82.9  1.9047  24 666    20.2 354.55\n366  4.55587   0.0 18.10    0 0.7180 3.561  87.9  1.6132  24 666    20.2 354.70\n367  3.69695   0.0 18.10    0 0.7180 4.963  91.4  1.7523  24 666    20.2 316.03\n368 13.52220   0.0 18.10    0 0.6310 3.863 100.0  1.5106  24 666    20.2 131.42\n369  4.89822   0.0 18.10    0 0.6310 4.970 100.0  1.3325  24 666    20.2 375.52\n370  5.66998   0.0 18.10    1 0.6310 6.683  96.8  1.3567  24 666    20.2 375.33\n371  6.53876   0.0 18.10    1 0.6310 7.016  97.5  1.2024  24 666    20.2 392.05\n372  9.23230   0.0 18.10    0 0.6310 6.216 100.0  1.1691  24 666    20.2 366.15\n373  8.26725   0.0 18.10    1 0.6680 5.875  89.6  1.1296  24 666    20.2 347.88\n374 11.10810   0.0 18.10    0 0.6680 4.906 100.0  1.1742  24 666    20.2 396.90\n375 18.49820   0.0 18.10    0 0.6680 4.138 100.0  1.1370  24 666    20.2 396.90\n376 19.60910   0.0 18.10    0 0.6710 7.313  97.9  1.3163  24 666    20.2 396.90\n377 15.28800   0.0 18.10    0 0.6710 6.649  93.3  1.3449  24 666    20.2 363.02\n378  9.82349   0.0 18.10    0 0.6710 6.794  98.8  1.3580  24 666    20.2 396.90\n379 23.64820   0.0 18.10    0 0.6710 6.380  96.2  1.3861  24 666    20.2 396.90\n380 17.86670   0.0 18.10    0 0.6710 6.223 100.0  1.3861  24 666    20.2 393.74\n381 88.97620   0.0 18.10    0 0.6710 6.968  91.9  1.4165  24 666    20.2 396.90\n382 15.87440   0.0 18.10    0 0.6710 6.545  99.1  1.5192  24 666    20.2 396.90\n383  9.18702   0.0 18.10    0 0.7000 5.536 100.0  1.5804  24 666    20.2 396.90\n384  7.99248   0.0 18.10    0 0.7000 5.520 100.0  1.5331  24 666    20.2 396.90\n385 20.08490   0.0 18.10    0 0.7000 4.368  91.2  1.4395  24 666    20.2 285.83\n386 16.81180   0.0 18.10    0 0.7000 5.277  98.1  1.4261  24 666    20.2 396.90\n387 24.39380   0.0 18.10    0 0.7000 4.652 100.0  1.4672  24 666    20.2 396.90\n388 22.59710   0.0 18.10    0 0.7000 5.000  89.5  1.5184  24 666    20.2 396.90\n389 14.33370   0.0 18.10    0 0.7000 4.880 100.0  1.5895  24 666    20.2 372.92\n390  8.15174   0.0 18.10    0 0.7000 5.390  98.9  1.7281  24 666    20.2 396.90\n391  6.96215   0.0 18.10    0 0.7000 5.713  97.0  1.9265  24 666    20.2 394.43\n392  5.29305   0.0 18.10    0 0.7000 6.051  82.5  2.1678  24 666    20.2 378.38\n393 11.57790   0.0 18.10    0 0.7000 5.036  97.0  1.7700  24 666    20.2 396.90\n394  8.64476   0.0 18.10    0 0.6930 6.193  92.6  1.7912  24 666    20.2 396.90\n395 13.35980   0.0 18.10    0 0.6930 5.887  94.7  1.7821  24 666    20.2 396.90\n396  8.71675   0.0 18.10    0 0.6930 6.471  98.8  1.7257  24 666    20.2 391.98\n397  5.87205   0.0 18.10    0 0.6930 6.405  96.0  1.6768  24 666    20.2 396.90\n398  7.67202   0.0 18.10    0 0.6930 5.747  98.9  1.6334  24 666    20.2 393.10\n399 38.35180   0.0 18.10    0 0.6930 5.453 100.0  1.4896  24 666    20.2 396.90\n400  9.91655   0.0 18.10    0 0.6930 5.852  77.8  1.5004  24 666    20.2 338.16\n401 25.04610   0.0 18.10    0 0.6930 5.987 100.0  1.5888  24 666    20.2 396.90\n402 14.23620   0.0 18.10    0 0.6930 6.343 100.0  1.5741  24 666    20.2 396.90\n403  9.59571   0.0 18.10    0 0.6930 6.404 100.0  1.6390  24 666    20.2 376.11\n404 24.80170   0.0 18.10    0 0.6930 5.349  96.0  1.7028  24 666    20.2 396.90\n405 41.52920   0.0 18.10    0 0.6930 5.531  85.4  1.6074  24 666    20.2 329.46\n406 67.92080   0.0 18.10    0 0.6930 5.683 100.0  1.4254  24 666    20.2 384.97\n407 20.71620   0.0 18.10    0 0.6590 4.138 100.0  1.1781  24 666    20.2 370.22\n408 11.95110   0.0 18.10    0 0.6590 5.608 100.0  1.2852  24 666    20.2 332.09\n409  7.40389   0.0 18.10    0 0.5970 5.617  97.9  1.4547  24 666    20.2 314.64\n410 14.43830   0.0 18.10    0 0.5970 6.852 100.0  1.4655  24 666    20.2 179.36\n411 51.13580   0.0 18.10    0 0.5970 5.757 100.0  1.4130  24 666    20.2   2.60\n412 14.05070   0.0 18.10    0 0.5970 6.657 100.0  1.5275  24 666    20.2  35.05\n413 18.81100   0.0 18.10    0 0.5970 4.628 100.0  1.5539  24 666    20.2  28.79\n414 28.65580   0.0 18.10    0 0.5970 5.155 100.0  1.5894  24 666    20.2 210.97\n415 45.74610   0.0 18.10    0 0.6930 4.519 100.0  1.6582  24 666    20.2  88.27\n416 18.08460   0.0 18.10    0 0.6790 6.434 100.0  1.8347  24 666    20.2  27.25\n417 10.83420   0.0 18.10    0 0.6790 6.782  90.8  1.8195  24 666    20.2  21.57\n418 25.94060   0.0 18.10    0 0.6790 5.304  89.1  1.6475  24 666    20.2 127.36\n419 73.53410   0.0 18.10    0 0.6790 5.957 100.0  1.8026  24 666    20.2  16.45\n420 11.81230   0.0 18.10    0 0.7180 6.824  76.5  1.7940  24 666    20.2  48.45\n421 11.08740   0.0 18.10    0 0.7180 6.411 100.0  1.8589  24 666    20.2 318.75\n422  7.02259   0.0 18.10    0 0.7180 6.006  95.3  1.8746  24 666    20.2 319.98\n423 12.04820   0.0 18.10    0 0.6140 5.648  87.6  1.9512  24 666    20.2 291.55\n424  7.05042   0.0 18.10    0 0.6140 6.103  85.1  2.0218  24 666    20.2   2.52\n425  8.79212   0.0 18.10    0 0.5840 5.565  70.6  2.0635  24 666    20.2   3.65\n426 15.86030   0.0 18.10    0 0.6790 5.896  95.4  1.9096  24 666    20.2   7.68\n427 12.24720   0.0 18.10    0 0.5840 5.837  59.7  1.9976  24 666    20.2  24.65\n428 37.66190   0.0 18.10    0 0.6790 6.202  78.7  1.8629  24 666    20.2  18.82\n429  7.36711   0.0 18.10    0 0.6790 6.193  78.1  1.9356  24 666    20.2  96.73\n430  9.33889   0.0 18.10    0 0.6790 6.380  95.6  1.9682  24 666    20.2  60.72\n431  8.49213   0.0 18.10    0 0.5840 6.348  86.1  2.0527  24 666    20.2  83.45\n432 10.06230   0.0 18.10    0 0.5840 6.833  94.3  2.0882  24 666    20.2  81.33\n433  6.44405   0.0 18.10    0 0.5840 6.425  74.8  2.2004  24 666    20.2  97.95\n434  5.58107   0.0 18.10    0 0.7130 6.436  87.9  2.3158  24 666    20.2 100.19\n435 13.91340   0.0 18.10    0 0.7130 6.208  95.0  2.2222  24 666    20.2 100.63\n436 11.16040   0.0 18.10    0 0.7400 6.629  94.6  2.1247  24 666    20.2 109.85\n437 14.42080   0.0 18.10    0 0.7400 6.461  93.3  2.0026  24 666    20.2  27.49\n438 15.17720   0.0 18.10    0 0.7400 6.152 100.0  1.9142  24 666    20.2   9.32\n439 13.67810   0.0 18.10    0 0.7400 5.935  87.9  1.8206  24 666    20.2  68.95\n440  9.39063   0.0 18.10    0 0.7400 5.627  93.9  1.8172  24 666    20.2 396.90\n441 22.05110   0.0 18.10    0 0.7400 5.818  92.4  1.8662  24 666    20.2 391.45\n442  9.72418   0.0 18.10    0 0.7400 6.406  97.2  2.0651  24 666    20.2 385.96\n443  5.66637   0.0 18.10    0 0.7400 6.219 100.0  2.0048  24 666    20.2 395.69\n444  9.96654   0.0 18.10    0 0.7400 6.485 100.0  1.9784  24 666    20.2 386.73\n445 12.80230   0.0 18.10    0 0.7400 5.854  96.6  1.8956  24 666    20.2 240.52\n446 10.67180   0.0 18.10    0 0.7400 6.459  94.8  1.9879  24 666    20.2  43.06\n447  6.28807   0.0 18.10    0 0.7400 6.341  96.4  2.0720  24 666    20.2 318.01\n448  9.92485   0.0 18.10    0 0.7400 6.251  96.6  2.1980  24 666    20.2 388.52\n449  9.32909   0.0 18.10    0 0.7130 6.185  98.7  2.2616  24 666    20.2 396.90\n450  7.52601   0.0 18.10    0 0.7130 6.417  98.3  2.1850  24 666    20.2 304.21\n451  6.71772   0.0 18.10    0 0.7130 6.749  92.6  2.3236  24 666    20.2   0.32\n452  5.44114   0.0 18.10    0 0.7130 6.655  98.2  2.3552  24 666    20.2 355.29\n453  5.09017   0.0 18.10    0 0.7130 6.297  91.8  2.3682  24 666    20.2 385.09\n454  8.24809   0.0 18.10    0 0.7130 7.393  99.3  2.4527  24 666    20.2 375.87\n455  9.51363   0.0 18.10    0 0.7130 6.728  94.1  2.4961  24 666    20.2   6.68\n456  4.75237   0.0 18.10    0 0.7130 6.525  86.5  2.4358  24 666    20.2  50.92\n457  4.66883   0.0 18.10    0 0.7130 5.976  87.9  2.5806  24 666    20.2  10.48\n458  8.20058   0.0 18.10    0 0.7130 5.936  80.3  2.7792  24 666    20.2   3.50\n459  7.75223   0.0 18.10    0 0.7130 6.301  83.7  2.7831  24 666    20.2 272.21\n460  6.80117   0.0 18.10    0 0.7130 6.081  84.4  2.7175  24 666    20.2 396.90\n461  4.81213   0.0 18.10    0 0.7130 6.701  90.0  2.5975  24 666    20.2 255.23\n462  3.69311   0.0 18.10    0 0.7130 6.376  88.4  2.5671  24 666    20.2 391.43\n463  6.65492   0.0 18.10    0 0.7130 6.317  83.0  2.7344  24 666    20.2 396.90\n464  5.82115   0.0 18.10    0 0.7130 6.513  89.9  2.8016  24 666    20.2 393.82\n465  7.83932   0.0 18.10    0 0.6550 6.209  65.4  2.9634  24 666    20.2 396.90\n466  3.16360   0.0 18.10    0 0.6550 5.759  48.2  3.0665  24 666    20.2 334.40\n467  3.77498   0.0 18.10    0 0.6550 5.952  84.7  2.8715  24 666    20.2  22.01\n468  4.42228   0.0 18.10    0 0.5840 6.003  94.5  2.5403  24 666    20.2 331.29\n469 15.57570   0.0 18.10    0 0.5800 5.926  71.0  2.9084  24 666    20.2 368.74\n470 13.07510   0.0 18.10    0 0.5800 5.713  56.7  2.8237  24 666    20.2 396.90\n471  4.34879   0.0 18.10    0 0.5800 6.167  84.0  3.0334  24 666    20.2 396.90\n472  4.03841   0.0 18.10    0 0.5320 6.229  90.7  3.0993  24 666    20.2 395.33\n473  3.56868   0.0 18.10    0 0.5800 6.437  75.0  2.8965  24 666    20.2 393.37\n474  4.64689   0.0 18.10    0 0.6140 6.980  67.6  2.5329  24 666    20.2 374.68\n475  8.05579   0.0 18.10    0 0.5840 5.427  95.4  2.4298  24 666    20.2 352.58\n476  6.39312   0.0 18.10    0 0.5840 6.162  97.4  2.2060  24 666    20.2 302.76\n477  4.87141   0.0 18.10    0 0.6140 6.484  93.6  2.3053  24 666    20.2 396.21\n478 15.02340   0.0 18.10    0 0.6140 5.304  97.3  2.1007  24 666    20.2 349.48\n479 10.23300   0.0 18.10    0 0.6140 6.185  96.7  2.1705  24 666    20.2 379.70\n480 14.33370   0.0 18.10    0 0.6140 6.229  88.0  1.9512  24 666    20.2 383.32\n481  5.82401   0.0 18.10    0 0.5320 6.242  64.7  3.4242  24 666    20.2 396.90\n482  5.70818   0.0 18.10    0 0.5320 6.750  74.9  3.3317  24 666    20.2 393.07\n483  5.73116   0.0 18.10    0 0.5320 7.061  77.0  3.4106  24 666    20.2 395.28\n484  2.81838   0.0 18.10    0 0.5320 5.762  40.3  4.0983  24 666    20.2 392.92\n485  2.37857   0.0 18.10    0 0.5830 5.871  41.9  3.7240  24 666    20.2 370.73\n486  3.67367   0.0 18.10    0 0.5830 6.312  51.9  3.9917  24 666    20.2 388.62\n487  5.69175   0.0 18.10    0 0.5830 6.114  79.8  3.5459  24 666    20.2 392.68\n488  4.83567   0.0 18.10    0 0.5830 5.905  53.2  3.1523  24 666    20.2 388.22\n489  0.15086   0.0 27.74    0 0.6090 5.454  92.7  1.8209   4 711    20.1 395.09\n490  0.18337   0.0 27.74    0 0.6090 5.414  98.3  1.7554   4 711    20.1 344.05\n491  0.20746   0.0 27.74    0 0.6090 5.093  98.0  1.8226   4 711    20.1 318.43\n492  0.10574   0.0 27.74    0 0.6090 5.983  98.8  1.8681   4 711    20.1 390.11\n493  0.11132   0.0 27.74    0 0.6090 5.983  83.5  2.1099   4 711    20.1 396.90\n494  0.17331   0.0  9.69    0 0.5850 5.707  54.0  2.3817   6 391    19.2 396.90\n495  0.27957   0.0  9.69    0 0.5850 5.926  42.6  2.3817   6 391    19.2 396.90\n496  0.17899   0.0  9.69    0 0.5850 5.670  28.8  2.7986   6 391    19.2 393.29\n497  0.28960   0.0  9.69    0 0.5850 5.390  72.9  2.7986   6 391    19.2 396.90\n498  0.26838   0.0  9.69    0 0.5850 5.794  70.6  2.8927   6 391    19.2 396.90\n499  0.23912   0.0  9.69    0 0.5850 6.019  65.3  2.4091   6 391    19.2 396.90\n500  0.17783   0.0  9.69    0 0.5850 5.569  73.5  2.3999   6 391    19.2 395.77\n501  0.22438   0.0  9.69    0 0.5850 6.027  79.7  2.4982   6 391    19.2 396.90\n502  0.06263   0.0 11.93    0 0.5730 6.593  69.1  2.4786   1 273    21.0 391.99\n503  0.04527   0.0 11.93    0 0.5730 6.120  76.7  2.2875   1 273    21.0 396.90\n504  0.06076   0.0 11.93    0 0.5730 6.976  91.0  2.1675   1 273    21.0 396.90\n505  0.10959   0.0 11.93    0 0.5730 6.794  89.3  2.3889   1 273    21.0 393.45\n506  0.04741   0.0 11.93    0 0.5730 6.030  80.8  2.5050   1 273    21.0 396.90\n    lstat medv\n1    4.98 24.0\n2    9.14 21.6\n3    4.03 34.7\n4    2.94 33.4\n5    5.33 36.2\n6    5.21 28.7\n7   12.43 22.9\n8   19.15 27.1\n9   29.93 16.5\n10  17.10 18.9\n11  20.45 15.0\n12  13.27 18.9\n13  15.71 21.7\n14   8.26 20.4\n15  10.26 18.2\n16   8.47 19.9\n17   6.58 23.1\n18  14.67 17.5\n19  11.69 20.2\n20  11.28 18.2\n21  21.02 13.6\n22  13.83 19.6\n23  18.72 15.2\n24  19.88 14.5\n25  16.30 15.6\n26  16.51 13.9\n27  14.81 16.6\n28  17.28 14.8\n29  12.80 18.4\n30  11.98 21.0\n31  22.60 12.7\n32  13.04 14.5\n33  27.71 13.2\n34  18.35 13.1\n35  20.34 13.5\n36   9.68 18.9\n37  11.41 20.0\n38   8.77 21.0\n39  10.13 24.7\n40   4.32 30.8\n41   1.98 34.9\n42   4.84 26.6\n43   5.81 25.3\n44   7.44 24.7\n45   9.55 21.2\n46  10.21 19.3\n47  14.15 20.0\n48  18.80 16.6\n49  30.81 14.4\n50  16.20 19.4\n51  13.45 19.7\n52   9.43 20.5\n53   5.28 25.0\n54   8.43 23.4\n55  14.80 18.9\n56   4.81 35.4\n57   5.77 24.7\n58   3.95 31.6\n59   6.86 23.3\n60   9.22 19.6\n61  13.15 18.7\n62  14.44 16.0\n63   6.73 22.2\n64   9.50 25.0\n65   8.05 33.0\n66   4.67 23.5\n67  10.24 19.4\n68   8.10 22.0\n69  13.09 17.4\n70   8.79 20.9\n71   6.72 24.2\n72   9.88 21.7\n73   5.52 22.8\n74   7.54 23.4\n75   6.78 24.1\n76   8.94 21.4\n77  11.97 20.0\n78  10.27 20.8\n79  12.34 21.2\n80   9.10 20.3\n81   5.29 28.0\n82   7.22 23.9\n83   6.72 24.8\n84   7.51 22.9\n85   9.62 23.9\n86   6.53 26.6\n87  12.86 22.5\n88   8.44 22.2\n89   5.50 23.6\n90   5.70 28.7\n91   8.81 22.6\n92   8.20 22.0\n93   8.16 22.9\n94   6.21 25.0\n95  10.59 20.6\n96   6.65 28.4\n97  11.34 21.4\n98   4.21 38.7\n99   3.57 43.8\n100  6.19 33.2\n101  9.42 27.5\n102  7.67 26.5\n103 10.63 18.6\n104 13.44 19.3\n105 12.33 20.1\n106 16.47 19.5\n107 18.66 19.5\n108 14.09 20.4\n109 12.27 19.8\n110 15.55 19.4\n111 13.00 21.7\n112 10.16 22.8\n113 16.21 18.8\n114 17.09 18.7\n115 10.45 18.5\n116 15.76 18.3\n117 12.04 21.2\n118 10.30 19.2\n119 15.37 20.4\n120 13.61 19.3\n121 14.37 22.0\n122 14.27 20.3\n123 17.93 20.5\n124 25.41 17.3\n125 17.58 18.8\n126 14.81 21.4\n127 27.26 15.7\n128 17.19 16.2\n129 15.39 18.0\n130 18.34 14.3\n131 12.60 19.2\n132 12.26 19.6\n133 11.12 23.0\n134 15.03 18.4\n135 17.31 15.6\n136 16.96 18.1\n137 16.90 17.4\n138 14.59 17.1\n139 21.32 13.3\n140 18.46 17.8\n141 24.16 14.0\n142 34.41 14.4\n143 26.82 13.4\n144 26.42 15.6\n145 29.29 11.8\n146 27.80 13.8\n147 16.65 15.6\n148 29.53 14.6\n149 28.32 17.8\n150 21.45 15.4\n151 14.10 21.5\n152 13.28 19.6\n153 12.12 15.3\n154 15.79 19.4\n155 15.12 17.0\n156 15.02 15.6\n157 16.14 13.1\n158  4.59 41.3\n159  6.43 24.3\n160  7.39 23.3\n161  5.50 27.0\n162  1.73 50.0\n163  1.92 50.0\n164  3.32 50.0\n165 11.64 22.7\n166  9.81 25.0\n167  3.70 50.0\n168 12.14 23.8\n169 11.10 23.8\n170 11.32 22.3\n171 14.43 17.4\n172 12.03 19.1\n173 14.69 23.1\n174  9.04 23.6\n175  9.64 22.6\n176  5.33 29.4\n177 10.11 23.2\n178  6.29 24.6\n179  6.92 29.9\n180  5.04 37.2\n181  7.56 39.8\n182  9.45 36.2\n183  4.82 37.9\n184  5.68 32.5\n185 13.98 26.4\n186 13.15 29.6\n187  4.45 50.0\n188  6.68 32.0\n189  4.56 29.8\n190  5.39 34.9\n191  5.10 37.0\n192  4.69 30.5\n193  2.87 36.4\n194  5.03 31.1\n195  4.38 29.1\n196  2.97 50.0\n197  4.08 33.3\n198  8.61 30.3\n199  6.62 34.6\n200  4.56 34.9\n201  4.45 32.9\n202  7.43 24.1\n203  3.11 42.3\n204  3.81 48.5\n205  2.88 50.0\n206 10.87 22.6\n207 10.97 24.4\n208 18.06 22.5\n209 14.66 24.4\n210 23.09 20.0\n211 17.27 21.7\n212 23.98 19.3\n213 16.03 22.4\n214  9.38 28.1\n215 29.55 23.7\n216  9.47 25.0\n217 13.51 23.3\n218  9.69 28.7\n219 17.92 21.5\n220 10.50 23.0\n221  9.71 26.7\n222 21.46 21.7\n223  9.93 27.5\n224  7.60 30.1\n225  4.14 44.8\n226  4.63 50.0\n227  3.13 37.6\n228  6.36 31.6\n229  3.92 46.7\n230  3.76 31.5\n231 11.65 24.3\n232  5.25 31.7\n233  2.47 41.7\n234  3.95 48.3\n235  8.05 29.0\n236 10.88 24.0\n237  9.54 25.1\n238  4.73 31.5\n239  6.36 23.7\n240  7.37 23.3\n241 11.38 22.0\n242 12.40 20.1\n243 11.22 22.2\n244  5.19 23.7\n245 12.50 17.6\n246 18.46 18.5\n247  9.16 24.3\n248 10.15 20.5\n249  9.52 24.5\n250  6.56 26.2\n251  5.90 24.4\n252  3.59 24.8\n253  3.53 29.6\n254  3.54 42.8\n255  6.57 21.9\n256  9.25 20.9\n257  3.11 44.0\n258  5.12 50.0\n259  7.79 36.0\n260  6.90 30.1\n261  9.59 33.8\n262  7.26 43.1\n263  5.91 48.8\n264 11.25 31.0\n265  8.10 36.5\n266 10.45 22.8\n267 14.79 30.7\n268  7.44 50.0\n269  3.16 43.5\n270 13.65 20.7\n271 13.00 21.1\n272  6.59 25.2\n273  7.73 24.4\n274  6.58 35.2\n275  3.53 32.4\n276  2.98 32.0\n277  6.05 33.2\n278  4.16 33.1\n279  7.19 29.1\n280  4.85 35.1\n281  3.76 45.4\n282  4.59 35.4\n283  3.01 46.0\n284  3.16 50.0\n285  7.85 32.2\n286  8.23 22.0\n287 12.93 20.1\n288  7.14 23.2\n289  7.60 22.3\n290  9.51 24.8\n291  3.33 28.5\n292  3.56 37.3\n293  4.70 27.9\n294  8.58 23.9\n295 10.40 21.7\n296  6.27 28.6\n297  7.39 27.1\n298 15.84 20.3\n299  4.97 22.5\n300  4.74 29.0\n301  6.07 24.8\n302  9.50 22.0\n303  8.67 26.4\n304  4.86 33.1\n305  6.93 36.1\n306  8.93 28.4\n307  6.47 33.4\n308  7.53 28.2\n309  4.54 22.8\n310  9.97 20.3\n311 12.64 16.1\n312  5.98 22.1\n313 11.72 19.4\n314  7.90 21.6\n315  9.28 23.8\n316 11.50 16.2\n317 18.33 17.8\n318 15.94 19.8\n319 10.36 23.1\n320 12.73 21.0\n321  7.20 23.8\n322  6.87 23.1\n323  7.70 20.4\n324 11.74 18.5\n325  6.12 25.0\n326  5.08 24.6\n327  6.15 23.0\n328 12.79 22.2\n329  9.97 19.3\n330  7.34 22.6\n331  9.09 19.8\n332 12.43 17.1\n333  7.83 19.4\n334  5.68 22.2\n335  6.75 20.7\n336  8.01 21.1\n337  9.80 19.5\n338 10.56 18.5\n339  8.51 20.6\n340  9.74 19.0\n341  9.29 18.7\n342  5.49 32.7\n343  8.65 16.5\n344  7.18 23.9\n345  4.61 31.2\n346 10.53 17.5\n347 12.67 17.2\n348  6.36 23.1\n349  5.99 24.5\n350  5.89 26.6\n351  5.98 22.9\n352  5.49 24.1\n353  7.79 18.6\n354  4.50 30.1\n355  8.05 18.2\n356  5.57 20.6\n357 17.60 17.8\n358 13.27 21.7\n359 11.48 22.7\n360 12.67 22.6\n361  7.79 25.0\n362 14.19 19.9\n363 10.19 20.8\n364 14.64 16.8\n365  5.29 21.9\n366  7.12 27.5\n367 14.00 21.9\n368 13.33 23.1\n369  3.26 50.0\n370  3.73 50.0\n371  2.96 50.0\n372  9.53 50.0\n373  8.88 50.0\n374 34.77 13.8\n375 37.97 13.8\n376 13.44 15.0\n377 23.24 13.9\n378 21.24 13.3\n379 23.69 13.1\n380 21.78 10.2\n381 17.21 10.4\n382 21.08 10.9\n383 23.60 11.3\n384 24.56 12.3\n385 30.63  8.8\n386 30.81  7.2\n387 28.28 10.5\n388 31.99  7.4\n389 30.62 10.2\n390 20.85 11.5\n391 17.11 15.1\n392 18.76 23.2\n393 25.68  9.7\n394 15.17 13.8\n395 16.35 12.7\n396 17.12 13.1\n397 19.37 12.5\n398 19.92  8.5\n399 30.59  5.0\n400 29.97  6.3\n401 26.77  5.6\n402 20.32  7.2\n403 20.31 12.1\n404 19.77  8.3\n405 27.38  8.5\n406 22.98  5.0\n407 23.34 11.9\n408 12.13 27.9\n409 26.40 17.2\n410 19.78 27.5\n411 10.11 15.0\n412 21.22 17.2\n413 34.37 17.9\n414 20.08 16.3\n415 36.98  7.0\n416 29.05  7.2\n417 25.79  7.5\n418 26.64 10.4\n419 20.62  8.8\n420 22.74  8.4\n421 15.02 16.7\n422 15.70 14.2\n423 14.10 20.8\n424 23.29 13.4\n425 17.16 11.7\n426 24.39  8.3\n427 15.69 10.2\n428 14.52 10.9\n429 21.52 11.0\n430 24.08  9.5\n431 17.64 14.5\n432 19.69 14.1\n433 12.03 16.1\n434 16.22 14.3\n435 15.17 11.7\n436 23.27 13.4\n437 18.05  9.6\n438 26.45  8.7\n439 34.02  8.4\n440 22.88 12.8\n441 22.11 10.5\n442 19.52 17.1\n443 16.59 18.4\n444 18.85 15.4\n445 23.79 10.8\n446 23.98 11.8\n447 17.79 14.9\n448 16.44 12.6\n449 18.13 14.1\n450 19.31 13.0\n451 17.44 13.4\n452 17.73 15.2\n453 17.27 16.1\n454 16.74 17.8\n455 18.71 14.9\n456 18.13 14.1\n457 19.01 12.7\n458 16.94 13.5\n459 16.23 14.9\n460 14.70 20.0\n461 16.42 16.4\n462 14.65 17.7\n463 13.99 19.5\n464 10.29 20.2\n465 13.22 21.4\n466 14.13 19.9\n467 17.15 19.0\n468 21.32 19.1\n469 18.13 19.1\n470 14.76 20.1\n471 16.29 19.9\n472 12.87 19.6\n473 14.36 23.2\n474 11.66 29.8\n475 18.14 13.8\n476 24.10 13.3\n477 18.68 16.7\n478 24.91 12.0\n479 18.03 14.6\n480 13.11 21.4\n481 10.74 23.0\n482  7.74 23.7\n483  7.01 25.0\n484 10.42 21.8\n485 13.34 20.6\n486 10.58 21.2\n487 14.98 19.1\n488 11.45 20.6\n489 18.06 15.2\n490 23.97  7.0\n491 29.68  8.1\n492 18.07 13.6\n493 13.35 20.1\n494 12.01 21.8\n495 13.59 24.5\n496 17.60 23.1\n497 21.14 19.7\n498 14.10 18.3\n499 12.92 21.2\n500 15.10 17.5\n501 14.33 16.8\n502  9.67 22.4\n503  9.08 20.6\n504  5.64 23.9\n505  6.48 22.0\n506  7.88 11.9"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#回帰分析の練習-1",
    "href": "prezemi_2023_11_presen.html#回帰分析の練習-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析の練習",
    "text": "回帰分析の練習\n\n\n\ncrim : 犯罪率\nzn: 広い家の割合\nindus: 非小売業の割合\nchas: 川に近接(1:yes, 0:no)\nnox: 一酸化窒素濃度\nrm: 平均部屋数\nage: 古い家の割合\n\n\n\ndis: 主要施設への距離\nrad: 主要高速道路へのアクセス性\ntax: 固定資産税率\nptratio: 生徒先生の比率\nblack: 黒人の割合\nlstat: 低所得者割合\nmedv: 住宅価格"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#回帰分析の練習-2",
    "href": "prezemi_2023_11_presen.html#回帰分析の練習-2",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "回帰分析の練習",
    "text": "回帰分析の練習\nこのデータを使って、回帰モデルを構築してみてください。 たとえば、\n\n  🟡 Loading\n    webR..."
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数の利用",
    "href": "prezemi_2023_11_presen.html#ダミー変数の利用",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の利用",
    "text": "ダミー変数の利用\nダミー変数(dummy variable)とは，二値変数(binary variable)とか指示変数(indicator variable)とも呼ばれ，カテゴリーに属しているかどうかを表す1か0の値をとる変数のことです。\n\\[\n\\begin{aligned}\nX = \\begin{cases}\n1 & \\text{if カテゴリーに属している}\\\\\n0 & \\text{if カテゴリーに属していない}\n\\end{cases}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#説明変数がダミー変数のみの回帰",
    "href": "prezemi_2023_11_presen.html#説明変数がダミー変数のみの回帰",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "説明変数がダミー変数のみの回帰",
    "text": "説明変数がダミー変数のみの回帰\n例えば、単回帰分析の説明変数がダミー変数\\(D\\)である場合\n\\[\n\\begin{aligned}\nY = \\beta_0 + \\beta_1 D + \\varepsilon\n\\end{aligned}\n\\]\nこのとき、この単回帰モデルを次のように書くことが出来ます。\n\\[\n\\begin{aligned}\nY = \\begin{cases}\n\\beta_0 + \\varepsilon & \\text{if } D = 0 \\\\\n\\beta_0 + \\beta_1 + \\varepsilon & \\text{if } D = 1\n\\end{cases}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#説明変数がダミー変数のみの回帰-1",
    "href": "prezemi_2023_11_presen.html#説明変数がダミー変数のみの回帰-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "説明変数がダミー変数のみの回帰",
    "text": "説明変数がダミー変数のみの回帰\nこのとき、期待値\\(\\mathrm{E}[Y]\\)は次のようになります。\n\\[\n\\begin{aligned}\n\\mathrm{E}[Y] = \\begin{cases}\n\\beta_0  & \\text{if } D = 0 \\\\\n\\beta_0 + \\beta_1 & \\text{if } D = 1\n\\end{cases}\n\\end{aligned}\n\\]\nこの単回帰モデルの切片\\(\\beta_0\\)は、ダミー変数\\(D\\)が0のときの\\(Y\\)の平均値を表しています。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#説明変数がダミー変数のみの回帰-2",
    "href": "prezemi_2023_11_presen.html#説明変数がダミー変数のみの回帰-2",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "説明変数がダミー変数のみの回帰",
    "text": "説明変数がダミー変数のみの回帰\n住宅価格と川に隣接しているかどうかのダミー変数を使って回帰分析\n\nres &lt;- lm(medv ~ chas, data = df)\ncoef(res)\n\n(Intercept)        chas \n  22.093843    6.346157 \n\n\n\n川に接してない家の平均価格は、22.0938429ドル\n川に接している家の平均価格は、28.44ドル\nchasの係数の\\(p\\)値は、0"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#会計研究のダミー変数の例",
    "href": "prezemi_2023_11_presen.html#会計研究のダミー変数の例",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "会計研究のダミー変数の例",
    "text": "会計研究のダミー変数の例\n経営の定量研究では，コントロール変数として頻出の\n\n企業ダミー\n業種ダミー\n年度ダミー\n\nに加えて，会計だと\n\n監査の質の代理変数となる四大監査法人ダミー\nIFRSダミー\n\nと広範囲で利用されている。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数の注意点",
    "href": "prezemi_2023_11_presen.html#ダミー変数の注意点",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\n回帰分析にダミー変数を使う場合に気をつける点として，\n\nカテゴリの数が\\(k\\)個のカテゴリー変数は，\\(k-1\\)個のダミー変数を回帰分析に組み込む\nダミー変数の数が多すぎると，推定値の標準誤差が大きくなる\n\nという2点があります。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数の注意点-1",
    "href": "prezemi_2023_11_presen.html#ダミー変数の注意点-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\nダミー変数が表すカテゴリーの数より1つ少ないダミー変数を使う。 カテゴリーが3つある場合は、2つのダミー変数を使う。 次のデータで確認してみる。\n\ndf &lt;- read_csv(\"data/RD_2022.csv\")\nnames(df)\n\n [1] \"会社コード\"                     \"企業名\"                        \n [3] \"決算期\"                         \"決算種別\"                      \n [5] \"連結基準\"                       \"決算月数\"                      \n [7] \"上場コード\"                     \"日経業種コード\"                \n [9] \"現金預金\"                       \"資産合計\"                      \n[11] \"資本金\"                         \"資本剰余金\"                    \n[13] \"利益剰余金\"                     \"自己株式\"                      \n[15] \"売上高\"                         \"経常利益\"                      \n[17] \"法人税等\"                       \"法人税等調整額\"                \n[19] \"親会社株主に帰属する当期純利益\" \"研究開発費IFRS\"                \n[21] \"研究開発費\"                     \"開発費・試験研究費\"            \n[23] \"現金及び現金同等物の期末残高\""
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数の注意点-2",
    "href": "prezemi_2023_11_presen.html#ダミー変数の注意点-2",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\nsubstr()関数を使って，日経業種コードの大分類を作成\n\ndf$dai &lt;- substr(df$日経業種コード,1,1) # 大分類\ntable(df$dai) # 大分類の頻度\n\n\n    1     2 \n27551 30272 \n\n\nこの大分類を用いてダミー変数を作ります。\n\ndf &lt;- df %&gt;%\n  mutate(\n    製造業ダミー = ifelse(dai == 1, 1, 0),\n    非製造業ダミー = ifelse(dai == 2, 1, 0)\n  )\ntable(df$製造業ダミー, df$非製造業ダミー)\n\n   \n        0     1\n  0     0 30272\n  1 27551     0"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数の注意点-3",
    "href": "prezemi_2023_11_presen.html#ダミー変数の注意点-3",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\n研究開発費が翌期の売上高に与える影響を分析する回帰式に，製造業ダミーと非製造業ダミーの2つのダミー変数を組み込んでみる。\n\nres &lt;- lm(売上高 ~ lag(研究開発費) + 製造業ダミー + 非製造業ダミー, data = df)\nsummary(res)\n\n\nCall:\nlm(formula = 売上高 ~ lag(研究開発費) + 製造業ダミー + \n    非製造業ダミー, data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-21499834   -118247    -57215    -10030  13666084 \n\nCoefficients: (1 not defined because of singularities)\n                  Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)      2.332e+05  5.790e+03   40.28   &lt;2e-16 ***\nlag(研究開発費)  1.945e+01  7.086e-02  274.45   &lt;2e-16 ***\n製造業ダミー    -1.643e+05  6.918e+03  -23.75   &lt;2e-16 ***\n非製造業ダミー          NA         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 597800 on 36278 degrees of freedom\n  ( 21542 個の観測値が欠損のため削除されました )\nMultiple R-squared:  0.6749,    Adjusted R-squared:  0.6749 \nF-statistic: 3.766e+04 on 2 and 36278 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数の注意点-4",
    "href": "prezemi_2023_11_presen.html#ダミー変数の注意点-4",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\n分析結果をみると，1 not defined because of singularitiesというメッセージがあり，非製造業ダミーがNAになっていることが分かる。Rが自動で変数を落としている。\nこんなことしなくても、Rはダミー変数となりうる変数を因子型にして回帰分析に組み込めば、勝手にダミー変数として適切に処理してくれる。\n\nres01 &lt;- lm(売上高 ~ lag(研究開発費) + 非製造業ダミー, data = df)\nres02 &lt;- lm(売上高 ~ lag(研究開発費) + factor(dai), data = df)\nresult &lt;- list(res01,res02)\nmodelsummary(result)"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#ダミー変数の注意点-4-output",
    "href": "prezemi_2023_11_presen.html#ダミー変数の注意点-4-output",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "ダミー変数の注意点",
    "text": "ダミー変数の注意点\n\n\n\n\n\n (1)\n  (2)\n\n\n\n\n(Intercept)\n68916.622\n68916.622\n\n\n\n(3817.175)\n(3817.175)\n\n\nlag(研究開発費)\n19.447\n19.447\n\n\n\n(0.071)\n(0.071)\n\n\n非製造業ダミー\n164270.989\n\n\n\n\n(6917.606)\n\n\n\nfactor(dai)2\n\n164270.989\n\n\n\n\n(6917.606)\n\n\nNum.Obs.\n36281\n36281\n\n\nR2\n0.675\n0.675\n\n\nR2 Adj.\n0.675\n0.675\n\n\nAIC\n1068119.6\n1068119.6\n\n\nBIC\n1068153.6\n1068153.6\n\n\nLog.Lik.\n-534055.790\n-534055.790\n\n\nRMSE\n597821.12\n597821.12"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#線形変換",
    "href": "prezemi_2023_11_presen.html#線形変換",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "線形変換",
    "text": "線形変換\n確率変数\\(X\\)がアフィン変換(affine transformation)をする場合を考える。\n\\[\n\\begin{aligned}\nY =  a + bX\n\\end{aligned}\n\\]\n\n確率変数\\(X\\)が確率変数\\(Y\\)に変換されたとする。\n\\(a\\)と\\(b\\)はパラメータです。\n\nこのとき，次の関係が成立します。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#線形変換の期待値",
    "href": "prezemi_2023_11_presen.html#線形変換の期待値",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "線形変換の期待値",
    "text": "線形変換の期待値\n期待値については，\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= \\mathbb{E}[a + bX] \\nonumber \\\\\n       &= \\mathbb{E}[a] + \\mathbb{E}[bX] \\nonumber\\\\\n       &= a + b \\mathbb{E}[X]\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#線形変換の分散",
    "href": "prezemi_2023_11_presen.html#線形変換の分散",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "線形変換の分散",
    "text": "線形変換の分散\n分散については， \\[\n\\begin{aligned}\n\\mathbb{V}[Y]\n        &= \\mathbb{E}[(Y - \\mathbb{E}[Y])^2]      \\nonumber \\\\\n        &= \\mathbb{E}[(a + bX - (a+b\\mathbb{E}[X]))^2] \\nonumber\\\\\n        &= \\mathbb{E}[(bX - b \\mathbb{E}[X])^2]   \\nonumber\\\\\n        &= \\mathbb{E}[b^2 (X - \\mathbb{E}[X])^2]  \\nonumber\\\\\n        &= b^2 \\mathbb{E}[ (X - \\mathbb{E}[X])^2] \\nonumber\\\\\n        &= b^2 \\mathbb{V}[X]\n\\end{aligned}\n\\]\nとなる。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#線形変換の標準偏差",
    "href": "prezemi_2023_11_presen.html#線形変換の標準偏差",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "線形変換の標準偏差",
    "text": "線形変換の標準偏差\n標準偏差は，次の通り\n\\[\n\\begin{aligned}\n\\sigma _Y = \\sqrt{\\mathbb{V}[Y]} = |b| \\sqrt{\\mathbb{V}[X]}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#アフィン変換の例",
    "href": "prezemi_2023_11_presen.html#アフィン変換の例",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "アフィン変換の例",
    "text": "アフィン変換の例\nある工事が完了する日数とその確率が次のように予測されているとする。\n\n\n\n日数\\(X\\)\n1\n2\n3\n4\n5\n\n\n\n\n確率\\(p(x)\\)\n\\(5\\%\\)\n\\(20\\%\\)\n\\(35\\%\\)\n\\(30\\%\\)\n\\(10\\%\\)\n\n\n\nこのとき\n\\[\n\\begin{aligned}\n\\mathbb{E}[X] &\\equiv \\sum _k p_k x_k \\text{より} & \\mathbb{E}[X] &= 3.2\\\\\n\\mathbb{V} [X] &\\equiv \\sum _k p_k (x_k - \\mathbb{E}[X])^2 \\text{より} & \\mathbb{V} [X] &= 1.06\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#アフィン変換の例-1",
    "href": "prezemi_2023_11_presen.html#アフィン変換の例-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "アフィン変換の例",
    "text": "アフィン変換の例\nこの工事では，固定費として100万円，変動費として1日あたり10万円の費用がかかるとすると，総費用は，\n\\[\n\\begin{aligned}\nY = 100  + 10 X\n\\end{aligned}\n\\]\nとして表される。 このとき，総費用の期待値および分散は，\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= 100 + 10 \\mathbb{E}[X] = 100 + 10 \\times 3.2 = 132\\\\\n\\mathbb{V}[Y] &= 10^2 \\mathbb{V}[X] = 100  \\times 1.06 = 106\n\\end{aligned}\n\\]\nとなる。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#一般的な例",
    "href": "prezemi_2023_11_presen.html#一般的な例",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "一般的な例",
    "text": "一般的な例\nより一般的に，\\(k\\)個の確率変数\\(X_i\\), \\(i = 1, \\dots ,k\\)の一次結合\\(Y = c_0 + c_1 X_1 + \\cdots + c_k X_k\\)で表される確率変数\\(Y\\)において，次の関係が成立する。 ここで，\\(c_0,c_1, \\dots, c_k\\)はパラメータで，定数です。\n\\[\n\\begin{aligned}\n\\mathbb{E}[Y] &= c_0 + c_1 \\mu _1 + \\cdots c_k \\mu_k\\\\\n\\mathbb{V} [Y] &= c_1^2 \\sigma_1^2 + \\cdots +  c_k^2 \\sigma _k^2 + \\sum _{i\\not = j}^k \\sum_{j \\not = i}^k c_i c_j \\sigma _{ij}\n\\end{aligned}\n\\]\nここで，\\(\\mu _i = \\mathbb{E}[X_i]\\)，\\(\\sigma _i^2 = \\mathbb{V}[X_i]\\)，\\(\\sigma _{ij} = \\mathbb{COV}[X_i,X_j]\\)である。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#一般的な例k2のケース",
    "href": "prezemi_2023_11_presen.html#一般的な例k2のケース",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "一般的な例\\(k=2\\)のケース",
    "text": "一般的な例\\(k=2\\)のケース\n\\[\n\\begin{align}\n\\mathbb{E}[Y]   &= c_0 + c_1 \\mu _1 + c_2 \\mu_2\\\\\n\\mathbb{V} [Y] &= c_1^2 \\sigma_1^2 + c_2^2 \\sigma _2^2 + 2 c_1 c_2 \\sigma _{12}\n\\end{align}\n\\]"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#中心化",
    "href": "prezemi_2023_11_presen.html#中心化",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化",
    "text": "中心化\n\n変数変換の一つである中心化(centering)\n説明変数からその平均値を引くことで平均値を0にする変換\n一次関数の平行移動に相当する線形変換の一種で，回帰式の切片の解釈を容易にするために利用される\n中心化や標準化を行うscale()関数が便利"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#中心化した回帰分析",
    "href": "prezemi_2023_11_presen.html#中心化した回帰分析",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化した回帰分析",
    "text": "中心化した回帰分析\n先の回帰分析では，次のようなモデルを推定\n\\[\n\\text{住宅価格} = \\alpha + \\beta_1 \\text{部屋数} + \\beta_2 \\text{川の隣接ダミー} + \\varepsilon\n\\]\nこの回帰式を推定すると，次のようになります。\n\ndf &lt;- Boston\nres01 &lt;- lm(medv ~ rm, data = df)\ncoef(res01)\n\n(Intercept)          rm \n -34.670621    9.102109"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#中心化した回帰",
    "href": "prezemi_2023_11_presen.html#中心化した回帰",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化した回帰",
    "text": "中心化した回帰\n\nこの回帰式の切片-34.6706の意味を考えてみる。\n切片は，部屋数rmが0の場合の住宅価格の平均値を表す。\n部屋数がゼロの住宅は存在しないので，切片の解釈に意味は無い。"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#中心化した回帰-1",
    "href": "prezemi_2023_11_presen.html#中心化した回帰-1",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化した回帰",
    "text": "中心化した回帰\n標本平均を差し引くことで中心化を行う。 中心化は、scale()関数を使って行う。\n\ndf &lt;- df %&gt;%\n  mutate(\n    c_medv = scale(medv, center = TRUE, scale = FALSE),\n    c_rm = scale(rm, center = TRUE, scale = FALSE)\n  )\nres02 &lt;- lm(c_medv ~ c_rm, data = df)\nres &lt;- list(res01,res02)\nmodelsummary(res)\n\n\n先の中心化前の回帰分析結果と比べて違っているのは，切片(intercept)の値だけ"
  },
  {
    "objectID": "prezemi_2023_11_presen.html#中心化した回帰-1-output",
    "href": "prezemi_2023_11_presen.html#中心化した回帰-1-output",
    "title": "プレゼミ2023  回帰分析の応用",
    "section": "中心化した回帰",
    "text": "中心化した回帰\n\n\n\n\n\n (1)\n  (2)\n\n\n\n\n(Intercept)\n-34.671\n0.000\n\n\n\n(2.650)\n(0.294)\n\n\nrm\n9.102\n\n\n\n\n(0.419)\n\n\n\nc_rm\n\n9.102\n\n\n\n\n(0.419)\n\n\nNum.Obs.\n506\n506\n\n\nR2\n0.484\n0.484\n\n\nR2 Adj.\n0.483\n0.483\n\n\nAIC\n3352.2\n3352.2\n\n\nBIC\n3364.8\n3364.8\n\n\nLog.Lik.\n-1673.076\n-1673.076\n\n\nF\n471.847\n471.847\n\n\nRMSE\n6.60\n6.60"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#準備",
    "href": "prezemi_2023_13_presen.html#準備",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "準備",
    "text": "準備\n\nknitr::opts_chunk$set(dev = \"ragg_png\")\nlibrary(tidyverse) # とりあえずこれ\nlibrary(ggthemes) # ggplot2のテーマ\nlibrary(knitr) # 作表\nlibrary(kableExtra) # 作表の拡張\nlibrary(scales) # 軸の単位を制御\nlibrary(modelsummary) # モデルのまとめ\ntheme_set(theme_few(base_size = 12))\nupdate_geom_defaults(\"point\", list(size = 3))"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#応答変数が二値",
    "href": "prezemi_2023_13_presen.html#応答変数が二値",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "応答変数が二値",
    "text": "応答変数が二値\n\n「当たったか、外れたか」、「ある会計基準を選択したか、否か」、「ある商品を購入したか、否か」など\n結果が二値で表されるような変数を二値変数(binary variable)という。\n二値変数を応答変数として回帰分析したいとき、ロジスティック回帰分析を使う。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#オッズ",
    "href": "prezemi_2023_13_presen.html#オッズ",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "オッズ",
    "text": "オッズ\n\n事象Aと事象Bのどちらかが起こるとき、事象Aが起こる確率を\\(p\\)とすると、事象Bが起こる確率は\\(1-p\\)となる。\n\\(p\\)は確率を表しているので，\\(0\\)から\\(1\\)の間の値をとる。\nこの事象Aが起こる確率と事象Aが起こらない確率の比をオッズ(odds)という。\n\n\\[\nodds = \\frac{p}{1-p}\n\\]"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#オッズ-1",
    "href": "prezemi_2023_13_presen.html#オッズ-1",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "オッズ",
    "text": "オッズ\n\nオッズは\\(0\\)から\\(\\infty\\)の間の値をとる。\nこのオッズを対数変換して，\\(p\\)の関数\\(f(p)\\)としたものをロジット関数という。\n\\(p\\)が\\(0\\)から\\(1\\)の値をとるとき，\\(f(p)\\)は\\(-\\infty\\)から\\(\\infty\\)の値をとる。\n\n\\[\nf(p) = \\log \\left( \\frac{p}{1-p} \\right) = \\log p - \\log (1-p)\n\\]"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジット関数",
    "href": "prezemi_2023_13_presen.html#ロジット関数",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジット関数",
    "text": "ロジット関数\n図で書くとこうなります。\n\n\nRコード\np &lt;- seq(0, 1, 0.005) # 0〜1を0.005刻み\nlogit &lt;- log( p / (1 - p)) # 対数オッズ比\ndf &lt;- data.frame(p, logit)\ng &lt;- ggplot(df) + aes(x = p, y = logit) + geom_line() # 折れ線グラフ\ng &lt;- g + geom_hline(yintercept = 0, linetype = \"dashed\") + geom_vline(xintercept = 0.5, linetype = \"dashed\")\ng &lt;- g + labs(x = \"確率p\", y = \"ロジット関数f(x)\")\nprint(g)"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジット関数の逆関数",
    "href": "prezemi_2023_13_presen.html#ロジット関数の逆関数",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジット関数の逆関数",
    "text": "ロジット関数の逆関数\nロジット関数\\(f(p)\\)の逆関数を考える。 対数関数の逆関数は指数関数なので，ロジット関数の両辺の指数をとる。\n\\[\n\\exp(f(p)) = \\frac{p}{1-p}\n\\]\nこの式を\\(p\\)について解くと，次のようになります。\n\\[\n\\begin{aligned}\np &= \\frac{\\exp(f(p))}{1 + \\exp(f(p))} = \\frac{\\frac{\\exp(f(p))}{\\exp(f(p))}}{\\frac{1 + \\exp(f(p))}{\\exp(f(p))}} \\\\\n  &= \\frac{1}{\\frac{1}{\\exp(f(p))}+1}  = \\frac{1}{1 + \\exp(-f(p))}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジスティク関数",
    "href": "prezemi_2023_13_presen.html#ロジスティク関数",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジスティク関数",
    "text": "ロジスティク関数\n\nロジット関数\\(f(p)\\)の逆関数を\\(f^{-1}(x)\\)とすると，\\(f^{-1}(x)\\)は\\(-\\infty\\)から\\(\\infty\\)の値をとるとき，\\(p\\)は\\(0\\)から\\(1\\)の値をとる。\nこの関数\\(f^{-1}(x)\\)を標準ロジスティック関数という。\n\n\\[\nf^{-1}(x) = \\frac{\\exp(x)}{1 + \\exp(x)} = \\frac{1}{1 + \\exp(-x)}\n\\]\n標準ロジスティクス関数は次のような形をしています。\n\n\nRコード\nx &lt;- seq(-6, 6, 0.005)\nlogistic &lt;- exp(x) / (1 + exp(x))\ndf &lt;- data.frame(x, logistic)\ng &lt;- ggplot(df) + aes(x = x, y = logistic) + geom_line() # 折れ線グラフ\ng &lt;- g + geom_hline(yintercept = c(0,1), linetype = \"dashed\")\ng &lt;- g + labs(x = \"x\", y = \"標準ロジスティック関数\")\nprint(g)"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジスティクス関数",
    "href": "prezemi_2023_13_presen.html#ロジスティクス関数",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジスティクス関数",
    "text": "ロジスティクス関数\n\n標準ロジスティクス関数の定義域は\\(-\\infty\\)から\\(\\infty\\) \n手元の応答変数データは\\(0\\)と\\(1\\)の2種類しかなく、このようなデータを生み出す確率モデルには確率\\(p\\)で\\(1\\)、確率\\(1-p\\)で\\(0\\)をとるベルヌーイ分布を使う。\nこの確率\\(p\\)を先ほど導出したロジスティック関数(logistic function)で表す。\n\n\\[\n\\text{logistic}(x) = \\frac{\\exp(x)}{1 + \\exp(x)} = \\frac{1}{1 + \\exp(-x)}\n\\]"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジスティクス関数-1",
    "href": "prezemi_2023_13_presen.html#ロジスティクス関数-1",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジスティクス関数",
    "text": "ロジスティクス関数\nロジスティック関数を使って確率\\(p\\)を次のように表す。\n\\[\n\\Pr(y_i = 1)  = \\text{logistic}(b_0 + b_1x_i) =  \\frac{1}{1 + \\exp(-\\beta_0 - \\beta_1 x_i)}\n\\]\nこの式は、\\(x_i\\)が与えられたときに\\(y_i\\)が\\(1\\)となる確率を表しています。 この式を変形すると、次のようになります。\n\\[\n\\log \\left( \\frac{\\Pr(y_i = 1)}{1 - \\Pr(y_i = 1)} \\right) = \\beta_0 + \\beta_1 x_i\n\\]\nようやく回帰分析の式になった。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#最尤法",
    "href": "prezemi_2023_13_presen.html#最尤法",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "最尤法",
    "text": "最尤法\n\\(\\beta\\)を推定する方法を考える。\n\nこの回帰モデルは非線形であるため，最小二乗法が使えない。\nパラメータを最尤法(most likelifood method)を使って推定する。\nロジスティック回帰のモデルの背後にある線形モデルについて考える。\n観察される応答変数\\(y_i\\)は\\(0\\)か\\(1\\)という二値変数となりますが，その背後には，線形関係があると考える。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#最尤法-1",
    "href": "prezemi_2023_13_presen.html#最尤法-1",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "最尤法",
    "text": "最尤法\nつまりある閾値\\(y^*\\)を設定して，\\(y_i\\)が\\(y^*\\)より大きいときは\\(1\\)，\\(y^*\\)より小さいときは\\(0\\)となると考える。\n\\[\ny_i =\n\\begin{cases}\n1 & \\text{if } \\beta_0 + \\beta_1 x_i + \\epsilon_i &gt; y^* \\\\\n0 & \\text{if } \\beta_0 + \\beta_1 x_i + \\epsilon_i \\leq y^*\n\\end{cases}\n\\]\nこのように，二値変数の背後に観察できない連続変数があり，閾値を堺にカテゴリーが観察される，と考える。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#交差項で何が分かるのか",
    "href": "prezemi_2023_13_presen.html#交差項で何が分かるのか",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "交差項で何が分かるのか",
    "text": "交差項で何が分かるのか\n説明変数\\(X\\)が応答変数\\(Y\\)に与える影響(直接効果)に対して，別の説明変数\\(Z\\)が与える影響がある場合，\\(X\\)と\\(Z\\)の交差項\\(X \\times Z\\)をモデルに組み入れることで，\\(X\\)の影響が\\(Z\\)の値によってどのように変化するかを分析することができる。\n\\[\nY = \\beta_0 + \\beta_1 X + \\beta_2 Z + \\beta_3 X \\times Z + \\varepsilon\n\\]\nこの\\(X \\times Z\\)を交差項(interaction term)とよびます。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ダミー変数の交差項",
    "href": "prezemi_2023_13_presen.html#ダミー変数の交差項",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ダミー変数の交差項",
    "text": "ダミー変数の交差項\n前回導入したカテゴリーに属するか否かを表すダミー変数と連続変数の交差項について復習する。 応答変数\\(Y\\)を説明変数\\(X\\)とダミー変数\\(D\\)で回帰するモデルを考える。 \\[\nY = \\alpha + \\beta _1 X + \\beta _2 D + \\beta _3 (X \\times D) + \\varepsilon\n\\]"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ダミー変数の交差項-1",
    "href": "prezemi_2023_13_presen.html#ダミー変数の交差項-1",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ダミー変数の交差項",
    "text": "ダミー変数の交差項\n\\(D=1\\)の場合\n\\[\n\\begin{aligned}\nY &= \\alpha + \\beta _1 X + \\beta _2 1 + \\beta _3 (X \\times 1) + \\varepsilon\\\\\n  &= (\\alpha + \\beta _2) + (\\beta _1 + \\beta _3) X + \\varepsilon\\\\\n\\end{aligned}\n\\]\n\\(D=0\\)の場合\n\\[\n\\begin{aligned}\nY &= \\alpha + \\beta _1 X + \\beta _2 \\times 0 + \\beta _3 (X \\times 0) + \\varepsilon\\\\\n  &= \\alpha + \\beta _1 X + \\varepsilon\\\\\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ダミー変数の交差項-2",
    "href": "prezemi_2023_13_presen.html#ダミー変数の交差項-2",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ダミー変数の交差項",
    "text": "ダミー変数の交差項\n前回導入したダミー変数との交差項は，ダミー変数の値によって，切片や傾きがどのように変化するかを分析することができましたが，ここでは量的変数と量的変数の交差項のケースを考えます。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#交差項を入れた回帰分析の注意点",
    "href": "prezemi_2023_13_presen.html#交差項を入れた回帰分析の注意点",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "交差項を入れた回帰分析の注意点",
    "text": "交差項を入れた回帰分析の注意点\n回帰分析で交差項を入れる場合の注意点は次の4\n\n条件付仮説(たとえば，十分に\\(Z\\)が大きいとき，\\(X\\)は\\(Y\\)に影響を与える，とか)を検証する場合に，交差項を使う。\n交差項を入れるときは，交差項を構成する変数をそれぞれ回帰モデルに入れる。\n交差項を構成する変数の回帰係数はそのまま解釈できない。\n分析結果として，限界効果と標準誤差を示す。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#広告宣伝費を事例とした交差項の分析",
    "href": "prezemi_2023_13_presen.html#広告宣伝費を事例とした交差項の分析",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "広告宣伝費を事例とした交差項の分析",
    "text": "広告宣伝費を事例とした交差項の分析\n以下の分析で利用するためのデータを読み込みます。\n\ndf &lt;- read_csv(\"data/adv_2023.csv\") # データの読み込み\ndf &lt;- df %&gt;%\n  select(-拡販費) %&gt;% # 必要ないデータを除去\n  filter(決算月数 == 12) %&gt;% # 決算月数が12のデータを抽出\n  filter(広告宣伝費 &gt; 0)  # 広告宣伝費が0のデータを除去\nglimpse(df)\n\nRows: 8,632\nColumns: 13\n$ 日経会社コード &lt;chr&gt; \"0000001\", \"0000001\", \"0000003\", \"0000003\", \"0000003\", …\n$ 企業名称       &lt;chr&gt; \"極洋\", \"極洋\", \"日本水産\", \"日本水産\", \"日本水産\", \"日…\n$ 決算期         &lt;chr&gt; \"2006/03\", \"2007/03\", \"2006/03\", \"2007/03\", \"2008/03\", …\n$ 決算種別       &lt;dbl&gt; 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,…\n$ 連結基準       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ 決算月数       &lt;dbl&gt; 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,…\n$ 業種           &lt;dbl&gt; 235341, 235341, 235341, 235341, 235341, 235341, 235341,…\n$ 資産合計       &lt;dbl&gt; 65049, 66459, 384819, 404173, 396739, 385462, 383924, 4…\n$ 売上高         &lt;dbl&gt; 152899, 157088, 539653, 552871, 533970, 505250, 481574,…\n$ 販管費         &lt;dbl&gt; 13702, 14455, 95566, 98200, 100394, 98413, 99938, 10490…\n$ 広告宣伝費     &lt;dbl&gt; 304, 279, 2699, 2569, 2953, 2568, 2636, 3160, 3009, 288…\n$ 研究開発費     &lt;dbl&gt; 193, 188, 3083, 3377, 3718, 3803, 3994, 4499, 4809, 361…\n$ 設備投資額     &lt;dbl&gt; 897, 1841, 17186, 16031, 19105, 28872, 21121, 18633, 16…\n\n\n以下では，応答変数として売上高，説明変数として広告宣伝費と設備投資額を使います。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#交差項を入れた回帰分析の注意点-1",
    "href": "prezemi_2023_13_presen.html#交差項を入れた回帰分析の注意点-1",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "交差項を入れた回帰分析の注意点",
    "text": "交差項を入れた回帰分析の注意点\n数式で確認すれば分かりやすいです。 回帰モデルが\n\\[\nY = \\beta_0 + \\beta_1 X + \\beta_2 Z + \\beta_3 X \\times Z + \\varepsilon\n\\]\nであるとき，\\(X\\)の影響は，\\(Y\\)を\\(X\\)で偏微分することで求められます。\n\\[\n\\frac{\\partial Y}{\\partial X} = \\beta_1 + \\beta_3 Z\n\\]"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#限界効果",
    "href": "prezemi_2023_13_presen.html#限界効果",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "限界効果",
    "text": "限界効果\n\nこの式から，\\(Z\\)の値によって，\\(X\\)の影響が変化することが分かります。\n\\(\\beta_1\\)の値だけでは，\\(X\\)の影響を正確に評価することができません。\n\\(Z\\)の値によって，\\(X\\)の影響が変化することを示すためには，\\(Z\\)の値を変化させたときの\\(\\beta_1\\)の値を示す必要がある。\nこれを限界効果(marginal effect)とよぶ"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#記述統計と散布図の表示",
    "href": "prezemi_2023_13_presen.html#記述統計と散布図の表示",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "記述統計と散布図の表示",
    "text": "記述統計と散布図の表示\n主要変数3つの記述統計をみます。 ここではsummary()関数を使います。\n\ndf3 &lt;- df[, c(\"売上高\", \"広告宣伝費\", \"設備投資額\")]\nsummary(df3)\n\n     売上高           広告宣伝費       設備投資額     \n Min.   :      54   Min.   :     1   Min.   :      1  \n 1st Qu.:   26299   1st Qu.:   250   1st Qu.:    771  \n Median :   84923   Median :  1284   Median :   3078  \n Mean   :  448013   Mean   :  9912   Mean   :  28789  \n 3rd Qu.:  277604   3rd Qu.:  6158   3rd Qu.:  12271  \n Max.   :30225681   Max.   :509653   Max.   :4069225  \n                                     NA's   :540"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#作表-skimr",
    "href": "prezemi_2023_13_presen.html#作表-skimr",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "作表 skimr",
    "text": "作表 skimr\nskimrパッケージで作表\n\n\nRコード\n# install.packages(\"skimr\") # first time only\nlibrary(skimr)\nskim(df3)\n\n\n\n\nData summary\n\n\n\n\nName\n\n\ndf3\n\n\n\n\nNumber of rows\n\n\n8632\n\n\n\n\nNumber of columns\n\n\n3\n\n\n\n\n_______________________\n\n\n\n\n\n\nColumn type frequency:\n\n\n\n\n\n\nnumeric\n\n\n3\n\n\n\n\n________________________\n\n\n\n\n\n\nGroup variables\n\n\nNone\n\n\n\n\nVariable type: numeric\n\n\n\n\nskim_variable\n\n\nn_missing\n\n\ncomplete_rate\n\n\nmean\n\n\nsd\n\n\np0\n\n\np25\n\n\np50\n\n\np75\n\n\np100\n\n\nhist\n\n\n\n\n\n\n売上高\n\n\n0\n\n\n1.00\n\n\n448013.23\n\n\n1522677.66\n\n\n54\n\n\n26298.75\n\n\n84923.0\n\n\n277604.00\n\n\n30225681\n\n\n▇▁▁▁▁\n\n\n\n\n広告宣伝費\n\n\n0\n\n\n1.00\n\n\n9911.51\n\n\n34054.36\n\n\n1\n\n\n250.00\n\n\n1283.5\n\n\n6158.00\n\n\n509653\n\n\n▇▁▁▁▁\n\n\n\n\n設備投資額\n\n\n540\n\n\n0.94\n\n\n28788.64\n\n\n156138.90\n\n\n1\n\n\n771.25\n\n\n3078.5\n\n\n12270.75\n\n\n4069225\n\n\n▇▁▁▁▁"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#作表-summarytools",
    "href": "prezemi_2023_13_presen.html#作表-summarytools",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "作表 summarytools",
    "text": "作表 summarytools\nsummarytoolsパッケージのdescr()関数を使って作表\n\n\nRコード\n# install.packages(\"summarytools\") # first time only\nlibrary(summarytools)\ndescr(df3, transpose = TRUE)\n\n\nDescriptive Statistics  \ndf3  \nN: 8632  \n\n                        Mean      Std.Dev     Min         Q1     Median          Q3           Max\n---------------- ----------- ------------ ------- ---------- ---------- ----------- -------------\n      広告宣伝費     9911.51     34054.36    1.00     250.00    1283.50     6161.00     509653.00\n      設備投資額    28788.64    156138.90    1.00     770.50    3078.50    12280.50    4069225.00\n          売上高   448013.23   1522677.66   54.00   26293.50   84923.00   277652.00   30225681.00\n\nTable: Table continues below\n\n \n\n                         MAD         IQR     CV   Skewness   SE.Skewness   Kurtosis   N.Valid   Pct.Valid\n---------------- ----------- ----------- ------ ---------- ------------- ---------- --------- -----------\n      広告宣伝費     1818.41     5908.00   3.44       8.29          0.03      86.44   8632.00      100.00\n      設備投資額     4215.77    11499.50   5.42      15.22          0.03     285.02   8092.00       93.74\n          売上高   107098.58   251305.25   3.40       9.52          0.03     127.38   8632.00      100.00"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#作表-summarytools-1",
    "href": "prezemi_2023_13_presen.html#作表-summarytools-1",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "作表 summarytools",
    "text": "作表 summarytools\nsummarytoolsパッケージのdfSummary()関数を使うと，データフレームの形で作表\n\ndf3 %&gt;%\n  dfSummary(\n    varnumbers = FALSE,\n    valid.col = FALSE,\n    graph.magnif = 0.76) %&gt;%\n    print(max.tbl.height = 400, method = \"render\")\n\n\n好きな方法を使ってください。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#散布図",
    "href": "prezemi_2023_13_presen.html#散布図",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "散布図",
    "text": "散布図\n\n\nRコード\ndf3 %&gt;%\n  ggplot(aes(x = 設備投資額, y = 売上高)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(x = \"設備投資額\", y = \"売上高\")\n\n\n\n設備投資額が多い企業ほど売上高が多いように見えますが，因果関係を明らかにするためにも，広告宣伝費と翌期の売上高の散布図を書いてみる。\n\nこの設備投資額と売上高の関係に広告宣伝費がどのような影響を与えているのかを調べるために，回帰モデルに交差項を組み込んでいきます。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#対数変換した散布図",
    "href": "prezemi_2023_13_presen.html#対数変換した散布図",
    "title": "プレゼミ2023  ロジット回帰",
    "section": "対数変換した散布図",
    "text": "対数変換した散布図\n\n\nRコード\ndf3 %&gt;%\n  ggplot() + aes(x = lag(設備投資額), y = log(売上高)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(x = \"前期設備投資額\", y = \"対数売上高\")\n\n\n\n次に，この設備投資額と売上高の関係に広告宣伝費がどのような影響を与えているのかを調べるために，回帰モデルに交差項を組み込んでいきます。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#交差項を使った重回帰分析",
    "href": "prezemi_2023_13_presen.html#交差項を使った重回帰分析",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "交差項を使った重回帰分析",
    "text": "交差項を使った重回帰分析\nここでは，次のような仮説を考えてみます。\n\n広告宣伝費が多い企業ほど，設備投資額が多いと，売上高が増加する。\n\nこの仮説を検証するために，回帰モデルを次のように設定します。\n\\[\n\\begin{aligned}\n\\text{売上高} = \\beta_0 & + \\beta_1 \\text{前期設備投資額} + \\beta_2 \\text{広告宣伝費} \\\\\n& + \\beta_3  \\text{前期設備投資額} \\times  \\text{広告宣伝費} + \\varepsilon\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#作表-summarytools-1-output",
    "href": "prezemi_2023_13_presen.html#作表-summarytools-1-output",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "作表 summarytools",
    "text": "作表 summarytools\n\n\nData Frame Summary\ndf3\nDimensions: 8632 x 3\n  Duplicates: 0\n\n\n  \n\n\n\n\n\n\n\n\n\n\nVariable\nStats / Values\nFreqs (% of Valid)\nGraph\nMissing\n\n\n\n\n売上高 [numeric]\n\n\n\nMean (sd) : 448013.2 (1522678)\n\n\nmin ≤ med ≤ max:\n\n\n54 ≤ 84923 ≤ 30225681\n\n\nIQR (CV) : 251305.2 (3.4)\n\n\n\n8492 distinct values\n\n0 (0.0%)\n\n\n広告宣伝費 [numeric]\n\n\n\nMean (sd) : 9911.5 (34054.4)\n\n\nmin ≤ med ≤ max:\n\n\n1 ≤ 1283.5 ≤ 509653\n\n\nIQR (CV) : 5908 (3.4)\n\n\n\n4878 distinct values\n\n0 (0.0%)\n\n\n設備投資額 [numeric]\n\n\n\nMean (sd) : 28788.6 (156138.9)\n\n\nmin ≤ med ≤ max:\n\n\n1 ≤ 3078.5 ≤ 4069225\n\n\nIQR (CV) : 11499.5 (5.4)\n\n\n\n5751 distinct values\n\n540 (6.3%)\n\n\n\n\n\nGenerated by summarytools 1.0.1 (R version 4.2.2)2023-12-18"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#交差項を使った重回帰分析-1",
    "href": "prezemi_2023_13_presen.html#交差項を使った重回帰分析-1",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "交差項を使った重回帰分析",
    "text": "交差項を使った重回帰分析\nこの回帰モデルをlm()関数を使って回帰分析を行う。 交差項を含む回帰モデルを作るときは，*を使う。\n\n\nRコード\nres01 &lt;- lm(売上高 ~ 設備投資額 * 広告宣伝費, data = df3)\nmodelsummary(res01,\n  stars = c(\"*\" = .10, \"**\" = .05, \"***\" = .01),\n  gof_map = c(\"nobs\", \"r.squared\", \"adj.r.squared\")\n  ) |&gt; kable_styling(font_size = 20)\n\n\n\n\n\n\n (1)\n\n\n\n\n(Intercept)\n75002.406***\n\n\n\n(5767.502)\n\n\n設備投資額\n6.597***\n\n\n\n(0.074)\n\n\n広告宣伝費\n18.651***\n\n\n\n(0.211)\n\n\n設備投資額 × 広告宣伝費\n0.000***\n\n\n\n(0.000)\n\n\nNum.Obs.\n8092\n\n\nR2\n0.896\n\n\nR2 Adj.\n0.896\n\n\n\n * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#交差項の使った重回帰分析",
    "href": "prezemi_2023_13_presen.html#交差項の使った重回帰分析",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "交差項の使った重回帰分析",
    "text": "交差項の使った重回帰分析\n設備投資と売上高の正の関係は，広告宣伝費が大きくなるほど強くなる。 この結果の解釈を容易にするために，marginsパッケージを使って限界効果を計算\n\n# install.packages(\"margins\") # first time only\nlibrary(margins)\nmargins(res01)\n\n 設備投資額 広告宣伝費\n      6.571      18.58\n\n\nこの限界効果の推定から，広告宣伝費が増加すると，設備投資と売上高の正の関係が強くなることが分かります。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#交差項を含む回帰分析結果の解釈と可視化",
    "href": "prezemi_2023_13_presen.html#交差項を含む回帰分析結果の解釈と可視化",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "交差項を含む回帰分析結果の解釈と可視化",
    "text": "交差項を含む回帰分析結果の解釈と可視化\n\n上の分析結果から，設備投資額と売上高との関係は，広告宣伝費の規模に応じて変化することが分かった。\nしかし，前述した通り設備投資額が売上高に与える影響の強さは，広告宣伝費に応じて決まるため，設備投資額が1円増えたとき，売上高がいくら増えるのかはこの推定結果からは分かりません。\nそこで，説明変数を中心化することで，推定結果を解釈可能なものにします。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#交差項と中心化",
    "href": "prezemi_2023_13_presen.html#交差項と中心化",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "交差項と中心化",
    "text": "交差項と中心化\nscale()関数を使って各説明変数から標本平均を引く。\n\n\nRコード\ndf3 &lt;- df3 %&gt;%\n  mutate(\n    広告宣伝費_c = scale(広告宣伝費, center = TRUE, scale = FALSE),\n    設備投資額_c = scale(設備投資額, center = TRUE, scale = FALSE)\n  )\nres02 &lt;- lm(売上高~ 設備投資額_c * 広告宣伝費_c, data = df3)\nresult &lt;- list(res01, res02)\nmodelsummary(result,\n  stars = c(\"*\" = .10, \"**\" = .05, \"***\" = .01),\n  gof_map = c(\"nobs\", \"adj.r.squared\")\n  ) |&gt; kable_styling(font_size = 18)\n\n\n\n\n\n\n (1)\n  (2)\n\n\n\n\n(Intercept)\n75002.406***\n449066.986***\n\n\n\n(5767.502)\n(5463.024)\n\n\n設備投資額\n6.597***\n\n\n\n\n(0.074)\n\n\n\n広告宣伝費\n18.651***\n\n\n\n\n(0.211)\n\n\n\n設備投資額 × 広告宣伝費\n0.000***\n\n\n\n\n(0.000)\n\n\n\n設備投資額_c\n\n6.572***\n\n\n\n\n(0.073)\n\n\n広告宣伝費_c\n\n18.580***\n\n\n\n\n(0.210)\n\n\n設備投資額_c × 広告宣伝費_c\n\n0.000***\n\n\n\n\n(0.000)\n\n\nNum.Obs.\n8092\n8092\n\n\nR2 Adj.\n0.896\n0.896\n\n\n\n * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#手順",
    "href": "prezemi_2023_13_presen.html#手順",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "手順",
    "text": "手順\n\n帰無仮説と対立仮説を設定する。\n説明変数\\(X\\)と応用変数\\(Y\\)の散布図を確認する。\nロジスティクス回帰モデルを作る。\n最尤法を用いて回帰係数を推定する。\n回帰係数の有意性を検定する。\n推定結果の意味を解釈する。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#データの読み込み",
    "href": "prezemi_2023_13_presen.html#データの読み込み",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "データの読み込み",
    "text": "データの読み込み\n今回は，教科書のデータを用いる。 応答変数は当選か落選かを表す二値変数wlsmdで，説明変数は選挙支出expmと過去の当選回数previousを使う。 回帰モデルは以下の通り\n\\[\n\\Pr (wlsmd _i = 1) = \\mathrm{logistic} \\left( \\frac{1}{1 + \\exp\\{ -(b_0 + b_1previous + b_2 expm) \\} } \\right)\n\\]"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#rで実装",
    "href": "prezemi_2023_13_presen.html#rで実装",
    "title": "プレゼミ2023  ロジット回帰",
    "section": "Rで実装",
    "text": "Rで実装\n\nglimpse(df)\n\nRows: 15\nColumns: 5\n$ id       &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15\n$ wlsmd    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0\n$ previous &lt;dbl&gt; 0, 1, 3, 5, 7, 4, 5, 4, 0, 0, 5, 2, 4, 1, 3\n$ expm     &lt;dbl&gt; 10.0, 10.0, 8.9, 7.7, 5.4, 3.0, 2.0, 7.0, 2.2, 4.3, 4.0, 3.0,…\n$ smd      &lt;fct&gt; 当選, 当選, 当選, 当選, 当選, 当選, 当選, 当選, 落選, 落選, …"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#帰無仮説と対立仮説",
    "href": "prezemi_2023_13_presen.html#帰無仮説と対立仮説",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "帰無仮説と対立仮説",
    "text": "帰無仮説と対立仮説\n帰無仮説は次の2つ\n\n当選確率は，当選回数と関係がない。\n当選確率は，選挙支出と関係がない。\n\n対立仮説は\n\n当選確率は，当選回数と関係がある。\n当選確率は，選挙支出と関係がある。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#散布図を書いてみる",
    "href": "prezemi_2023_13_presen.html#散布図を書いてみる",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "散布図を書いてみる。",
    "text": "散布図を書いてみる。\n\nlibrary(tidyverse)\ndf &lt;- read_csv(\"data/logit.csv\")\ndf &lt;- df |&gt;\n  mutate(\n    smd = factor(wlsmd, levels = 0:1, labels = c(\"落選\", \"当選\"))\n  )\nsummary(df) |&gt;\n  kable() |&gt;  kable_styling(font_size = 20)\n\n\n\n\n\nid\nwlsmd\nprevious\nexpm\nsmd\n\n\n\n\n\nMin. : 1.0\nMin. :0.0000\nMin. :0.000\nMin. : 2.00\n落選:7\n\n\n\n1st Qu.: 4.5\n1st Qu.:0.0000\n1st Qu.:1.000\n1st Qu.: 3.00\n当選:8\n\n\n\nMedian : 8.0\nMedian :1.0000\nMedian :3.000\nMedian : 4.00\nNA\n\n\n\nMean : 8.0\nMean :0.5333\nMean :2.933\nMean : 5.18\nNA\n\n\n\n3rd Qu.:11.5\n3rd Qu.:1.0000\n3rd Qu.:4.500\n3rd Qu.: 7.35\nNA\n\n\n\nMax. :15.0\nMax. :1.0000\nMax. :7.000\nMax. :10.00\nNA"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#散布図を書いてみる-1",
    "href": "prezemi_2023_13_presen.html#散布図を書いてみる-1",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "散布図を書いてみる。",
    "text": "散布図を書いてみる。\n当落と当選回数の散布図と回帰線\n\n\nRコード\nggplot(df) + aes(x = previous, y = wlsmd) +\n  geom_hline(yintercept = c(0, 1), color = \"gray\") +\n  geom_jitter(width = 0.05, height = 0.05) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(x = \"当選回数\", y = \"選挙の当落\")"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジスティクス関数を推定",
    "href": "prezemi_2023_13_presen.html#ロジスティクス関数を推定",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジスティクス関数を推定",
    "text": "ロジスティクス関数を推定\n非線形回帰モデルを推定するために，一般化線形モデル(general linear model)glm()関数を使う。 引数に，family = binomial(link = \"logit\")を指定して，リンク関数をロジスティクス関数に指定する。\n\nmodel_1 &lt;- glm(wlsmd ~ previous + expm, data = df, family = binomial(link = \"logit\"))\nmodelsummary(model_1,\n  stars = c(\"*\" = .10, \"**\" = .05, \"***\" = .01),\n  gof_map = c(\"nobs\", \"r.squared\", \"adj.r.squared\")\n  ) |&gt;\n  kable_styling(font_size = 20)"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジスティクス関数を推定-output",
    "href": "prezemi_2023_13_presen.html#ロジスティクス関数を推定-output",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジスティクス関数を推定",
    "text": "ロジスティクス関数を推定\n\n\n\n\n\n (1)\n\n\n\n\n(Intercept)\n-6.381*\n\n\n\n(3.515)\n\n\nprevious\n0.809\n\n\n\n(0.585)\n\n\nexpm\n0.809**\n\n\n\n(0.400)\n\n\nNum.Obs.\n15\n\n\n\n * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジスティクス関数を推定-1",
    "href": "prezemi_2023_13_presen.html#ロジスティクス関数を推定-1",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジスティクス関数を推定",
    "text": "ロジスティクス関数を推定\n回帰曲線を描いてみる。\n\npred_prev &lt;- tibble(\n  previous = min(df$previous):max(df$previous),\n  expm = mean(df$expm)\n  )\npred_prev$fit &lt;- predict(\n  model_1,\n  type = \"response\",\n  newdata = pred_prev)"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジスティクス関数の作図",
    "href": "prezemi_2023_13_presen.html#ロジスティクス関数の作図",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジスティクス関数の作図",
    "text": "ロジスティクス関数の作図\n\n\nRコード\nplt_prev &lt;- ggplot(df) + aes(x = previous) +\n  geom_hline(yintercept = c(0, 1), color = \"gray\") +\n  geom_jitter(aes(y = wlsmd), pch = 16, width = 0.05, height = 0.05) +\n  geom_line(data = pred_prev, aes(y = fit)) +\n  geom_point(data = pred_prev, aes(y = fit), pch = 18) +\n  labs(x = \"過去の当選回数\", y = \"当選確率\")\nprint(plt_prev)"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジスティクス回帰分析の結果",
    "href": "prezemi_2023_13_presen.html#ロジスティクス回帰分析の結果",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジスティクス回帰分析の結果",
    "text": "ロジスティクス回帰分析の結果\n\n応答変数は0から1の値に収まるようになったが、非線形の関係となっている。\n非線形であるため傾きである回帰係数は変化する。\n回帰係数の推定方法や有意水準の計算方法は線形回帰とは異なるものの、結果の見方は同じ。\nただロジスティック回帰ではダミー変数との交差項が使えない。"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#ロジスティック回帰の交差項",
    "href": "prezemi_2023_13_presen.html#ロジスティック回帰の交差項",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "ロジスティック回帰の交差項",
    "text": "ロジスティック回帰の交差項\nロジスティック回帰では交差項を使うときは注意が必要。\n\ndf &lt;- read_csv(\"data/politics_data.csv\") # データを読み込み\ndf &lt;- df |&gt;\n  filter(year == 2005)  |&gt;\n  mutate(\n    \"party_size\" = if_else(party_jpn %in% c(\"自民党\", \"民主党\"), 1, 0),\n    \"smd\" = if_else(smd == \"当選\", 1, 0)\n    ) |&gt;\n  select(smd, expm, previous, party_size) |&gt;\n  drop_na() |&gt;\n  as.data.frame()"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#記述統計量",
    "href": "prezemi_2023_13_presen.html#記述統計量",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "記述統計量",
    "text": "記述統計量\n\nsummary(df) |&gt;\n  kable() |&gt;  kable_styling(font_size = 20)\n\n\n\n\n\nsmd\nexpm\nprevious\nparty_size\n\n\n\n\n\nMin. :0.0000\nMin. : 0.06271\nMin. : 0.000\nMin. :0.0000\n\n\n\n1st Qu.:0.0000\n1st Qu.: 2.91743\n1st Qu.: 0.000\n1st Qu.:0.0000\n\n\n\nMedian :0.0000\nMedian : 7.69602\nMedian : 1.000\nMedian :1.0000\n\n\n\nMean :0.3025\nMean : 8.14224\nMean : 1.922\nMean :0.5868\n\n\n\n3rd Qu.:1.0000\n3rd Qu.:11.82280\n3rd Qu.: 3.000\n3rd Qu.:1.0000\n\n\n\nMax. :1.0000\nMax. :24.64971\nMax. :16.000\nMax. :1.0000"
  },
  {
    "objectID": "prezemi_2023_13_presen.html#図示",
    "href": "prezemi_2023_13_presen.html#図示",
    "title": "プレゼミ2023  ロジスティック回帰",
    "section": "図示",
    "text": "図示\n\n\nRコード\nglm &lt;- glm(smd ~ expm + party_size, data = df, family = binomial(link = \"logit\"))\n\npred &lt;- with(df, expand.grid(expm = seq(min(expm, na.rm=TRUE),\n                                           max(expm, na.rm=TRUE),\n                                           length = 100),\n                               party_size = c(0,1)))\n\n## mutate を使って、新たな変数である予測値 (pred) を作り計算する\npred &lt;- pred |&gt; mutate(smd = predict(glm, type = \"response\", newdata = pred))\n\n## 散布図は観測値で描き、回帰直線は予測値 (pred) で描く\np1 &lt;- ggplot(df, aes(x = expm, y = smd, color = as.factor(party_size))) +\n  geom_point(size = 1) +\n  geom_line(data = pred) +\n  labs(x = \"選挙費用(百万円)\", y = \"得票率(%)\",\n       title = \"ダミー変数\") +\n  scale_color_discrete(name = NULL, labels = c(\"その他\", \"自民・民主\")) +\n  guides(color = guide_legend(reverse = TRUE)) +\n  theme(legend.position = \"bottom\")\n\n# 交差項\nglm &lt;- glm(smd ~ expm + party_size + expm:party_size, data = df, family = binomial(link = \"logit\"))\npred &lt;- with(df, expand.grid(expm = seq(min(expm, na.rm=TRUE),\n                                           max(expm, na.rm=TRUE),\n                                           length = 100),\n                               party_size = c(0,1)))\n\n## mutate を使って、新たな変数である予測値 (pred) を作り計算する\npred &lt;- pred |&gt; mutate(smd = predict(glm, type = \"response\", newdata = pred))\n\n## 散布図は観測値で描き、回帰直線は予測値 (pred) で描く\np2 &lt;- ggplot(df, aes(x = expm, y = smd, color = as.factor(party_size))) +\n  geom_point(size = 1) +  geom_line(data = pred) +\n  labs(x = \"選挙費用(百万円)\", y = NULL, title = \"交差項\") +\n  scale_color_discrete(name = NULL, labels = c(\"その他\", \"自民・民主\")) +\n  guides(color = guide_legend(reverse = TRUE)) +\n  theme(legend.position = \"bottom\")\nlibrary(patchwork) # 図を並べる\np1 + p2"
  }
]